<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MOM6: mom_ocmip2_cfc Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MOM6
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacemom__ocmip2__cfc.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mom_ocmip2_cfc Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Simulates CFCs using the OCMIP2 protocols. </p>
<p>By Robert Hallberg, 2007</p>
<p>This module contains the code that is needed to set up and use CFC-11 and CFC-12 in a fully coupled or ice-ocean model context using the OCMIP2 protocols </p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmom__ocmip2__cfc_1_1ocmip2__cfc__cs.html">ocmip2_cfc_cs</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The control structure for the OCMPI2_CFC tracer package.  <a href="structmom__ocmip2__cfc_1_1ocmip2__cfc__cs.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:ac04494ce35222c8583a7ee7589e1cf13"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__ocmip2__cfc.html#ac04494ce35222c8583a7ee7589e1cf13">register_ocmip2_cfc</a> (HI, GV, param_file, CS, tr_Reg, restart_CS)</td></tr>
<tr class="memdesc:ac04494ce35222c8583a7ee7589e1cf13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register the OCMIP2 CFC tracers to be used with MOM and read the parameters that are used with this tracer package.  <a href="namespacemom__ocmip2__cfc.html#ac04494ce35222c8583a7ee7589e1cf13">More...</a><br /></td></tr>
<tr class="separator:ac04494ce35222c8583a7ee7589e1cf13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae389be73425290cf49ab861aadff91d"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__ocmip2__cfc.html#aae389be73425290cf49ab861aadff91d">flux_init_ocmip2_cfc</a> (CS, verbosity)</td></tr>
<tr class="memdesc:aae389be73425290cf49ab861aadff91d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine initializes the air-sea CFC fluxes, and optionally returns the indicies of these fluxes. It can safely be called multiple times.  <a href="namespacemom__ocmip2__cfc.html#aae389be73425290cf49ab861aadff91d">More...</a><br /></td></tr>
<tr class="separator:aae389be73425290cf49ab861aadff91d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaa0b7695728d3761d5f25688838f5fc"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__ocmip2__cfc.html#aaaa0b7695728d3761d5f25688838f5fc">initialize_ocmip2_cfc</a> (restart, day, G, GV, US, h, diag, OBC, CS, sponge_CSp)</td></tr>
<tr class="memdesc:aaaa0b7695728d3761d5f25688838f5fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the OCMP2 CFC tracer fields and set up the tracer output.  <a href="namespacemom__ocmip2__cfc.html#aaaa0b7695728d3761d5f25688838f5fc">More...</a><br /></td></tr>
<tr class="separator:aaaa0b7695728d3761d5f25688838f5fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a293cd355bf164bfd6bbe2cda4b00ad12"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__ocmip2__cfc.html#a293cd355bf164bfd6bbe2cda4b00ad12">init_tracer_cfc</a> (h, tr, name, land_val, IC_val, G, US, CS)</td></tr>
<tr class="memdesc:a293cd355bf164bfd6bbe2cda4b00ad12"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine initializes a tracer array.  <a href="namespacemom__ocmip2__cfc.html#a293cd355bf164bfd6bbe2cda4b00ad12">More...</a><br /></td></tr>
<tr class="separator:a293cd355bf164bfd6bbe2cda4b00ad12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebc84df12994a1f74d181ab54e380878"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__ocmip2__cfc.html#aebc84df12994a1f74d181ab54e380878">ocmip2_cfc_column_physics</a> (h_old, h_new, ea, eb, fluxes, dt, G, GV, US, CS, evap_CFL_limit, minimum_forcing_depth)</td></tr>
<tr class="memdesc:aebc84df12994a1f74d181ab54e380878"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine applies diapycnal diffusion, souces and sinks and any other column tracer physics or chemistry to the OCMIP2 CFC tracers. CFCs are relatively simple, as they are passive tracers with only a surface flux as a source.  <a href="namespacemom__ocmip2__cfc.html#aebc84df12994a1f74d181ab54e380878">More...</a><br /></td></tr>
<tr class="separator:aebc84df12994a1f74d181ab54e380878"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3c9967ff09b37934eb5ef51535e7ee3"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__ocmip2__cfc.html#ac3c9967ff09b37934eb5ef51535e7ee3">ocmip2_cfc_stock</a> (h, stocks, G, GV, CS, names, units, stock_index)</td></tr>
<tr class="memdesc:ac3c9967ff09b37934eb5ef51535e7ee3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function calculates the mass-weighted integral of all tracer stocks, returning the number of stocks it has calculated. If the stock_index is present, only the stock corresponding to that coded index is returned.  <a href="namespacemom__ocmip2__cfc.html#ac3c9967ff09b37934eb5ef51535e7ee3">More...</a><br /></td></tr>
<tr class="separator:ac3c9967ff09b37934eb5ef51535e7ee3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe30443454b39aa620f0e7422de416e6"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__ocmip2__cfc.html#abe30443454b39aa620f0e7422de416e6">ocmip2_cfc_surface_state</a> (state, h, G, CS)</td></tr>
<tr class="memdesc:abe30443454b39aa620f0e7422de416e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine extracts the surface CFC concentrations and other fields that are shared with the atmosphere to calculate CFC fluxes.  <a href="namespacemom__ocmip2__cfc.html#abe30443454b39aa620f0e7422de416e6">More...</a><br /></td></tr>
<tr class="separator:abe30443454b39aa620f0e7422de416e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a225d2a7eacb485040fcac7f9b6766ee1"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__ocmip2__cfc.html#a225d2a7eacb485040fcac7f9b6766ee1">ocmip2_cfc_end</a> (CS)</td></tr>
<tr class="memdesc:a225d2a7eacb485040fcac7f9b6766ee1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocate any memory associated with the OCMIP2 CFC tracer package.  <a href="namespacemom__ocmip2__cfc.html#a225d2a7eacb485040fcac7f9b6766ee1">More...</a><br /></td></tr>
<tr class="separator:a225d2a7eacb485040fcac7f9b6766ee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:acfeb2ddc32eb2ea2b41a80226d729a88"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__ocmip2__cfc.html#acfeb2ddc32eb2ea2b41a80226d729a88">ntr</a> = 2</td></tr>
<tr class="memdesc:acfeb2ddc32eb2ea2b41a80226d729a88"><td class="mdescLeft">&#160;</td><td class="mdescRight">the number of tracers in this module.  <a href="namespacemom__ocmip2__cfc.html#acfeb2ddc32eb2ea2b41a80226d729a88">More...</a><br /></td></tr>
<tr class="separator:acfeb2ddc32eb2ea2b41a80226d729a88"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aae389be73425290cf49ab861aadff91d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae389be73425290cf49ab861aadff91d">&#9670;&nbsp;</a></span>flux_init_ocmip2_cfc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_ocmip2_cfc::flux_init_ocmip2_cfc </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__ocmip2__cfc_1_1ocmip2__cfc__cs.html">ocmip2_cfc_cs</a>), optional, pointer&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine initializes the air-sea CFC fluxes, and optionally returns the indicies of these fluxes. It can safely be called multiple times. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">cs</td><td>An optional pointer to the control structure for this module; if not present, the flux indicies are not stored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbosity</td><td>A 0-9 integer indicating a level of verbosity. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html#l00282">282</a> of file <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html">MOM_OCMIP2_CFC.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordtype">type</span>(OCMIP2_CFC_CS), <span class="keywordtype">optional</span>, <span class="keywordtype">pointer</span> :: CS<span class="comment"> !&lt; An optional pointer to the control structure</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">                                               !! for this module; if not present, the flux indicies</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">                                               !! are not stored.</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordtype">integer</span>,             <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: verbosity<span class="comment"> !&lt; A 0-9 integer indicating a level of verbosity.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="comment">! These can be overridden later in via the field manager?</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordtype">character(len=128)</span> :: default_ice_restart_file = <span class="stringliteral">&#39;ice_ocmip2_cfc.res.nc&#39;</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordtype">character(len=128)</span> :: default_ocean_restart_file = <span class="stringliteral">&#39;ocmip2_cfc.res.nc&#39;</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordtype">integer</span> :: ind_flux(2) <span class="comment">! Integer indices of the fluxes</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="comment">! These calls obtain the indices for the CFC11 and CFC12 flux coupling.  They</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">! can safely be called multiple times.</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  ind_flux(1) = aof_set_coupler_flux(<span class="stringliteral">&#39;cfc_11_flux&#39;</span>, &amp;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;       flux_type = <span class="stringliteral">&#39;air_sea_gas_flux&#39;</span>, implementation = <span class="stringliteral">&#39;ocmip2&#39;</span>, &amp;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;       param = (/ 9.36e-07, 9.7561e-06 /), &amp;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;       ice_restart_file = default_ice_restart_file, &amp;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;       ocean_restart_file = default_ocean_restart_file, &amp;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;       caller = <span class="stringliteral">&quot;register_OCMIP2_CFC&quot;</span>, verbosity=verbosity)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  ind_flux(2) = aof_set_coupler_flux(<span class="stringliteral">&#39;cfc_12_flux&#39;</span>, &amp;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;       flux_type = <span class="stringliteral">&#39;air_sea_gas_flux&#39;</span>, implementation = <span class="stringliteral">&#39;ocmip2&#39;</span>, &amp;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;       param = (/ 9.36e-07, 9.7561e-06 /), &amp;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;       ice_restart_file = default_ice_restart_file, &amp;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;       ocean_restart_file = default_ocean_restart_file, &amp;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;       caller = <span class="stringliteral">&quot;register_OCMIP2_CFC&quot;</span>, verbosity=verbosity)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(cs)) <span class="keywordflow">then</span> ; <span class="keywordflow">if</span> (<span class="keyword">associated</span>(cs)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    cs%ind_cfc_11_flux = ind_flux(1)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    cs%ind_cfc_12_flux = ind_flux(2)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="keywordflow">  endif</span> ;<span class="keywordflow"> endif</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="atmos__ocean__fluxes_8F90_source.html#l00018">atmos_ocean_fluxes_mod::aof_set_coupler_flux()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html#l00093">register_ocmip2_cfc()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__ocmip2__cfc_aae389be73425290cf49ab861aadff91d_cgraph.svg" width="396" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__ocmip2__cfc_aae389be73425290cf49ab861aadff91d_icgraph.svg" width="390" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a293cd355bf164bfd6bbe2cda4b00ad12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a293cd355bf164bfd6bbe2cda4b00ad12">&#9670;&nbsp;</a></span>init_tracer_cfc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_ocmip2_cfc::init_tracer_cfc </td>
          <td>(</td>
          <td class="paramtype">real, dimension( g %isd: g %ied, g %jsd: g %jed, g %ke), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( g %isd: g %ied, g %jsd: g %jed, g %ke), intent(out)&#160;</td>
          <td class="paramname"><em>tr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>land_val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>IC_val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(ocean_grid_type), intent(in)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__ocmip2__cfc_1_1ocmip2__cfc__cs.html">ocmip2_cfc_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>CS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This subroutine initializes a tracer array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>The ocean's grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Layer thicknesses [H ~&gt; m or kg m-2] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tr</td><td>The tracer concentration array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>The tracer name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">land_val</td><td>A value the tracer takes over land </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ic_val</td><td>The initial condition value for the tracer </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cs</td><td>The control structure returned by a previous call to register_OCMIP2_CFC. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html#l00363">363</a> of file <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html">MOM_OCMIP2_CFC.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type),                    <span class="keywordtype">intent(in)</span>  :: G<span class="comment">    !&lt; The ocean&#39;s grid structure</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type),                    <span class="keywordtype">intent(in)</span>  :: US<span class="comment">   !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G),SZK_(G))</span>, <span class="keywordtype">intent(in)</span>  :: h<span class="comment">    !&lt; Layer thicknesses [H ~&gt; m or kg m-2]</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G),SZK_(G))</span>, <span class="keywordtype">intent(out)</span> :: tr<span class="comment">   !&lt; The tracer concentration array</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordtype">character(len=*)</span>,                         <span class="keywordtype">intent(in)</span>  :: name<span class="comment"> !&lt; The tracer name</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keywordtype">  real</span>,                                     <span class="keywordtype">intent(in)</span>  :: land_val<span class="comment"> !&lt; A value the tracer takes over land</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="keywordtype">  real</span>,                                     <span class="keywordtype">intent(in)</span>  :: IC_val<span class="comment"> !&lt; The initial condition value for the tracer</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordtype">type</span>(OCMIP2_CFC_CS),                      <span class="keywordtype">pointer</span>     :: CS<span class="comment">   !&lt; The control structure returned by a</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">                                                                !! previous call to register_OCMIP2_CFC.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="comment">! This subroutine initializes a tracer array.</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordtype">logical</span> :: OK</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordtype">integer</span> :: i, j, k, is, ie, js, je, nz</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  is = g%isc ; ie = g%iec ; js = g%jsc ; je = g%jec ; nz = g%ke</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordflow">if</span> (len_trim(cs%IC_file) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">!  Read the tracer concentrations from a netcdf file.</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">if</span> (.not.file_exists(cs%IC_file, g%Domain)) &amp;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="keyword">call </span>mom_error(fatal, <span class="stringliteral">&quot;initialize_OCMIP2_CFC: Unable to open &quot;</span>//cs%IC_file)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">if</span> (cs%Z_IC_file) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      ok = tracer_z_init(tr, h, cs%IC_file, name, g, us)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keywordflow">if</span> (.not.ok) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        ok = tracer_z_init(tr, h, cs%IC_file, trim(name), g, us)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">if</span> (.not.ok) <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;initialize_OCMIP2_CFC: &quot;</span>//&amp;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                <span class="stringliteral">&quot;Unable to read &quot;</span>//trim(name)//<span class="stringliteral">&quot; from &quot;</span>//&amp;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                trim(cs%IC_file)//<span class="stringliteral">&quot;.&quot;</span>)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keyword">call </span>mom_read_data(cs%IC_file, trim(name), tr, g%Domain)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">do</span> k=1,nz ; <span class="keywordflow">do</span> j=js,je ; <span class="keywordflow">do</span> i=is,ie</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">if</span> (g%mask2dT(i,j) &lt; 0.5) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        tr(i,j,k) = land_val</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        tr(i,j,k) = ic_val</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="keywordflow">    enddo</span> ;<span class="keywordflow"> enddo</span> ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MOM__error__handler_8F90_source.html#l00072">mom_error_handler::mom_error()</a>, and <a class="el" href="MOM__tracer__Z__init_8F90_source.html#l00031">mom_tracer_z_init::tracer_z_init()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html#l00317">initialize_ocmip2_cfc()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__ocmip2__cfc_a293cd355bf164bfd6bbe2cda4b00ad12_cgraph.svg" width="100%" height="478"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__ocmip2__cfc_a293cd355bf164bfd6bbe2cda4b00ad12_icgraph.svg" width="390" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aaaa0b7695728d3761d5f25688838f5fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaaa0b7695728d3761d5f25688838f5fc">&#9670;&nbsp;</a></span>initialize_ocmip2_cfc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_ocmip2_cfc::initialize_ocmip2_cfc </td>
          <td>(</td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>restart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(time_type), intent(in), target&#160;</td>
          <td class="paramname"><em>day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(ocean_grid_type), intent(in)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(szi_(g),szj_(g),szk_(g)), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(diag_ctrl), intent(in), target&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(ocean_obc_type), pointer&#160;</td>
          <td class="paramname"><em>OBC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__ocmip2__cfc_1_1ocmip2__cfc__cs.html">ocmip2_cfc_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(sponge_cs), pointer&#160;</td>
          <td class="paramname"><em>sponge_CSp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the OCMP2 CFC tracer fields and set up the tracer output. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">restart</td><td>.true. if the fields have already been read from a restart file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">day</td><td>Time of the start of the run. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>The ocean's grid structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>The ocean's vertical grid structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Layer thicknesses [H ~&gt; m or kg m-2]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">diag</td><td>A structure that is used to regulate diagnostic output. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">obc</td><td>This open boundary condition type specifies whether, where, and what open boundary conditions are used. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cs</td><td>The control structure returned by a previous call to register_OCMIP2_CFC. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">sponge_csp</td><td>A pointer to the control structure for the sponges, if they are in use. Otherwise this may be unassociated. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html#l00317">317</a> of file <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html">MOM_OCMIP2_CFC.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordtype">logical</span>,                        <span class="keywordtype">intent(in)</span> :: restart<span class="comment">    !&lt; .true. if the fields have already been</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">                                                           !! read from a restart file.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordtype">type</span>(time_type), <span class="keywordtype">target</span>,        <span class="keywordtype">intent(in)</span> :: day<span class="comment">        !&lt; Time of the start of the run.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type),          <span class="keywordtype">intent(in)</span> :: G<span class="comment">          !&lt; The ocean&#39;s grid structure.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type),        <span class="keywordtype">intent(in)</span> :: GV<span class="comment">         !&lt; The ocean&#39;s vertical grid structure.</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type),          <span class="keywordtype">intent(in)</span> :: US<span class="comment">         !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G),SZK_(G))</span>, &amp;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                  <span class="keywordtype">intent(in)</span> :: h<span class="comment">          !&lt; Layer thicknesses [H ~&gt; m or kg m-2].</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">target</span>,        <span class="keywordtype">intent(in)</span> :: diag<span class="comment">       !&lt; A structure that is used to regulate</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">                                                           !! diagnostic output.</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordtype">type</span>(ocean_OBC_type),           <span class="keywordtype">pointer</span>    :: OBC<span class="comment">        !&lt; This open boundary condition type</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">                                                           !! specifies whether, where, and what</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">                                                           !! open boundary conditions are used.</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordtype">type</span>(OCMIP2_CFC_CS),            <span class="keywordtype">pointer</span>    :: CS<span class="comment">         !&lt; The control structure returned by a</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">                                                           !! previous call to register_OCMIP2_CFC.</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordtype">type</span>(sponge_CS),                <span class="keywordtype">pointer</span>    :: sponge_CSp<span class="comment"> !&lt; A pointer to the control structure for</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">                                                           !! the sponges, if they are in use.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">                                                           !! Otherwise this may be unassociated.</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">!   This subroutine initializes the NTR tracer fields in tr(:,:,:,:)</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">! and it sets up the tracer output.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordtype">logical</span> :: from_file = .false.</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordflow">if</span> (.not.<span class="keyword">associated</span>(cs)) <span class="keywordflow">return</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  cs%Time =&gt; day</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  cs%diag =&gt; diag</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">if</span> (.not.restart .or. (cs%tracers_may_reinit .and. &amp;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      .not.query_initialized(cs%CFC11, cs%CFC11_name, cs%restart_CSp))) &amp;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keyword">call </span>init_tracer_cfc(h, cs%CFC11, cs%CFC11_name, cs%CFC11_land_val, &amp;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                         cs%CFC11_IC_val, g, us, cs)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordflow">if</span> (.not.restart .or. (cs%tracers_may_reinit .and. &amp;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      .not.query_initialized(cs%CFC12, cs%CFC12_name, cs%restart_CSp))) &amp;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keyword">call </span>init_tracer_cfc(h, cs%CFC12, cs%CFC12_name, cs%CFC12_land_val, &amp;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                         cs%CFC12_IC_val, g, us, cs)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">associated</span>(obc)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="comment">! Steal from updated DOME in the fullness of time.</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html#l00363">init_tracer_cfc()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__ocmip2__cfc_aaaa0b7695728d3761d5f25688838f5fc_cgraph.svg" width="100%" height="478"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="aebc84df12994a1f74d181ab54e380878"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebc84df12994a1f74d181ab54e380878">&#9670;&nbsp;</a></span>ocmip2_cfc_column_physics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_ocmip2_cfc::ocmip2_cfc_column_physics </td>
          <td>(</td>
          <td class="paramtype">real, dimension( g %isd: g %ied, g %jsd: g %jed, g %ke), intent(in)&#160;</td>
          <td class="paramname"><em>h_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( g %isd: g %ied, g %jsd: g %jed, g %ke), intent(in)&#160;</td>
          <td class="paramname"><em>h_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( g %isd: g %ied, g %jsd: g %jed, g %ke), intent(in)&#160;</td>
          <td class="paramname"><em>ea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( g %isd: g %ied, g %jsd: g %jed, g %ke), intent(in)&#160;</td>
          <td class="paramname"><em>eb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(forcing), intent(in)&#160;</td>
          <td class="paramname"><em>fluxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(ocean_grid_type), intent(in)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__ocmip2__cfc_1_1ocmip2__cfc__cs.html">ocmip2_cfc_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>evap_CFL_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>minimum_forcing_depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine applies diapycnal diffusion, souces and sinks and any other column tracer physics or chemistry to the OCMIP2 CFC tracers. CFCs are relatively simple, as they are passive tracers with only a surface flux as a source. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>The ocean's grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>The ocean's vertical grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h_old</td><td>Layer thickness before entrainment [H ~&gt; m or kg m-2]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h_new</td><td>Layer thickness after entrainment [H ~&gt; m or kg m-2]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ea</td><td>an array to which the amount of fluid entrained </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eb</td><td>an array to which the amount of fluid entrained </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fluxes</td><td>A structure containing pointers to thermodynamic and tracer forcing fields. Unused fields have NULL ptrs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>The amount of time covered by this call [T ~&gt; s] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cs</td><td>The control structure returned by a previous call to register_OCMIP2_CFC. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">evap_cfl_limit</td><td>Limit on the fraction of the water that can be fluxed out of the top layer in a timestep [nondim] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">minimum_forcing_depth</td><td>The smallest depth over which fluxes can be applied [H ~&gt; m or kg m-2] </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html#l00411">411</a> of file <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html">MOM_OCMIP2_CFC.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type),   <span class="keywordtype">intent(in)</span> :: G<span class="comment">    !&lt; The ocean&#39;s grid structure</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type), <span class="keywordtype">intent(in)</span> :: GV<span class="comment">   !&lt; The ocean&#39;s vertical grid structure</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G),SZK_(G))</span>, &amp;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                           <span class="keywordtype">intent(in)</span> :: h_old<span class="comment"> !&lt; Layer thickness before entrainment [H ~&gt; m or kg m-2].</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G),SZK_(G))</span>, &amp;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                           <span class="keywordtype">intent(in)</span> :: h_new<span class="comment"> !&lt; Layer thickness after entrainment [H ~&gt; m or kg m-2].</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G),SZK_(G))</span>, &amp;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                           <span class="keywordtype">intent(in)</span> :: ea<span class="comment">   !&lt; an array to which the amount of fluid entrained</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">                                              !! from the layer above during this call will be</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">                                              !! added [H ~&gt; m or kg m-2].</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G),SZK_(G))</span>, &amp;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                           <span class="keywordtype">intent(in)</span> :: eb<span class="comment">   !&lt; an array to which the amount of fluid entrained</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">                                              !! from the layer below during this call will be</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">                                              !! added [H ~&gt; m or kg m-2].</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordtype">type</span>(forcing),           <span class="keywordtype">intent(in)</span> :: fluxes<span class="comment"> !&lt; A structure containing pointers to thermodynamic</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">                                              !! and tracer forcing fields.  Unused fields have NULL ptrs.</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="keywordtype">  real</span>,                    <span class="keywordtype">intent(in)</span> :: dt<span class="comment">   !&lt; The amount of time covered by this call [T ~&gt; s]</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type),   <span class="keywordtype">intent(in)</span> :: US<span class="comment">   !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordtype">type</span>(OCMIP2_CFC_CS),     <span class="keywordtype">pointer</span>    :: CS<span class="comment">   !&lt; The control structure returned by a</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">                                              !! previous call to register_OCMIP2_CFC.</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keywordtype">  real</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: evap_CFL_limit<span class="comment"> !&lt; Limit on the fraction of the water that can</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">                                              !! be fluxed out of the top layer in a timestep [nondim]</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="keywordtype">  real</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: minimum_forcing_depth<span class="comment"> !&lt; The smallest depth over which</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">                                              !! fluxes can be applied [H ~&gt; m or kg m-2]</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">!   This subroutine applies diapycnal diffusion and any other column</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">! tracer physics or chemistry to the tracers from this file.</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">! CFCs are relatively simple, as they are passive tracers. with only a surface</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">! flux as a source.</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">! The arguments to this subroutine are redundant in that</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">!     h_new(k) = h_old(k) + ea(k) - eb(k-1) + eb(k) - ea(k+1)</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keywordtype">  real</span> :: b1(SZI_(G))          <span class="comment">! b1 and c1 are variables used by the</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="keywordtype">  real</span> :: c1(SZI_(G),SZK_(G))  <span class="comment">! tridiagonal solver.</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G))</span> :: &amp;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    CFC11_flux, &amp;    <span class="comment">! The fluxes of CFC11 and CFC12 into the ocean, in the</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    CFC12_flux       <span class="comment">! units of CFC concentrations times meters per second.</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">dimension(:,:,:)</span> :: CFC11 =&gt; null(), cfc12 =&gt; null()</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G),SZK_(G))</span> :: h_work <span class="comment">! Used so that h can be modified</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordtype">integer</span> :: i, j, k, m, is, ie, js, je, nz, idim(4), jdim(4)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  is = g%isc ; ie = g%iec ; js = g%jsc ; je = g%jec ; nz = gv%ke</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  idim(:) = (/g%isd, is, ie, g%ied/) ; jdim(:) = (/g%jsd, js, je, g%jed/)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keywordflow">if</span> (.not.<span class="keyword">associated</span>(cs)) <span class="keywordflow">return</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  cfc11 =&gt; cs%CFC11 ; cfc12 =&gt; cs%CFC12</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">! These two calls unpack the fluxes from the input arrays.</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="comment">!   The -GV%Rho0 changes the sign convention of the flux and changes the units</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="comment">! of the flux from [Conc. m s-1] to [Conc. kg m-2 T-1].</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keyword">call </span>coupler_type_extract_data(fluxes%tr_fluxes, cs%ind_cfc_11_flux, ind_flux, cfc11_flux, &amp;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                                 scale_factor=-g%US%R_to_kg_m3*gv%Rho0*us%T_to_s, idim=idim, jdim=jdim)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keyword">call </span>coupler_type_extract_data(fluxes%tr_fluxes, cs%ind_cfc_12_flux, ind_flux, cfc12_flux, &amp;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                                 scale_factor=-g%US%R_to_kg_m3*gv%Rho0*us%T_to_s, idim=idim, jdim=jdim)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="comment">! Use a tridiagonal solver to determine the concentrations after the</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="comment">! surface source is applied and diapycnal advection and diffusion occurs.</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(evap_cfl_limit) .and. <span class="keyword">present</span>(minimum_forcing_depth)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">do</span> k=1,nz ;<span class="keywordflow">do</span> j=js,je ; <span class="keywordflow">do</span> i=is,ie</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      h_work(i,j,k) = h_old(i,j,k)</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="keywordflow">    enddo</span> ;<span class="keywordflow"> enddo</span> ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keyword">call </span>applytracerboundaryfluxesinout(g, gv, cfc11, dt, fluxes, h_work, &amp;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                        evap_cfl_limit, minimum_forcing_depth)</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keyword">call </span>tracer_vertdiff(h_work, ea, eb, dt, cfc11, g, gv, sfc_flux=cfc11_flux)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">do</span> k=1,nz ;<span class="keywordflow">do</span> j=js,je ; <span class="keywordflow">do</span> i=is,ie</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      h_work(i,j,k) = h_old(i,j,k)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="keywordflow">    enddo</span> ;<span class="keywordflow"> enddo</span> ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keyword">call </span>applytracerboundaryfluxesinout(g, gv, cfc12, dt, fluxes, h_work, &amp;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                        evap_cfl_limit, minimum_forcing_depth)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keyword">call </span>tracer_vertdiff(h_work, ea, eb, dt, cfc12, g, gv, sfc_flux=cfc12_flux)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keyword">call </span>tracer_vertdiff(h_old, ea, eb, dt, cfc11, g, gv, sfc_flux=cfc11_flux)</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keyword">call </span>tracer_vertdiff(h_old, ea, eb, dt, cfc12, g, gv, sfc_flux=cfc12_flux)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">! Write out any desired diagnostics from tracer sources &amp; sinks here.</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MOM__tracer__diabatic_8F90_source.html#l00230">mom_tracer_diabatic::applytracerboundaryfluxesinout()</a>, and <a class="el" href="MOM__tracer__diabatic_8F90_source.html#l00027">mom_tracer_diabatic::tracer_vertdiff()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__ocmip2__cfc_aebc84df12994a1f74d181ab54e380878_cgraph.svg" width="100%" height="388"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a225d2a7eacb485040fcac7f9b6766ee1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a225d2a7eacb485040fcac7f9b6766ee1">&#9670;&nbsp;</a></span>ocmip2_cfc_end()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_ocmip2_cfc::ocmip2_cfc_end </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__ocmip2__cfc_1_1ocmip2__cfc__cs.html">ocmip2_cfc_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>CS</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocate any memory associated with the OCMIP2 CFC tracer package. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cs</td><td>The control structure returned by a previous call to register_OCMIP2_CFC. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html#l00618">618</a> of file <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html">MOM_OCMIP2_CFC.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keywordtype">type</span>(OCMIP2_CFC_CS), <span class="keywordtype">pointer</span> :: CS<span class="comment">   !&lt; The control structure returned by a</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">                                       !! previous call to register_OCMIP2_CFC.</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">!   This subroutine deallocates the memory owned by this module.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">! Argument: CS - The control structure returned by a previous call to</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">!                register_OCMIP2_CFC.</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="keywordtype">integer</span> :: m</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">associated</span>(cs)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(cs%CFC11)) <span class="keyword">deallocate</span>(cs%CFC11)</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(cs%CFC12)) <span class="keyword">deallocate</span>(cs%CFC12)</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keyword">deallocate</span>(cs)</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="keywordflow">  endif</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3c9967ff09b37934eb5ef51535e7ee3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3c9967ff09b37934eb5ef51535e7ee3">&#9670;&nbsp;</a></span>ocmip2_cfc_stock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public mom_ocmip2_cfc::ocmip2_cfc_stock </td>
          <td>(</td>
          <td class="paramtype">real, dimension( g %isd: g %ied, g %jsd: g %jed, g %ke), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>stocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(ocean_grid_type), intent(in)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__ocmip2__cfc_1_1ocmip2__cfc__cs.html">ocmip2_cfc_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>units</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>stock_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function calculates the mass-weighted integral of all tracer stocks, returning the number of stocks it has calculated. If the stock_index is present, only the stock corresponding to that coded index is returned. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>The ocean's grid structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>The ocean's vertical grid structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Layer thicknesses [H ~&gt; m or kg m-2]. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stocks</td><td>the mass-weighted integrated amount of each tracer, in kg times concentration units [kg conc]. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cs</td><td>The control structure returned by a previous call to register_OCMIP2_CFC. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">names</td><td>The names of the stocks calculated. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">units</td><td>The units of the stocks calculated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stock_index</td><td>The coded index of a specific stock being sought. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of stocks calculated here. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html#l00497">497</a> of file <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html">MOM_OCMIP2_CFC.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type),           <span class="keywordtype">intent(in)</span>    :: G<span class="comment">      !&lt; The ocean&#39;s grid structure.</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type),         <span class="keywordtype">intent(in)</span>    :: GV<span class="comment">     !&lt; The ocean&#39;s vertical grid structure.</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G),SZK_(G))</span>, &amp;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                                   <span class="keywordtype">intent(in)</span>    :: h<span class="comment">      !&lt; Layer thicknesses [H ~&gt; m or kg m-2].</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(:)</span>,              <span class="keywordtype">intent(out)</span>   :: stocks<span class="comment"> !&lt; the mass-weighted integrated amount of each</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">                                                           !! tracer, in kg times concentration units [kg conc].</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordtype">type</span>(OCMIP2_CFC_CS),             <span class="keywordtype">pointer</span>       :: CS<span class="comment">     !&lt; The control structure returned by a</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">                                                           !! previous call to register_OCMIP2_CFC.</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">dimension(:)</span>,  <span class="keywordtype">intent(out)</span>   :: names<span class="comment">  !&lt; The names of the stocks calculated.</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">dimension(:)</span>,  <span class="keywordtype">intent(out)</span>   :: units<span class="comment">  !&lt; The units of the stocks calculated.</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">optional</span>,               <span class="keywordtype">intent(in)</span>    :: stock_index<span class="comment"> !&lt; The coded index of a specific</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">                                                                !! stock being sought.</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keywordtype">integer</span>                                        :: OCMIP2_CFC_stock<span class="comment"> !&lt; The number of stocks calculated here.</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="keywordtype">  real</span> :: mass</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keywordtype">integer</span> :: i, j, k, is, ie, js, je, nz</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  is = g%isc ; ie = g%iec ; js = g%jsc ; je = g%jec ; nz = gv%ke</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  ocmip2_cfc_stock = 0</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keywordflow">if</span> (.not.<span class="keyword">associated</span>(cs)) <span class="keywordflow">return</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(stock_index)) <span class="keywordflow">then</span> ; <span class="keywordflow">if</span> (stock_index &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">! Check whether this stock is available from this routine.</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">! No stocks from this routine are being checked yet.  Return 0.</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">return</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="keywordflow">  endif</span> ;<span class="keywordflow"> endif</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keyword">call </span>query_vardesc(cs%CFC11_desc, name=names(1), units=units(1), caller=<span class="stringliteral">&quot;OCMIP2_CFC_stock&quot;</span>)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keyword">call </span>query_vardesc(cs%CFC12_desc, name=names(2), units=units(2), caller=<span class="stringliteral">&quot;OCMIP2_CFC_stock&quot;</span>)</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  units(1) = trim(units(1))//<span class="stringliteral">&quot; kg&quot;</span> ; units(2) = trim(units(2))//<span class="stringliteral">&quot; kg&quot;</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  stocks(1) = 0.0 ; stocks(2) = 0.0</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordflow">do</span> k=1,nz ; <span class="keywordflow">do</span> j=js,je ; <span class="keywordflow">do</span> i=is,ie</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    mass = g%mask2dT(i,j) * g%US%L_to_m**2*g%areaT(i,j) * h(i,j,k)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    stocks(1) = stocks(1) + cs%CFC11(i,j,k) * mass</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    stocks(2) = stocks(2) + cs%CFC12(i,j,k) * mass</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="keywordflow">  enddo</span> ;<span class="keywordflow"> enddo</span> ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  stocks(1) = gv%H_to_kg_m2 * stocks(1)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  stocks(2) = gv%H_to_kg_m2 * stocks(2)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  ocmip2_cfc_stock = 2</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MOM__io_8F90_source.html#l00699">mom_io::query_vardesc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__tracer__flow__control_8F90_source.html#l00568">mom_tracer_flow_control::call_tracer_stocks()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__ocmip2__cfc_ac3c9967ff09b37934eb5ef51535e7ee3_cgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__ocmip2__cfc_ac3c9967ff09b37934eb5ef51535e7ee3_icgraph.svg" width="612" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="abe30443454b39aa620f0e7422de416e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe30443454b39aa620f0e7422de416e6">&#9670;&nbsp;</a></span>ocmip2_cfc_surface_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_ocmip2_cfc::ocmip2_cfc_surface_state </td>
          <td>(</td>
          <td class="paramtype">type(surface), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(szi_(g),szj_(g),szk_(g)), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(ocean_grid_type), intent(in)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__ocmip2__cfc_1_1ocmip2__cfc__cs.html">ocmip2_cfc_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>CS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine extracts the surface CFC concentrations and other fields that are shared with the atmosphere to calculate CFC fluxes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>The ocean's grid structure. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">state</td><td>A structure containing fields that describe the surface state of the ocean. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Layer thickness [H ~&gt; m or kg m-2]. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cs</td><td>The control structure returned by a previous call to register_OCMIP2_CFC. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html#l00546">546</a> of file <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html">MOM_OCMIP2_CFC.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type),  <span class="keywordtype">intent(in)</span>    :: G<span class="comment">  !&lt; The ocean&#39;s grid structure.</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordtype">type</span>(surface),          <span class="keywordtype">intent(inout)</span> :: state<span class="comment"> !&lt; A structure containing fields that</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">                                              !! describe the surface state of the ocean.</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G),SZK_(G))</span>, &amp;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                          <span class="keywordtype">intent(in)</span>    :: h<span class="comment">  !&lt; Layer thickness [H ~&gt; m or kg m-2].</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordtype">type</span>(OCMIP2_CFC_CS),    <span class="keywordtype">pointer</span>       :: CS<span class="comment"> !&lt; The control structure returned by a previous</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">                                              !! call to register_OCMIP2_CFC.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G))</span> :: &amp;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    CFC11_Csurf, &amp;  <span class="comment">! The CFC-11 surface concentrations times the Schmidt number term [mol m-3].</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    CFC12_Csurf, &amp;  <span class="comment">! The CFC-12 surface concentrations times the Schmidt number term [mol m-3].</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    CFC11_alpha, &amp;  <span class="comment">! The CFC-11 solubility [mol m-3 pptv-1].</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    CFC12_alpha     <span class="comment">! The CFC-12 solubility [mol m-3 pptv-1].</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="keywordtype">  real</span> :: ta        <span class="comment">! Absolute sea surface temperature [hectoKelvin] (Why use such bizzare units?)</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="keywordtype">  real</span> :: sal       <span class="comment">! Surface salinity [PSU].</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="keywordtype">  real</span> :: SST       <span class="comment">! Sea surface temperature [degC].</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="keywordtype">  real</span> :: alpha_11  <span class="comment">! The solubility of CFC 11 [mol m-3 pptv-1].</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="keywordtype">  real</span> :: alpha_12  <span class="comment">! The solubility of CFC 12 [mol m-3 pptv-1].</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="keywordtype">  real</span> :: sc_11, sc_12 <span class="comment">! The Schmidt numbers of CFC 11 and CFC 12.</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="keywordtype">  real</span> :: sc_no_term   <span class="comment">! A term related to the Schmidt number.</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordtype">integer</span> :: i, j, m, is, ie, js, je, idim(4), jdim(4)</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  is = g%isc ; ie = g%iec ; js = g%jsc ; je = g%jec</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  idim(:) = (/g%isd, is, ie, g%ied/) ; jdim(:) = (/g%jsd, js, je, g%jed/)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">if</span> (.not.<span class="keyword">associated</span>(cs)) <span class="keywordflow">return</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordflow">do</span> j=js,je ; <span class="keywordflow">do</span> i=is,ie</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    ta = max(0.01, (state%SST(i,j) + 273.15) * 0.01) <span class="comment">! Why is this in hectoKelvin?</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    sal = state%SSS(i,j) ; sst = state%SST(i,j)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">!    Calculate solubilities using Warner and Weiss (1985) DSR, vol 32.</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="comment">! The final result is in mol/cm3/pptv (1 part per trillion 1e-12)</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">! Use Bullister and Wisegavger for CCl4.</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">! The factor 1.e-09 converts from mol/(l * atm) to mol/(m3 * pptv).</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    alpha_11 = exp(cs%d1_11 + cs%d2_11/ta + cs%d3_11*log(ta) + cs%d4_11*ta**2 +&amp;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                   sal * ((cs%e3_11 * ta + cs%e2_11) * ta + cs%e1_11)) * &amp;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;               1.0e-09 * g%mask2dT(i,j)</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    alpha_12 = exp(cs%d1_12 + cs%d2_12/ta + cs%d3_12*log(ta) + cs%d4_12*ta**2 +&amp;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                   sal * ((cs%e3_12 * ta + cs%e2_12) * ta + cs%e1_12)) * &amp;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;               1.0e-09 * g%mask2dT(i,j)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">!   Calculate Schmidt numbers using coefficients given by</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">! Zheng et al (1998), JGR vol 103, C1.</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    sc_11 = cs%a1_11 + sst * (cs%a2_11 + sst * (cs%a3_11 + sst * cs%a4_11)) * &amp;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            g%mask2dT(i,j)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    sc_12 = cs%a1_12 + sst * (cs%a2_12 + sst * (cs%a3_12 + sst * cs%a4_12)) * &amp;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            g%mask2dT(i,j)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="comment">! The abs here is to avoid NaNs. The model should be failing at this point.</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    sc_no_term = sqrt(660.0 / (abs(sc_11) + 1.0e-30))</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    cfc11_alpha(i,j) = alpha_11 * sc_no_term</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    cfc11_csurf(i,j) = cs%CFC11(i,j,1) * sc_no_term</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    sc_no_term = sqrt(660.0 / (abs(sc_12) + 1.0e-30))</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    cfc12_alpha(i,j) = alpha_12 * sc_no_term</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    cfc12_csurf(i,j) = cs%CFC12(i,j,1) * sc_no_term</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="keywordflow">  enddo</span> ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="comment">!   These calls load these values into the appropriate arrays in the</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="comment">! coupler-type structure.</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keyword">call </span>coupler_type_set_data(cfc11_alpha, cs%ind_cfc_11_flux, ind_alpha, &amp;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                             state%tr_fields, idim=idim, jdim=jdim)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keyword">call </span>coupler_type_set_data(cfc11_csurf, cs%ind_cfc_11_flux, ind_csurf, &amp;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                             state%tr_fields, idim=idim, jdim=jdim)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keyword">call </span>coupler_type_set_data(cfc12_alpha, cs%ind_cfc_12_flux, ind_alpha, &amp;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                             state%tr_fields, idim=idim, jdim=jdim)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keyword">call </span>coupler_type_set_data(cfc12_csurf, cs%ind_cfc_12_flux, ind_csurf, &amp;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                             state%tr_fields, idim=idim, jdim=jdim)</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac04494ce35222c8583a7ee7589e1cf13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac04494ce35222c8583a7ee7589e1cf13">&#9670;&nbsp;</a></span>register_ocmip2_cfc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function, public mom_ocmip2_cfc::register_ocmip2_cfc </td>
          <td>(</td>
          <td class="paramtype">type(hor_index_type), intent(in)&#160;</td>
          <td class="paramname"><em>HI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(param_file_type), intent(in)&#160;</td>
          <td class="paramname"><em>param_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__ocmip2__cfc_1_1ocmip2__cfc__cs.html">ocmip2_cfc_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tracer_registry_type), pointer&#160;</td>
          <td class="paramname"><em>tr_Reg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(mom_restart_cs), pointer&#160;</td>
          <td class="paramname"><em>restart_CS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register the OCMIP2 CFC tracers to be used with MOM and read the parameters that are used with this tracer package. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hi</td><td>A horizontal index type structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>The ocean's vertical grid structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param_file</td><td>A structure to parse for run-time parameters. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cs</td><td>A pointer that is set to point to the control structure for this module. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">tr_reg</td><td>A pointer to the tracer registry. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">restart_cs</td><td>A pointer to the restart control structure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html#l00093">93</a> of file <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html">MOM_OCMIP2_CFC.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">type</span>(hor_index_type),    <span class="keywordtype">intent(in)</span> :: HI<span class="comment">         !&lt; A horizontal index type structure.</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type), <span class="keywordtype">intent(in)</span> :: GV<span class="comment">         !&lt; The ocean&#39;s vertical grid structure.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">type</span>(param_file_type),   <span class="keywordtype">intent(in)</span> :: param_file<span class="comment"> !&lt; A structure to parse for run-time parameters.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">type</span>(OCMIP2_CFC_CS),     <span class="keywordtype">pointer</span>    :: CS<span class="comment">         !&lt; A pointer that is set to point to the control</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">                                                    !! structure for this module.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordtype">type</span>(tracer_registry_type), &amp;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                           <span class="keywordtype">pointer</span>    :: tr_Reg<span class="comment">     !&lt; A pointer to the tracer registry.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">type</span>(MOM_restart_CS),    <span class="keywordtype">pointer</span>    :: restart_CS<span class="comment"> !&lt; A pointer to the restart control structure.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">! This subroutine is used to register tracer fields and subroutines</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">! to be used with MOM.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">character(len=40)</span>  :: mdl = <span class="stringliteral">&quot;MOM_OCMIP2_CFC&quot;</span> <span class="comment">! This module&#39;s name.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">character(len=200)</span> :: inputdir <span class="comment">! The directory where NetCDF input files are.</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">! This include declares and sets the variable &quot;version&quot;.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#include &quot;version_variable.h&quot;</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor"></span><span class="keywordtype">  real</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">pointer</span> :: tr_ptr =&gt; null()</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keywordtype">  real</span> :: a11_dflt(4), a12_dflt(4) <span class="comment">! Default values of the various coefficients</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keywordtype">  real</span> :: d11_dflt(4), d12_dflt(4) <span class="comment">! In the expressions for the solubility and</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keywordtype">  real</span> :: e11_dflt(3), e12_dflt(3) <span class="comment">! Schmidt numbers.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">character(len=48)</span> :: flux_units <span class="comment">! The units for tracer fluxes.</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">logical</span> :: register_OCMIP2_CFC</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">integer</span> :: isd, ied, jsd, jed, nz, m</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  isd = hi%isd ; ied = hi%ied ; jsd = hi%jsd ; jed = hi%jed ; nz = gv%ke</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">associated</span>(cs)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keyword">call </span>mom_error(warning, <span class="stringliteral">&quot;register_OCMIP2_CFC called with an &quot;</span>// &amp;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                            <span class="stringliteral">&quot;associated control structure.&quot;</span>)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">return</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keyword">allocate</span>(cs)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="comment">! This call sets default properties for the air-sea CFC fluxes and obtains the</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">! indicies for the CFC11 and CFC12 flux coupling.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keyword">call </span>flux_init_ocmip2_cfc(cs, verbosity=3)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">if</span> ((cs%ind_cfc_11_flux &lt; 0) .or. (cs%ind_cfc_11_flux &lt; 0)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">! This is most likely to happen with the dummy version of aof_set_coupler_flux</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">! used in ocean-only runs.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keyword">call </span>mom_error(warning, <span class="stringliteral">&quot;CFCs are currently only set up to be run in &quot;</span> // &amp;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                   <span class="stringliteral">&quot; coupled model configurations, and will be disabled.&quot;</span>)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keyword">deallocate</span>(cs)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    register_ocmip2_cfc = .false.</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">return</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="comment">! Read all relevant parameters and write them to the model log.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keyword">call </span>log_version(param_file, mdl, version, <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC_IC_FILE&quot;</span>, cs%IC_file, &amp;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                 <span class="stringliteral">&quot;The file in which the CFC initial values can be &quot;</span>//&amp;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                 <span class="stringliteral">&quot;found, or an empty string for internal initialization.&quot;</span>, &amp;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                 default=<span class="stringliteral">&quot; &quot;</span>)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">if</span> ((len_trim(cs%IC_file) &gt; 0) .and. (scan(cs%IC_file,<span class="stringliteral">&#39;/&#39;</span>) == 0)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">! Add the directory if CS%IC_file is not already a complete path.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;INPUTDIR&quot;</span>, inputdir, default=<span class="stringliteral">&quot;.&quot;</span>)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    cs%IC_file = trim(slasher(inputdir))//trim(cs%IC_file)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keyword">call </span>log_param(param_file, mdl, <span class="stringliteral">&quot;INPUTDIR/CFC_IC_FILE&quot;</span>, cs%IC_file)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC_IC_FILE_IS_Z&quot;</span>, cs%Z_IC_file, &amp;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                 <span class="stringliteral">&quot;If true, CFC_IC_FILE is in depth space, not layer space&quot;</span>, &amp;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                 default=.false.)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;TRACERS_MAY_REINIT&quot;</span>, cs%tracers_may_reinit, &amp;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                 <span class="stringliteral">&quot;If true, tracers may go through the initialization code &quot;</span>//&amp;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                 <span class="stringliteral">&quot;if they are not found in the restart files.  Otherwise &quot;</span>//&amp;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                 <span class="stringliteral">&quot;it is a fatal error if tracers are not found in the &quot;</span>//&amp;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                 <span class="stringliteral">&quot;restart files of a restarted run.&quot;</span>, default=.false.)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="comment">!   The following vardesc types contain a package of metadata about each tracer,</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="comment">! including, the name; units; longname; and grid information.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  cs%CFC11_name = <span class="stringliteral">&quot;CFC11&quot;</span> ; cs%CFC12_name = <span class="stringliteral">&quot;CFC12&quot;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  cs%CFC11_desc = var_desc(cs%CFC11_name,<span class="stringliteral">&quot;mol m-3&quot;</span>,<span class="stringliteral">&quot;CFC-11 Concentration&quot;</span>, caller=mdl)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  cs%CFC12_desc = var_desc(cs%CFC12_name,<span class="stringliteral">&quot;mol m-3&quot;</span>,<span class="stringliteral">&quot;CFC-12 Concentration&quot;</span>, caller=mdl)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">if</span> (gv%Boussinesq) <span class="keywordflow">then</span> ; flux_units = <span class="stringliteral">&quot;mol s-1&quot;</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">else</span> ; flux_units = <span class="stringliteral">&quot;mol m-3 kg s-1&quot;</span> ;<span class="keywordflow"> endif</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keyword">allocate</span>(cs%CFC11(isd:ied,jsd:jed,nz)) ; cs%CFC11(:,:,:) = 0.0</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keyword">allocate</span>(cs%CFC12(isd:ied,jsd:jed,nz)) ; cs%CFC12(:,:,:) = 0.0</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">! This pointer assignment is needed to force the compiler not to do a copy in</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">! the registration calls.  Curses on the designers and implementers of F90.</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  tr_ptr =&gt; cs%CFC11</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">! Register CFC11 for horizontal advection, diffusion, and restarts.</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keyword">call </span>register_tracer(tr_ptr, tr_reg, param_file, hi, gv, &amp;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                       tr_desc=cs%CFC11_desc, registry_diags=.true., &amp;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                       flux_units=flux_units, &amp;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                       restart_cs=restart_cs, mandatory=.not.cs%tracers_may_reinit)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">! Do the same for CFC12</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  tr_ptr =&gt; cs%CFC12</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keyword">call </span>register_tracer(tr_ptr, tr_reg, param_file, hi, gv, &amp;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                       tr_desc=cs%CFC12_desc, registry_diags=.true., &amp;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                       flux_units=flux_units, &amp;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                       restart_cs=restart_cs, mandatory=.not.cs%tracers_may_reinit)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">! Set and read the various empirical coefficients.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">! Default Schmidt number coefficients for CFC11 (_11) and CFC12 (_12) are given</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">! by Zheng et al (1998), JGR vol 103, C1.</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  a11_dflt(:) = (/ 3501.8, -210.31,  6.1851, -0.07513 /)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  a12_dflt(:) = (/ 3845.4, -228.95,  6.1908, -0.06743 /)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC11_A1&quot;</span>, cs%a1_11, &amp;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the Schmidt number of CFC11.&quot;</span>, &amp;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                 units=<span class="stringliteral">&quot;nondim&quot;</span>, default=a11_dflt(1))</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC11_A2&quot;</span>, cs%a2_11, &amp;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the Schmidt number of CFC11.&quot;</span>, &amp;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                 units=<span class="stringliteral">&quot;degC-1&quot;</span>, default=a11_dflt(2))</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC11_A3&quot;</span>, cs%a3_11, &amp;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the Schmidt number of CFC11.&quot;</span>, &amp;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                 units=<span class="stringliteral">&quot;degC-2&quot;</span>, default=a11_dflt(3))</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC11_A4&quot;</span>, cs%a4_11, &amp;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the Schmidt number of CFC11.&quot;</span>, &amp;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                 units=<span class="stringliteral">&quot;degC-3&quot;</span>, default=a11_dflt(4))</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC12_A1&quot;</span>, cs%a1_12, &amp;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the Schmidt number of CFC12.&quot;</span>, &amp;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                 units=<span class="stringliteral">&quot;nondim&quot;</span>, default=a12_dflt(1))</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC12_A2&quot;</span>, cs%a2_12, &amp;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the Schmidt number of CFC12.&quot;</span>, &amp;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                 units=<span class="stringliteral">&quot;degC-1&quot;</span>, default=a12_dflt(2))</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC12_A3&quot;</span>, cs%a3_12, &amp;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the Schmidt number of CFC12.&quot;</span>, &amp;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                 units=<span class="stringliteral">&quot;degC-2&quot;</span>, default=a12_dflt(3))</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC12_A4&quot;</span>, cs%a4_12, &amp;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the Schmidt number of CFC12.&quot;</span>, &amp;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                 units=<span class="stringliteral">&quot;degC-3&quot;</span>, default=a12_dflt(4))</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">! Solubility coefficients for alpha in mol/l/atm for CFC11 (_11) and CFC12 (_12)</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">! after Warner and Weiss (1985) DSR, vol 32.</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  d11_dflt(:) = (/ -229.9261, 319.6552, 119.4471, -1.39165 /)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  e11_dflt(:) = (/ -0.142382, 0.091459, -0.0157274 /)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  d12_dflt(:) = (/ -218.0971, 298.9702, 113.8049, -1.39165 /)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  e12_dflt(:) = (/ -0.143566, 0.091015, -0.0153924 /)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC11_D1&quot;</span>, cs%d1_11, &amp;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the solubility of CFC11.&quot;</span>, &amp;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                 units=<span class="stringliteral">&quot;none&quot;</span>, default=d11_dflt(1))</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC11_D2&quot;</span>, cs%d2_11, &amp;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the solubility of CFC11.&quot;</span>, &amp;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                 units=<span class="stringliteral">&quot;hK&quot;</span>, default=d11_dflt(2))</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC11_D3&quot;</span>, cs%d3_11, &amp;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the solubility of CFC11.&quot;</span>, &amp;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                 units=<span class="stringliteral">&quot;none&quot;</span>, default=d11_dflt(3))</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC11_D4&quot;</span>, cs%d4_11, &amp;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the solubility of CFC11.&quot;</span>, &amp;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                 units=<span class="stringliteral">&quot;hK-2&quot;</span>, default=d11_dflt(4))</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC11_E1&quot;</span>, cs%e1_11, &amp;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the solubility of CFC11.&quot;</span>, &amp;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                 units=<span class="stringliteral">&quot;PSU-1&quot;</span>, default=e11_dflt(1))</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC11_E2&quot;</span>, cs%e2_11, &amp;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the solubility of CFC11.&quot;</span>, &amp;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                 units=<span class="stringliteral">&quot;PSU-1 hK-1&quot;</span>, default=e11_dflt(2))</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC11_E3&quot;</span>, cs%e3_11, &amp;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the solubility of CFC11.&quot;</span>, &amp;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                 units=<span class="stringliteral">&quot;PSU-1 hK-2&quot;</span>, default=e11_dflt(3))</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC12_D1&quot;</span>, cs%d1_12, &amp;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the solubility of CFC12.&quot;</span>, &amp;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                 units=<span class="stringliteral">&quot;none&quot;</span>, default=d12_dflt(1))</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC12_D2&quot;</span>, cs%d2_12, &amp;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the solubility of CFC12.&quot;</span>, &amp;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                 units=<span class="stringliteral">&quot;hK&quot;</span>, default=d12_dflt(2))</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC12_D3&quot;</span>, cs%d3_12, &amp;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the solubility of CFC12.&quot;</span>, &amp;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                 units=<span class="stringliteral">&quot;none&quot;</span>, default=d12_dflt(3))</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC12_D4&quot;</span>, cs%d4_12, &amp;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the solubility of CFC12.&quot;</span>, &amp;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                 units=<span class="stringliteral">&quot;hK-2&quot;</span>, default=d12_dflt(4))</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC12_E1&quot;</span>, cs%e1_12, &amp;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the solubility of CFC12.&quot;</span>, &amp;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                 units=<span class="stringliteral">&quot;PSU-1&quot;</span>, default=e12_dflt(1))</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC12_E2&quot;</span>, cs%e2_12, &amp;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the solubility of CFC12.&quot;</span>, &amp;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                 units=<span class="stringliteral">&quot;PSU-1 hK-1&quot;</span>, default=e12_dflt(2))</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CFC12_E3&quot;</span>, cs%e3_12, &amp;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                 <span class="stringliteral">&quot;A coefficient in the solubility of CFC12.&quot;</span>, &amp;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                 units=<span class="stringliteral">&quot;PSU-1 hK-2&quot;</span>, default=e12_dflt(3))</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  cs%tr_Reg =&gt; tr_reg</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  cs%restart_CSp =&gt; restart_cs</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  register_ocmip2_cfc = .true.</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html#l00282">flux_init_ocmip2_cfc()</a>, <a class="el" href="MOM__error__handler_8F90_source.html#l00072">mom_error_handler::mom_error()</a>, <a class="el" href="MOM__tracer__registry_8F90_source.html#l00158">mom_tracer_registry::register_tracer()</a>, and <a class="el" href="MOM__io_8F90_source.html#l00600">mom_io::var_desc()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__ocmip2__cfc_ac04494ce35222c8583a7ee7589e1cf13_cgraph.svg" width="100%" height="555"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="acfeb2ddc32eb2ea2b41a80226d729a88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfeb2ddc32eb2ea2b41a80226d729a88">&#9670;&nbsp;</a></span>ntr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter mom_ocmip2_cfc::ntr = 2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the number of tracers in this module. </p>

<p class="definition">Definition at line <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html#l00037">37</a> of file <a class="el" href="MOM__OCMIP2__CFC_8F90_source.html">MOM_OCMIP2_CFC.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: NTR = 2<span class="comment"> !&lt; the number of tracers in this module.</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemom__ocmip2__cfc.html">mom_ocmip2_cfc</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
