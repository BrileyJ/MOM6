<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MOM6: /glade/work/altuntas/cesm.sandboxes/cesm2_2_alpha_X_mom/components/mom/MOM6/src/tracer/MOM_neutral_diffusion.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MOM6
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('MOM__neutral__diffusion_8F90.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">MOM_neutral_diffusion.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;MOM_memory.h&gt;</code><br />
<code>#include &quot;<a class="el" href="version__variable_8h_source.html">version_variable.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for MOM_neutral_diffusion.F90:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="MOM__neutral__diffusion_8F90__incl.svg" width="280" height="171"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="MOM__neutral__diffusion_8F90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmom__neutral__diffusion_1_1neutral__diffusion__cs.html">mom_neutral_diffusion::neutral_diffusion_cs</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The control structure for the MOM_neutral_diffusion module.  <a href="structmom__neutral__diffusion_1_1neutral__diffusion__cs.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacemom__neutral__diffusion"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html">mom_neutral_diffusion</a></td></tr>
<tr class="memdesc:namespacemom__neutral__diffusion"><td class="mdescLeft">&#160;</td><td class="mdescRight">A column-wise toolbox for implementing neutral diffusion. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a1787460c9352c9da0906806a2e44b122"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a1787460c9352c9da0906806a2e44b122">mom_neutral_diffusion::neutral_diffusion_init</a> (Time, G, param_file, diag, EOS, diabatic_CSp, CS)</td></tr>
<tr class="memdesc:a1787460c9352c9da0906806a2e44b122"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read parameters and allocate control structure for neutral_diffusion module.  <a href="namespacemom__neutral__diffusion.html#a1787460c9352c9da0906806a2e44b122">More...</a><br /></td></tr>
<tr class="separator:a1787460c9352c9da0906806a2e44b122"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a572a6c3f71eec3adb740a788b4ac21bd"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a572a6c3f71eec3adb740a788b4ac21bd">mom_neutral_diffusion::neutral_diffusion_calc_coeffs</a> (G, GV, US, h, T, S, CS)</td></tr>
<tr class="memdesc:a572a6c3f71eec3adb740a788b4ac21bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate remapping factors for u/v columns used to map adjoining columns to a shared coordinate space.  <a href="namespacemom__neutral__diffusion.html#a572a6c3f71eec3adb740a788b4ac21bd">More...</a><br /></td></tr>
<tr class="separator:a572a6c3f71eec3adb740a788b4ac21bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5469b7be43f8c428f092b58dd5ca41c8"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a5469b7be43f8c428f092b58dd5ca41c8">mom_neutral_diffusion::neutral_diffusion</a> (G, GV, h, Coef_x, Coef_y, dt, Reg, US, CS)</td></tr>
<tr class="memdesc:a5469b7be43f8c428f092b58dd5ca41c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update tracer concentration due to neutral diffusion; layer thickness unchanged by this update.  <a href="namespacemom__neutral__diffusion.html#a5469b7be43f8c428f092b58dd5ca41c8">More...</a><br /></td></tr>
<tr class="separator:a5469b7be43f8c428f092b58dd5ca41c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec9b89b6a5ddc81f102309b964a0b969"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#aec9b89b6a5ddc81f102309b964a0b969">mom_neutral_diffusion::interface_scalar</a> (nk, h, S, Si, i_method, h_neglect)</td></tr>
<tr class="memdesc:aec9b89b6a5ddc81f102309b964a0b969"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns interface scalar, Si, for a column of layer values, S.  <a href="namespacemom__neutral__diffusion.html#aec9b89b6a5ddc81f102309b964a0b969">More...</a><br /></td></tr>
<tr class="separator:aec9b89b6a5ddc81f102309b964a0b969"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae931a15b9ab6a7672b005eb5fe382219"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#ae931a15b9ab6a7672b005eb5fe382219">mom_neutral_diffusion::ppm_edge</a> (hkm1, hk, hkp1, hkp2, Ak, Akp1, Pk, Pkp1, h_neglect)</td></tr>
<tr class="memdesc:ae931a15b9ab6a7672b005eb5fe382219"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the PPM quasi-fourth order edge value at k+1/2 following equation 1.6 in Colella &amp; Woodward, 1984: JCP 54, 174-201.  <a href="namespacemom__neutral__diffusion.html#ae931a15b9ab6a7672b005eb5fe382219">More...</a><br /></td></tr>
<tr class="separator:ae931a15b9ab6a7672b005eb5fe382219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6931d9a07d09aa5d76d5abd2e47a54df"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a6931d9a07d09aa5d76d5abd2e47a54df">mom_neutral_diffusion::ppm_ave</a> (xL, xR, aL, aR, aMean)</td></tr>
<tr class="memdesc:a6931d9a07d09aa5d76d5abd2e47a54df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the average of a PPM reconstruction between two fractional positions.  <a href="namespacemom__neutral__diffusion.html#a6931d9a07d09aa5d76d5abd2e47a54df">More...</a><br /></td></tr>
<tr class="separator:a6931d9a07d09aa5d76d5abd2e47a54df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a118ace85483009d5b7a1841e3c745499"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a118ace85483009d5b7a1841e3c745499">mom_neutral_diffusion::signum</a> (a, x)</td></tr>
<tr class="memdesc:a118ace85483009d5b7a1841e3c745499"><td class="mdescLeft">&#160;</td><td class="mdescRight">A true signum function that returns either -abs(a), when x&lt;0; or abs(a) when x&gt;0; or 0 when x=0.  <a href="namespacemom__neutral__diffusion.html#a118ace85483009d5b7a1841e3c745499">More...</a><br /></td></tr>
<tr class="separator:a118ace85483009d5b7a1841e3c745499"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac211ae488cb6e3c6685df85d24ecd0dd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#ac211ae488cb6e3c6685df85d24ecd0dd">mom_neutral_diffusion::plm_diff</a> (nk, h, S, c_method, b_method, diff)</td></tr>
<tr class="memdesc:ac211ae488cb6e3c6685df85d24ecd0dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns PLM slopes for a column where the slopes are the difference in value across each cell. The limiting follows equation 1.8 in Colella &amp; Woodward, 1984: JCP 54, 174-201.  <a href="namespacemom__neutral__diffusion.html#ac211ae488cb6e3c6685df85d24ecd0dd">More...</a><br /></td></tr>
<tr class="separator:ac211ae488cb6e3c6685df85d24ecd0dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c5ac28d7c54581cdd872fe58ef0b204"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a1c5ac28d7c54581cdd872fe58ef0b204">mom_neutral_diffusion::fv_diff</a> (hkm1, hk, hkp1, Skm1, Sk, Skp1)</td></tr>
<tr class="memdesc:a1c5ac28d7c54581cdd872fe58ef0b204"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the cell-centered second-order finite volume (unlimited PLM) slope using three consecutive cell widths and average values. Slope is returned as a difference across the central cell (i.e. units of scalar S). Discretization follows equation 1.7 in Colella &amp; Woodward, 1984: JCP 54, 174-201.  <a href="namespacemom__neutral__diffusion.html#a1c5ac28d7c54581cdd872fe58ef0b204">More...</a><br /></td></tr>
<tr class="separator:a1c5ac28d7c54581cdd872fe58ef0b204"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ed3814088af470ad6fc4a3a80926fd7"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a6ed3814088af470ad6fc4a3a80926fd7">mom_neutral_diffusion::fvlsq_slope</a> (hkm1, hk, hkp1, Skm1, Sk, Skp1)</td></tr>
<tr class="memdesc:a6ed3814088af470ad6fc4a3a80926fd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the cell-centered second-order weighted least squares slope using three consecutive cell widths and average values. Slope is returned as a gradient (i.e. units of scalar S over width units).  <a href="namespacemom__neutral__diffusion.html#a6ed3814088af470ad6fc4a3a80926fd7">More...</a><br /></td></tr>
<tr class="separator:a6ed3814088af470ad6fc4a3a80926fd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb07c024cb6aa162a8789a4f50139aa5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#acb07c024cb6aa162a8789a4f50139aa5">mom_neutral_diffusion::find_neutral_surface_positions_continuous</a> (nk, Pl, Tl, Sl, dRdTl, dRdSl, Pr, Tr, Sr, dRdTr, dRdSr, PoL, PoR, KoL, KoR, hEff, bl_kl, bl_kr, bl_zl, bl_zr)</td></tr>
<tr class="memdesc:acb07c024cb6aa162a8789a4f50139aa5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns positions within left/right columns of combined interfaces using continuous reconstructions of T/S.  <a href="namespacemom__neutral__diffusion.html#acb07c024cb6aa162a8789a4f50139aa5">More...</a><br /></td></tr>
<tr class="separator:acb07c024cb6aa162a8789a4f50139aa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a666836e70bdae7ef4ec271246cf91993"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a666836e70bdae7ef4ec271246cf91993">mom_neutral_diffusion::interpolate_for_nondim_position</a> (dRhoNeg, Pneg, dRhoPos, Ppos)</td></tr>
<tr class="memdesc:a666836e70bdae7ef4ec271246cf91993"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the non-dimensional position between Pneg and Ppos where the interpolated density difference equals zero. The result is always bounded to be between 0 and 1.  <a href="namespacemom__neutral__diffusion.html#a666836e70bdae7ef4ec271246cf91993">More...</a><br /></td></tr>
<tr class="separator:a666836e70bdae7ef4ec271246cf91993"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72eca09bc6cc25f8a3831ad8e2be91d4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a72eca09bc6cc25f8a3831ad8e2be91d4">mom_neutral_diffusion::find_neutral_surface_positions_discontinuous</a> (CS, nk, Pres_l, hcol_l, Tl, Sl, ppoly_T_l, ppoly_S_l, stable_l, Pres_r, hcol_r, Tr, Sr, ppoly_T_r, ppoly_S_r, stable_r, PoL, PoR, KoL, KoR, hEff, zeta_bot_L, zeta_bot_R, k_bot_L, k_bot_R, hard_fail_heff)</td></tr>
<tr class="memdesc:a72eca09bc6cc25f8a3831ad8e2be91d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Higher order version of find_neutral_surface_positions. Returns positions within left/right columns of combined interfaces using intracell reconstructions of T/S. Note that the polynomial reconstrcutions of T and S are optional to aid with unit testing, but will always be passed otherwise.  <a href="namespacemom__neutral__diffusion.html#a72eca09bc6cc25f8a3831ad8e2be91d4">More...</a><br /></td></tr>
<tr class="separator:a72eca09bc6cc25f8a3831ad8e2be91d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ef7040590d6448a34013763e17edf47"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a3ef7040590d6448a34013763e17edf47">mom_neutral_diffusion::mark_unstable_cells</a> (CS, nk, T, S, P, stable_cell)</td></tr>
<tr class="memdesc:a3ef7040590d6448a34013763e17edf47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sweep down through the column and mark as stable if the bottom interface of a cell is denser than the top.  <a href="namespacemom__neutral__diffusion.html#a3ef7040590d6448a34013763e17edf47">More...</a><br /></td></tr>
<tr class="separator:a3ef7040590d6448a34013763e17edf47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2952cbcce84dbdae01fce09240f819c5"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a2952cbcce84dbdae01fce09240f819c5">mom_neutral_diffusion::search_other_column</a> (CS, ksurf, pos_last, T_from, S_from, P_from, T_top, S_top, P_top, T_bot, S_bot, P_bot, T_poly, S_poly)</td></tr>
<tr class="memdesc:a2952cbcce84dbdae01fce09240f819c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Searches the "other" (searched) column for the position of the neutral surface.  <a href="namespacemom__neutral__diffusion.html#a2952cbcce84dbdae01fce09240f819c5">More...</a><br /></td></tr>
<tr class="separator:a2952cbcce84dbdae01fce09240f819c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8a9c4a6e7e96ae356f913d4e8611f17"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#aa8a9c4a6e7e96ae356f913d4e8611f17">mom_neutral_diffusion::increment_interface</a> (nk, kl, ki, reached_bottom, searching_this_column, searching_other_column)</td></tr>
<tr class="memdesc:aa8a9c4a6e7e96ae356f913d4e8611f17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increments the interface which was just connected and also set flags if the bottom is reached.  <a href="namespacemom__neutral__diffusion.html#aa8a9c4a6e7e96ae356f913d4e8611f17">More...</a><br /></td></tr>
<tr class="separator:aa8a9c4a6e7e96ae356f913d4e8611f17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7f1b4822d5d24548770e48c620a7b6f"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#ae7f1b4822d5d24548770e48c620a7b6f">mom_neutral_diffusion::find_neutral_pos_linear</a> (CS, z0, T_ref, S_ref, P_ref, dRdT_ref, dRdS_ref, P_top, dRdT_top, dRdS_top, P_bot, dRdT_bot, dRdS_bot, ppoly_T, ppoly_S)</td></tr>
<tr class="memdesc:ae7f1b4822d5d24548770e48c620a7b6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Search a layer to find where delta_rho = 0 based on a linear interpolation of alpha and beta of the top and bottom being searched and polynomial reconstructions of T and S. Compressibility is not needed because either, we are assuming incompressibility in the equation of state for this module or alpha and beta are calculated having been displaced to the average pressures of the two pressures We need Newton's method because the T and S reconstructions make delta_rho a polynomial function of z if using PPM or higher. If Newton's method would search fall out of the interval [0,1], a bisection step would be taken instead. Also this linearization of alpha, beta means that second derivatives of the EOS are not needed. Note that delta in variable names below refers to horizontal differences and 'd' refers to vertical differences.  <a href="namespacemom__neutral__diffusion.html#ae7f1b4822d5d24548770e48c620a7b6f">More...</a><br /></td></tr>
<tr class="separator:ae7f1b4822d5d24548770e48c620a7b6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bef35a99b64bf7afad086a557ba7c1d"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a8bef35a99b64bf7afad086a557ba7c1d">mom_neutral_diffusion::find_neutral_pos_full</a> (CS, z0, T_ref, S_ref, P_ref, P_top, P_bot, ppoly_T, ppoly_S)</td></tr>
<tr class="memdesc:a8bef35a99b64bf7afad086a557ba7c1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use the full equation of state to calculate the difference in locally referenced potential density. The derivatives in this case are not trivial to calculate, so instead we use a regula falsi method.  <a href="namespacemom__neutral__diffusion.html#a8bef35a99b64bf7afad086a557ba7c1d">More...</a><br /></td></tr>
<tr class="separator:a8bef35a99b64bf7afad086a557ba7c1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a096623adeec0973cbb99cb9048946ad3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a096623adeec0973cbb99cb9048946ad3">mom_neutral_diffusion::calc_delta_rho_and_derivs</a> (CS, T1, S1, p1_in, T2, S2, p2_in, drho, drdt1_out, drds1_out, drdt2_out, drds2_out)</td></tr>
<tr class="memdesc:a096623adeec0973cbb99cb9048946ad3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the difference in density between two points in a variety of ways.  <a href="namespacemom__neutral__diffusion.html#a096623adeec0973cbb99cb9048946ad3">More...</a><br /></td></tr>
<tr class="separator:a096623adeec0973cbb99cb9048946ad3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0420673e01c23b26e87dc68317347a1"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#ae0420673e01c23b26e87dc68317347a1">mom_neutral_diffusion::delta_rho_from_derivs</a> (T1, S1, P1, dRdT1, dRdS1, T2, S2, P2, dRdT2, dRdS2)</td></tr>
<tr class="memdesc:ae0420673e01c23b26e87dc68317347a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate delta rho from derivatives and gradients of properties \( \Delta \rho$ = \frac{1}{2}\left[ (\alpha_1 + \alpha_2)*(T_1-T_2) + (\beta_1 + \beta_2)*(S_1-S_2) + (\gamma^{-1}_1 + \gamma%{-1}_2)*(P_1-P_2) \right] \).  <a href="namespacemom__neutral__diffusion.html#ae0420673e01c23b26e87dc68317347a1">More...</a><br /></td></tr>
<tr class="separator:ae0420673e01c23b26e87dc68317347a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16279fc70f169ee1011030e7afecdd4e"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a16279fc70f169ee1011030e7afecdd4e">mom_neutral_diffusion::absolute_position</a> (n, ns, Pint, Karr, NParr, k_surface)</td></tr>
<tr class="memdesc:a16279fc70f169ee1011030e7afecdd4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts non-dimensional position within a layer to absolute position (for debugging)  <a href="namespacemom__neutral__diffusion.html#a16279fc70f169ee1011030e7afecdd4e">More...</a><br /></td></tr>
<tr class="separator:a16279fc70f169ee1011030e7afecdd4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a515d1738f61e410218b0c268c37807b3"><td class="memItemLeft" align="right" valign="top">real function, dimension(ns)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a515d1738f61e410218b0c268c37807b3">mom_neutral_diffusion::absolute_positions</a> (n, ns, Pint, Karr, NParr)</td></tr>
<tr class="memdesc:a515d1738f61e410218b0c268c37807b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts non-dimensional positions within layers to absolute positions (for debugging)  <a href="namespacemom__neutral__diffusion.html#a515d1738f61e410218b0c268c37807b3">More...</a><br /></td></tr>
<tr class="separator:a515d1738f61e410218b0c268c37807b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa394289328ee392cdb17000fb6fa90e8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#aa394289328ee392cdb17000fb6fa90e8">mom_neutral_diffusion::neutral_surface_flux</a> (nk, nsurf, deg, hl, hr, Tl, Tr, PiL, PiR, KoL, KoR, hEff, Flx, continuous, h_neglect, remap_CS, h_neglect_edge)</td></tr>
<tr class="memdesc:aa394289328ee392cdb17000fb6fa90e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a single column of neutral diffusion fluxes of a tracer.  <a href="namespacemom__neutral__diffusion.html#aa394289328ee392cdb17000fb6fa90e8">More...</a><br /></td></tr>
<tr class="separator:aa394289328ee392cdb17000fb6fa90e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a005d759280cfcb84cafa23a984ffc818"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a005d759280cfcb84cafa23a984ffc818">mom_neutral_diffusion::neutral_surface_t_eval</a> (nk, ns, k_sub, Ks, Ps, T_mean, T_int, deg, iMethod, T_poly, T_top, T_bot, T_sub, T_top_int, T_bot_int, T_layer)</td></tr>
<tr class="memdesc:a005d759280cfcb84cafa23a984ffc818"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate various parts of the reconstructions to calculate gradient-based flux limter.  <a href="namespacemom__neutral__diffusion.html#a005d759280cfcb84cafa23a984ffc818">More...</a><br /></td></tr>
<tr class="separator:a005d759280cfcb84cafa23a984ffc818"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b380e21dcc9c53efcec4712228b931f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a9b380e21dcc9c53efcec4712228b931f">mom_neutral_diffusion::ppm_left_right_edge_values</a> (nk, Tl, Ti, aL, aR)</td></tr>
<tr class="memdesc:a9b380e21dcc9c53efcec4712228b931f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Discontinuous PPM reconstructions of the left/right edge values within a cell.  <a href="namespacemom__neutral__diffusion.html#a9b380e21dcc9c53efcec4712228b931f">More...</a><br /></td></tr>
<tr class="separator:a9b380e21dcc9c53efcec4712228b931f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f91c93a6363fb39395796420f25fad2"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a6f91c93a6363fb39395796420f25fad2">mom_neutral_diffusion::neutral_diffusion_unit_tests</a> (verbose)</td></tr>
<tr class="memdesc:a6f91c93a6363fb39395796420f25fad2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if unit tests of neutral_diffusion functions fail. Otherwise returns false.  <a href="namespacemom__neutral__diffusion.html#a6f91c93a6363fb39395796420f25fad2">More...</a><br /></td></tr>
<tr class="separator:a6f91c93a6363fb39395796420f25fad2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9aaf0988f76c9992d8f1db48ce23bf34"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a9aaf0988f76c9992d8f1db48ce23bf34">mom_neutral_diffusion::ndiff_unit_tests_continuous</a> (verbose)</td></tr>
<tr class="memdesc:a9aaf0988f76c9992d8f1db48ce23bf34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if unit tests of neutral_diffusion functions fail. Otherwise returns false.  <a href="namespacemom__neutral__diffusion.html#a9aaf0988f76c9992d8f1db48ce23bf34">More...</a><br /></td></tr>
<tr class="separator:a9aaf0988f76c9992d8f1db48ce23bf34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa44f980bb24df5dc71913b32892b2f71"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#aa44f980bb24df5dc71913b32892b2f71">mom_neutral_diffusion::ndiff_unit_tests_discontinuous</a> (verbose)</td></tr>
<tr class="separator:aa44f980bb24df5dc71913b32892b2f71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac51219df490c739774d70d9958bae047"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#ac51219df490c739774d70d9958bae047">mom_neutral_diffusion::test_fv_diff</a> (verbose, hkm1, hk, hkp1, Skm1, Sk, Skp1, Ptrue, title)</td></tr>
<tr class="memdesc:ac51219df490c739774d70d9958bae047"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if a test of <a class="el" href="namespacemom__neutral__diffusion.html#a1c5ac28d7c54581cdd872fe58ef0b204" title="Returns the cell-centered second-order finite volume (unlimited PLM) slope using three consecutive ce...">fv_diff()</a> fails, and conditionally writes results to stream.  <a href="namespacemom__neutral__diffusion.html#ac51219df490c739774d70d9958bae047">More...</a><br /></td></tr>
<tr class="separator:ac51219df490c739774d70d9958bae047"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad964ab49cd5901b79dc32f2367d24aed"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#ad964ab49cd5901b79dc32f2367d24aed">mom_neutral_diffusion::test_fvlsq_slope</a> (verbose, hkm1, hk, hkp1, Skm1, Sk, Skp1, Ptrue, title)</td></tr>
<tr class="memdesc:ad964ab49cd5901b79dc32f2367d24aed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if a test of <a class="el" href="namespacemom__neutral__diffusion.html#a6ed3814088af470ad6fc4a3a80926fd7" title="Returns the cell-centered second-order weighted least squares slope using three consecutive cell widt...">fvlsq_slope()</a> fails, and conditionally writes results to stream.  <a href="namespacemom__neutral__diffusion.html#ad964ab49cd5901b79dc32f2367d24aed">More...</a><br /></td></tr>
<tr class="separator:ad964ab49cd5901b79dc32f2367d24aed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a21234946c77d1e4ed852a4173503f1"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a1a21234946c77d1e4ed852a4173503f1">mom_neutral_diffusion::test_ifndp</a> (verbose, rhoNeg, Pneg, rhoPos, Ppos, Ptrue, title)</td></tr>
<tr class="memdesc:a1a21234946c77d1e4ed852a4173503f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if a test of <a class="el" href="namespacemom__neutral__diffusion.html#a666836e70bdae7ef4ec271246cf91993" title="Returns the non-dimensional position between Pneg and Ppos where the interpolated density difference ...">interpolate_for_nondim_position()</a> fails, and conditionally writes results to stream.  <a href="namespacemom__neutral__diffusion.html#a1a21234946c77d1e4ed852a4173503f1">More...</a><br /></td></tr>
<tr class="separator:a1a21234946c77d1e4ed852a4173503f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2870eae4b580e548577943e34321b8f0"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a2870eae4b580e548577943e34321b8f0">mom_neutral_diffusion::test_data1d</a> (verbose, nk, Po, Ptrue, title)</td></tr>
<tr class="memdesc:a2870eae4b580e548577943e34321b8f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if comparison of Po and Ptrue fails, and conditionally writes results to stream.  <a href="namespacemom__neutral__diffusion.html#a2870eae4b580e548577943e34321b8f0">More...</a><br /></td></tr>
<tr class="separator:a2870eae4b580e548577943e34321b8f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa2d682e80cdba470a09bcff6bda1767"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#aaa2d682e80cdba470a09bcff6bda1767">mom_neutral_diffusion::test_data1di</a> (verbose, nk, Po, Ptrue, title)</td></tr>
<tr class="memdesc:aaa2d682e80cdba470a09bcff6bda1767"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if comparison of Po and Ptrue fails, and conditionally writes results to stream.  <a href="namespacemom__neutral__diffusion.html#aaa2d682e80cdba470a09bcff6bda1767">More...</a><br /></td></tr>
<tr class="separator:aaa2d682e80cdba470a09bcff6bda1767"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5eaa2002c1f6405f5037645bbca3101"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#ab5eaa2002c1f6405f5037645bbca3101">mom_neutral_diffusion::test_nsp</a> (verbose, ns, KoL, KoR, pL, pR, hEff, KoL0, KoR0, pL0, pR0, hEff0, title)</td></tr>
<tr class="memdesc:ab5eaa2002c1f6405f5037645bbca3101"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if output of find_neutral_surface_positions() does not match correct values, and conditionally writes results to stream.  <a href="namespacemom__neutral__diffusion.html#ab5eaa2002c1f6405f5037645bbca3101">More...</a><br /></td></tr>
<tr class="separator:ab5eaa2002c1f6405f5037645bbca3101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5725b17791c79900343532931ac04503"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#a5725b17791c79900343532931ac04503">mom_neutral_diffusion::compare_nsp_row</a> (KoL, KoR, pL, pR, KoL0, KoR0, pL0, pR0)</td></tr>
<tr class="memdesc:a5725b17791c79900343532931ac04503"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares a single row, k, of output from find_neutral_surface_positions()  <a href="namespacemom__neutral__diffusion.html#a5725b17791c79900343532931ac04503">More...</a><br /></td></tr>
<tr class="separator:a5725b17791c79900343532931ac04503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab75333897fa8800441d8eddc1720f631"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#ab75333897fa8800441d8eddc1720f631">mom_neutral_diffusion::test_rnp</a> (expected_pos, test_pos, title)</td></tr>
<tr class="memdesc:ab75333897fa8800441d8eddc1720f631"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares output position from refine_nondim_position with an expected value.  <a href="namespacemom__neutral__diffusion.html#ab75333897fa8800441d8eddc1720f631">More...</a><br /></td></tr>
<tr class="separator:ab75333897fa8800441d8eddc1720f631"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8a313d25818dfa8c3bc056210fac76b"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#ae8a313d25818dfa8c3bc056210fac76b">mom_neutral_diffusion::neutral_diffusion_end</a> (CS)</td></tr>
<tr class="memdesc:ae8a313d25818dfa8c3bc056210fac76b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocates neutral_diffusion control structure.  <a href="namespacemom__neutral__diffusion.html#ae8a313d25818dfa8c3bc056210fac76b">More...</a><br /></td></tr>
<tr class="separator:ae8a313d25818dfa8c3bc056210fac76b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:afdf44450544eb51e29afe3454ecbc0cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=40)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__neutral__diffusion.html#afdf44450544eb51e29afe3454ecbc0cc">mom_neutral_diffusion::mdl</a> = &quot;MOM_neutral_diffusion&quot;</td></tr>
<tr class="memdesc:afdf44450544eb51e29afe3454ecbc0cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">module name  <a href="namespacemom__neutral__diffusion.html#afdf44450544eb51e29afe3454ecbc0cc">More...</a><br /></td></tr>
<tr class="separator:afdf44450544eb51e29afe3454ecbc0cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_419569bb6464a79f27b27102966d14b7.html">tracer</a></li><li class="navelem"><a class="el" href="MOM__neutral__diffusion_8F90.html">MOM_neutral_diffusion.F90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
