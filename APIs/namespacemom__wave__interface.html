<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MOM6: mom_wave_interface Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MOM6
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacemom__wave__interface.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">mom_wave_interface Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Interface for surface waves. </p>
<dl class="section author"><dt>Author</dt><dd>Brandon Reichl, 2018.</dd></dl>
<p>This module should be moved as wave coupling progresses and likely will should mirror the iceberg or sea-ice model set-up.</p>
<p>This module is meant to contain the routines to read in and interpret surface wave data for MOM6. In its original form, the capabilities include setting the Stokes drift in the model (from a variety of sources including prescribed, empirical, and input files). In short order, the plan is to also ammend the subroutine to accept Stokes drift information from an external coupler. Eventually, it will be necessary to break this file apart so that general wave information may be stored in the control structure and the Stokes drift effect can be isolated from processes such as sea-state dependent momentum fluxes, gas fluxes, and other wave related air-sea interaction and boundary layer phenomenon.</p>
<p>The Stokes drift are stored on the C-grid with the conventional protocol to interpolate to the h-grid to compute Langmuir number, the primary quantity needed for Langmuir turbulence parameterizations in both the ePBL and KPP approach. This module also computes full 3d Stokes drift profiles, which will be useful if second-order type boundary layer parameterizations are implemented (perhaps via GOTM, work in progress). </p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmom__wave__interface_1_1wave__parameters__cs.html">wave_parameters_cs</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for all surface wave related parameters.  <a href="structmom__wave__interface_1_1wave__parameters__cs.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aa07c73f561840851981d6a013423dd6e"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#aa07c73f561840851981d6a013423dd6e">get_langmuir_number</a> (LA, G, GV, US, HBL, ustar, i, j, H, U_H, V_H, Override_MA, Waves)</td></tr>
<tr class="memdesc:aa07c73f561840851981d6a013423dd6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface to get Langmuir number based on options stored in wave structure.  <a href="namespacemom__wave__interface.html#aa07c73f561840851981d6a013423dd6e">More...</a><br /></td></tr>
<tr class="separator:aa07c73f561840851981d6a013423dd6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad81e4ea1a9510437272f5871af6993ad"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#ad81e4ea1a9510437272f5871af6993ad">wavemethod</a> =-99</td></tr>
<tr class="memdesc:ad81e4ea1a9510437272f5871af6993ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#ad81e4ea1a9510437272f5871af6993ad">More...</a><br /></td></tr>
<tr class="separator:ad81e4ea1a9510437272f5871af6993ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab514cf456c7f7953f4c304b941ff4c53"><td class="memItemLeft" align="right" valign="top">integer, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#ab514cf456c7f7953f4c304b941ff4c53">numbands</a> =0</td></tr>
<tr class="memdesc:ab514cf456c7f7953f4c304b941ff4c53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of wavenumber/frequency partitions to receive This needs to match the number of bands provided via either coupling or file.  <a href="namespacemom__wave__interface.html#ab514cf456c7f7953f4c304b941ff4c53">More...</a><br /></td></tr>
<tr class="separator:ab514cf456c7f7953f4c304b941ff4c53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91f7f974e91056f48cb04fb01b8f0d15"><td class="memItemLeft" align="right" valign="top">integer, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a91f7f974e91056f48cb04fb01b8f0d15">partitionmode</a></td></tr>
<tr class="memdesc:a91f7f974e91056f48cb04fb01b8f0d15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method for partition mode (meant to check input) 0 - wavenumbers 1 - frequencies.  <a href="namespacemom__wave__interface.html#a91f7f974e91056f48cb04fb01b8f0d15">More...</a><br /></td></tr>
<tr class="separator:a91f7f974e91056f48cb04fb01b8f0d15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af159120455d0f0afae144afc6a587561"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#af159120455d0f0afae144afc6a587561">datasource</a></td></tr>
<tr class="memdesc:af159120455d0f0afae144afc6a587561"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integer that specifies where the Model Looks for Data Valid choices are: 1 - FMS DataOverride Routine 2 - Reserved For Coupler 3 - User input (fixed values, useful for 1d testing)  <a href="namespacemom__wave__interface.html#af159120455d0f0afae144afc6a587561">More...</a><br /></td></tr>
<tr class="separator:af159120455d0f0afae144afc6a587561"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14b0aa4752008d5a52dbbb5e16751122"><td class="memItemLeft" align="right" valign="top"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=40)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a14b0aa4752008d5a52dbbb5e16751122">surfbandfilename</a></td></tr>
<tr class="memdesc:a14b0aa4752008d5a52dbbb5e16751122"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filename if using DataOverride.  <a href="namespacemom__wave__interface.html#a14b0aa4752008d5a52dbbb5e16751122">More...</a><br /></td></tr>
<tr class="separator:a14b0aa4752008d5a52dbbb5e16751122"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86e86d267dc214498fcd8088349d5d57"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a86e86d267dc214498fcd8088349d5d57">dataoverrideisinitialized</a></td></tr>
<tr class="memdesc:a86e86d267dc214498fcd8088349d5d57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag for DataOverride Initialization.  <a href="namespacemom__wave__interface.html#a86e86d267dc214498fcd8088349d5d57">More...</a><br /></td></tr>
<tr class="separator:a86e86d267dc214498fcd8088349d5d57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc7136c467d4f1def8b2a32dfd335c3f"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#abc7136c467d4f1def8b2a32dfd335c3f">la_frachbl</a></td></tr>
<tr class="memdesc:abc7136c467d4f1def8b2a32dfd335c3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fraction of OSBL for averaging Langmuir number.  <a href="namespacemom__wave__interface.html#abc7136c467d4f1def8b2a32dfd335c3f">More...</a><br /></td></tr>
<tr class="separator:abc7136c467d4f1def8b2a32dfd335c3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab4d6b9f7e8823615c5ff975e0e40d22"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#aab4d6b9f7e8823615c5ff975e0e40d22">la_misalignment</a> = .false.</td></tr>
<tr class="memdesc:aab4d6b9f7e8823615c5ff975e0e40d22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to use misalignment in Langmuir number.  <a href="namespacemom__wave__interface.html#aab4d6b9f7e8823615c5ff975e0e40d22">More...</a><br /></td></tr>
<tr class="separator:aab4d6b9f7e8823615c5ff975e0e40d22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55a67e21539483f4da8d0c8a33f36dc1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=40)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a55a67e21539483f4da8d0c8a33f36dc1">mdl</a> = &quot;MOM_wave_interface&quot;</td></tr>
<tr class="memdesc:a55a67e21539483f4da8d0c8a33f36dc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This module's name.  <a href="namespacemom__wave__interface.html#a55a67e21539483f4da8d0c8a33f36dc1">More...</a><br /></td></tr>
<tr class="separator:a55a67e21539483f4da8d0c8a33f36dc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9add067c6322c0d863978f0a1c13b205"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a9add067c6322c0d863978f0a1c13b205">testprof</a> = 0</td></tr>
<tr class="memdesc:a9add067c6322c0d863978f0a1c13b205"><td class="mdescLeft">&#160;</td><td class="mdescRight">Undocumented parameters.  <a href="namespacemom__wave__interface.html#a9add067c6322c0d863978f0a1c13b205">More...</a><br /></td></tr>
<tr class="separator:a9add067c6322c0d863978f0a1c13b205"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3e3dcb7036fc3500e60304d1e632dab"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#aa3e3dcb7036fc3500e60304d1e632dab">surfbands</a> = 1</td></tr>
<tr class="memdesc:aa3e3dcb7036fc3500e60304d1e632dab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#aa3e3dcb7036fc3500e60304d1e632dab">More...</a><br /></td></tr>
<tr class="separator:aa3e3dcb7036fc3500e60304d1e632dab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba8ac0d96a4986c68452e60e0843d635"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#aba8ac0d96a4986c68452e60e0843d635">dhh85</a> = 2</td></tr>
<tr class="memdesc:aba8ac0d96a4986c68452e60e0843d635"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#aba8ac0d96a4986c68452e60e0843d635">More...</a><br /></td></tr>
<tr class="separator:aba8ac0d96a4986c68452e60e0843d635"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf3e043506139977c8fbdf2ae0180262"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#aaf3e043506139977c8fbdf2ae0180262">lf17</a> = 3</td></tr>
<tr class="memdesc:aaf3e043506139977c8fbdf2ae0180262"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#aaf3e043506139977c8fbdf2ae0180262">More...</a><br /></td></tr>
<tr class="separator:aaf3e043506139977c8fbdf2ae0180262"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcedd2ab70e1d3b83e2802b31a9ae78c"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#afcedd2ab70e1d3b83e2802b31a9ae78c">null_wavemethod</a> =-99</td></tr>
<tr class="memdesc:afcedd2ab70e1d3b83e2802b31a9ae78c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#afcedd2ab70e1d3b83e2802b31a9ae78c">More...</a><br /></td></tr>
<tr class="separator:afcedd2ab70e1d3b83e2802b31a9ae78c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bb611ec4e2c3c121ed662e75f79bc3d"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a0bb611ec4e2c3c121ed662e75f79bc3d">dataovr</a> = 1</td></tr>
<tr class="memdesc:a0bb611ec4e2c3c121ed662e75f79bc3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#a0bb611ec4e2c3c121ed662e75f79bc3d">More...</a><br /></td></tr>
<tr class="separator:a0bb611ec4e2c3c121ed662e75f79bc3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38f7b8c357cf57847a9f9d6db72714b6"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a38f7b8c357cf57847a9f9d6db72714b6">coupler</a> = 2</td></tr>
<tr class="memdesc:a38f7b8c357cf57847a9f9d6db72714b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#a38f7b8c357cf57847a9f9d6db72714b6">More...</a><br /></td></tr>
<tr class="separator:a38f7b8c357cf57847a9f9d6db72714b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d13c62795b8407c1e9d3a3236b61100"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a2d13c62795b8407c1e9d3a3236b61100">input</a> = 3</td></tr>
<tr class="memdesc:a2d13c62795b8407c1e9d3a3236b61100"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#a2d13c62795b8407c1e9d3a3236b61100">More...</a><br /></td></tr>
<tr class="separator:a2d13c62795b8407c1e9d3a3236b61100"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad270c0cfd5b154a7c79856dcd65f9b7d"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#ad270c0cfd5b154a7c79856dcd65f9b7d">tp_stkx0</a></td></tr>
<tr class="memdesc:ad270c0cfd5b154a7c79856dcd65f9b7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#ad270c0cfd5b154a7c79856dcd65f9b7d">More...</a><br /></td></tr>
<tr class="separator:ad270c0cfd5b154a7c79856dcd65f9b7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b1910008053811657e7b0a62bf7b953"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a1b1910008053811657e7b0a62bf7b953">tp_stky0</a></td></tr>
<tr class="memdesc:a1b1910008053811657e7b0a62bf7b953"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#a1b1910008053811657e7b0a62bf7b953">More...</a><br /></td></tr>
<tr class="separator:a1b1910008053811657e7b0a62bf7b953"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac99ef0805fd66b9e7b96ee6c21c819e5"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#ac99ef0805fd66b9e7b96ee6c21c819e5">tp_wvl</a></td></tr>
<tr class="memdesc:ac99ef0805fd66b9e7b96ee6c21c819e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#ac99ef0805fd66b9e7b96ee6c21c819e5">More...</a><br /></td></tr>
<tr class="separator:ac99ef0805fd66b9e7b96ee6c21c819e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d5d36a94c630a4f9e181d8171fc2a35"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a4d5d36a94c630a4f9e181d8171fc2a35">waveagepeakfreq</a></td></tr>
<tr class="memdesc:a4d5d36a94c630a4f9e181d8171fc2a35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#a4d5d36a94c630a4f9e181d8171fc2a35">More...</a><br /></td></tr>
<tr class="separator:a4d5d36a94c630a4f9e181d8171fc2a35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64f1c48b7cda4fbcf16d32efa64e7a65"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a64f1c48b7cda4fbcf16d32efa64e7a65">staticwaves</a></td></tr>
<tr class="memdesc:a64f1c48b7cda4fbcf16d32efa64e7a65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#a64f1c48b7cda4fbcf16d32efa64e7a65">More...</a><br /></td></tr>
<tr class="separator:a64f1c48b7cda4fbcf16d32efa64e7a65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f2253e4bf2bd73d0571270a3a464bb0"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a3f2253e4bf2bd73d0571270a3a464bb0">dhh85_is_set</a></td></tr>
<tr class="memdesc:a3f2253e4bf2bd73d0571270a3a464bb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#a3f2253e4bf2bd73d0571270a3a464bb0">More...</a><br /></td></tr>
<tr class="separator:a3f2253e4bf2bd73d0571270a3a464bb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6655758dbc674bafd3a5f0a51176e80"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#ae6655758dbc674bafd3a5f0a51176e80">waveage</a></td></tr>
<tr class="memdesc:ae6655758dbc674bafd3a5f0a51176e80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#ae6655758dbc674bafd3a5f0a51176e80">More...</a><br /></td></tr>
<tr class="separator:ae6655758dbc674bafd3a5f0a51176e80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e5650b8187abcc67bd0e2787322ac75"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a8e5650b8187abcc67bd0e2787322ac75">wavewind</a></td></tr>
<tr class="memdesc:a8e5650b8187abcc67bd0e2787322ac75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#a8e5650b8187abcc67bd0e2787322ac75">More...</a><br /></td></tr>
<tr class="separator:a8e5650b8187abcc67bd0e2787322ac75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bac1e68a6349358fbcb6d4586b96492"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a8bac1e68a6349358fbcb6d4586b96492">pi</a></td></tr>
<tr class="memdesc:a8bac1e68a6349358fbcb6d4586b96492"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used.  <a href="namespacemom__wave__interface.html#a8bac1e68a6349358fbcb6d4586b96492">More...</a><br /></td></tr>
<tr class="separator:a8bac1e68a6349358fbcb6d4586b96492"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3003dfe4e2167905ae8760bb1115b3cb"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a3003dfe4e2167905ae8760bb1115b3cb">mom_wave_interface_init</a> (time, G, GV, US, param_file, CS, diag)</td></tr>
<tr class="memdesc:a3003dfe4e2167905ae8760bb1115b3cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes parameters related to MOM_wave_interface.  <a href="namespacemom__wave__interface.html#a3003dfe4e2167905ae8760bb1115b3cb">More...</a><br /></td></tr>
<tr class="separator:a3003dfe4e2167905ae8760bb1115b3cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2bad416c49ca81a4e5822b70d2e14b9"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#ad2bad416c49ca81a4e5822b70d2e14b9">mom_wave_interface_init_lite</a> (param_file)</td></tr>
<tr class="memdesc:ad2bad416c49ca81a4e5822b70d2e14b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">A 'lite' init subroutine to initialize a few inputs needed if using wave information with the wind-speed dependent Stokes drift formulation of LF17.  <a href="namespacemom__wave__interface.html#ad2bad416c49ca81a4e5822b70d2e14b9">More...</a><br /></td></tr>
<tr class="separator:ad2bad416c49ca81a4e5822b70d2e14b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7c744e81248040ad319e0b608c52284"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#ad7c744e81248040ad319e0b608c52284">update_surface_waves</a> (G, GV, US, Day, dt, CS)</td></tr>
<tr class="memdesc:ad7c744e81248040ad319e0b608c52284"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine that handles updating of surface wave/Stokes drift related properties.  <a href="namespacemom__wave__interface.html#ad7c744e81248040ad319e0b608c52284">More...</a><br /></td></tr>
<tr class="separator:ad7c744e81248040ad319e0b608c52284"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42b769030d04a1c087e168de36ce7285"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a42b769030d04a1c087e168de36ce7285">update_stokes_drift</a> (G, GV, US, CS, h, ustar)</td></tr>
<tr class="memdesc:a42b769030d04a1c087e168de36ce7285"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs the Stokes Drift profile on the model grid based on desired coupling options.  <a href="namespacemom__wave__interface.html#a42b769030d04a1c087e168de36ce7285">More...</a><br /></td></tr>
<tr class="separator:a42b769030d04a1c087e168de36ce7285"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01dd0c089dab89934450a7a699255658"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a01dd0c089dab89934450a7a699255658">surface_bands_by_data_override</a> (day_center, G, GV, US, CS)</td></tr>
<tr class="memdesc:a01dd0c089dab89934450a7a699255658"><td class="mdescLeft">&#160;</td><td class="mdescRight">A subroutine to fill the Stokes drift from a NetCDF file using the data_override procedures.  <a href="namespacemom__wave__interface.html#a01dd0c089dab89934450a7a699255658">More...</a><br /></td></tr>
<tr class="separator:a01dd0c089dab89934450a7a699255658"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42ca9104192ff12c44c28b705d137eb9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a42ca9104192ff12c44c28b705d137eb9">get_stokessl_lifoxkemper</a> (ustar, hbl, GV, US, UStokes_SL, LA)</td></tr>
<tr class="memdesc:a42ca9104192ff12c44c28b705d137eb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get SL averaged Stokes drift from Li/FK 17 method.  <a href="namespacemom__wave__interface.html#a42ca9104192ff12c44c28b705d137eb9">More...</a><br /></td></tr>
<tr class="separator:a42ca9104192ff12c44c28b705d137eb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae631a776ca48a5b8be572bed00e6f5c1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#ae631a776ca48a5b8be572bed00e6f5c1">get_sl_average_prof</a> (GV, AvgDepth, H, Profile, Average)</td></tr>
<tr class="memdesc:ae631a776ca48a5b8be572bed00e6f5c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get SL Averaged Stokes drift from a Stokes drift Profile.  <a href="namespacemom__wave__interface.html#ae631a776ca48a5b8be572bed00e6f5c1">More...</a><br /></td></tr>
<tr class="separator:ae631a776ca48a5b8be572bed00e6f5c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ebd32de10bed6d66c0a95a4a15cc81a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a5ebd32de10bed6d66c0a95a4a15cc81a">get_sl_average_band</a> (GV, AvgDepth, NB, WaveNumbers, SurfStokes, Average)</td></tr>
<tr class="memdesc:a5ebd32de10bed6d66c0a95a4a15cc81a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get SL averaged Stokes drift from the banded Spectrum method.  <a href="namespacemom__wave__interface.html#a5ebd32de10bed6d66c0a95a4a15cc81a">More...</a><br /></td></tr>
<tr class="separator:a5ebd32de10bed6d66c0a95a4a15cc81a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4594bd7d4bc3eed353357d436a551c4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#af4594bd7d4bc3eed353357d436a551c4">dhh85_mid</a> (GV, US, zpt, UStokes)</td></tr>
<tr class="memdesc:af4594bd7d4bc3eed353357d436a551c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the Stokes drift at a given depth.  <a href="namespacemom__wave__interface.html#af4594bd7d4bc3eed353357d436a551c4">More...</a><br /></td></tr>
<tr class="separator:af4594bd7d4bc3eed353357d436a551c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86d1b417862d641edb7996ff136c4b93"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a86d1b417862d641edb7996ff136c4b93">stokesmixing</a> (G, GV, dt, h, u, v, Waves)</td></tr>
<tr class="memdesc:a86d1b417862d641edb7996ff136c4b93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Explicit solver for Stokes mixing. Still in development do not use.  <a href="namespacemom__wave__interface.html#a86d1b417862d641edb7996ff136c4b93">More...</a><br /></td></tr>
<tr class="separator:a86d1b417862d641edb7996ff136c4b93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c3ce75d6b2e9f338ca4c7e5ec63f71b"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a0c3ce75d6b2e9f338ca4c7e5ec63f71b">coriolisstokes</a> (G, GV, DT, h, u, v, WAVES, US)</td></tr>
<tr class="memdesc:a0c3ce75d6b2e9f338ca4c7e5ec63f71b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solver to add Coriolis-Stokes to model Still in development and not meant for general use. Can be activated (with code intervention) for LES comparison CHECK THAT RIGHT TIMESTEP IS PASSED IF YOU USE THIS**.  <a href="namespacemom__wave__interface.html#a0c3ce75d6b2e9f338ca4c7e5ec63f71b">More...</a><br /></td></tr>
<tr class="separator:a0c3ce75d6b2e9f338ca4c7e5ec63f71b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae771d75c78a0370ad163edd5b1c19965"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#ae771d75c78a0370ad163edd5b1c19965">ust_2_u10_coare3p5</a> (USTair, U10, GV, US)</td></tr>
<tr class="memdesc:ae771d75c78a0370ad163edd5b1c19965"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes wind speed from ustar_air based on COARE 3.5 Cd relationship Probably doesn't belong in this module, but it is used here to estimate wind speed for wind-wave relationships. Should be a fine way to estimate the neutral wind-speed as written here.  <a href="namespacemom__wave__interface.html#ae771d75c78a0370ad163edd5b1c19965">More...</a><br /></td></tr>
<tr class="separator:ae771d75c78a0370ad163edd5b1c19965"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a503d3ffc8d297c000dc72e2bfb7eb1b1"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__wave__interface.html#a503d3ffc8d297c000dc72e2bfb7eb1b1">waves_end</a> (CS)</td></tr>
<tr class="memdesc:a503d3ffc8d297c000dc72e2bfb7eb1b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear pointers, deallocate memory.  <a href="namespacemom__wave__interface.html#a503d3ffc8d297c000dc72e2bfb7eb1b1">More...</a><br /></td></tr>
<tr class="separator:a503d3ffc8d297c000dc72e2bfb7eb1b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a0c3ce75d6b2e9f338ca4c7e5ec63f71b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c3ce75d6b2e9f338ca4c7e5ec63f71b">&#9670;&nbsp;</a></span>coriolisstokes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_wave_interface::coriolisstokes </td>
          <td>(</td>
          <td class="paramtype">type(ocean_grid_type), intent(in)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(szi_(g),szj_(g),szk_(g)), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(szib_(g),szj_(g),szk_(g)), intent(inout)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(szi_(g),szjb_(g),szk_(g)), intent(inout)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__wave__interface_1_1wave__parameters__cs.html">wave_parameters_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>WAVES</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solver to add Coriolis-Stokes to model Still in development and not meant for general use. Can be activated (with code intervention) for LES comparison CHECK THAT RIGHT TIMESTEP IS PASSED IF YOU USE THIS**. </p>
<p>Not accessed in the standard code. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>Ocean grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>Ocean vertical grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>Time step of MOM6 [s] CHECK IF PASSING RIGHT TIMESTEP </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Layer thicknesses [H ~&gt; m or kg m-2] </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">u</td><td>Velocity i-component [m s-1] </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">v</td><td>Velocity j-component [m s-1] </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">waves</td><td>Surface wave related control structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l01277">1277</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type), &amp;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;       <span class="keywordtype">intent(in)</span>    :: G<span class="comment">     !&lt; Ocean grid</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type), &amp;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;       <span class="keywordtype">intent(in)</span>   :: GV<span class="comment">     !&lt; Ocean vertical grid</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span>  :: Dt<span class="comment">     !&lt; Time step of MOM6 [s] CHECK IF PASSING RIGHT TIMESTEP</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G),SZK_(G))</span>,  &amp;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;       <span class="keywordtype">intent(in)</span>    :: h<span class="comment">     !&lt; Layer thicknesses [H ~&gt; m or kg m-2]</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZIB_(G),SZJ_(G),SZK_(G))</span>, &amp;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;       <span class="keywordtype">intent(inout)</span> :: u<span class="comment">     !&lt; Velocity i-component [m s-1]</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJB_(G),SZK_(G))</span>, &amp;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;       <span class="keywordtype">intent(inout)</span> :: v<span class="comment">     !&lt; Velocity j-component [m s-1]</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <span class="keywordtype">type</span>(Wave_parameters_CS), &amp;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;       <span class="keywordtype">pointer</span>       :: Waves<span class="comment"> !&lt; Surface wave related control structure.</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type),   <span class="keywordtype">intent(in)</span> :: US<span class="comment">     !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="keywordtype">  real</span> :: DVel <span class="comment">! A rescaled velocity change [m s-1 T-1 ~&gt; m s-2]</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="keywordtype">integer</span> :: i,j,k</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160; </div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <span class="keywordflow">do</span> k = 1, g%ke</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="keywordflow">do</span> j = g%jsc, g%jec</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      <span class="keywordflow">do</span> i = g%iscB, g%iecB</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        dvel = 0.25*(waves%us_y(i,j+1,k)+waves%us_y(i-1,j+1,k))*g%CoriolisBu(i,j+1) + &amp;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;               0.25*(waves%us_y(i,j,k)+waves%us_y(i-1,j,k))*g%CoriolisBu(i,j)</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        u(i,j,k) = u(i,j,k) + dvel*us%s_to_T*dt</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="keywordflow">  enddo</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <span class="keywordflow">do</span> k = 1, g%ke</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordflow">do</span> j = g%jscB, g%jecB</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <span class="keywordflow">do</span> i = g%isc, g%iec</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        dvel = 0.25*(waves%us_x(i+1,j,k)+waves%us_x(i+1,j-1,k))*g%CoriolisBu(i+1,j) + &amp;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;               0.25*(waves%us_x(i,j,k)+waves%us_x(i,j-1,k))*g%CoriolisBu(i,j)</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        v(i,j,k) = v(i,j,k) - dvel*us%s_to_T*dt</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="keywordflow">  enddo</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="af4594bd7d4bc3eed353357d436a551c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4594bd7d4bc3eed353357d436a551c4">&#9670;&nbsp;</a></span>dhh85_mid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_wave_interface::dhh85_mid </td>
          <td>(</td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>zpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>UStokes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the Stokes drift at a given depth. </p>
<p>Taken from Qing Li (Brown) use for comparing MOM6 simulation to his LES computed at z mid point (I think) and not depth averaged. Should be fine to integrate in frequency from 0.1 to sqrt(-0.2*grav*2pi/dz </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>Ocean vertical grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zpt</td><td>Depth to get Stokes drift [Z ~&gt; m]. !### THIS IS NOT USED YET. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ustokes</td><td>Stokes drift [m s-1] </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l01154">1154</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type), <span class="keywordtype">intent(in)</span>  :: GV<span class="comment">  !&lt; Ocean vertical grid</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type),   <span class="keywordtype">intent(in)</span>  :: US<span class="comment">  !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span>  :: ZPT<span class="comment">   !&lt; Depth to get Stokes drift [Z ~&gt; m]. !### THIS IS NOT USED YET.</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(out)</span> :: UStokes<span class="comment"> !&lt; Stokes drift [m s-1]</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="comment">!</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="keywordtype">  real</span> :: ann, Bnn, Snn, Cnn, Dnn</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="keywordtype">  real</span> :: omega_peak, omega, u10, WA, domega</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="keywordtype">  real</span> :: omega_min, omega_max, wavespec, Stokes</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keywordtype">integer</span> :: Nomega, OI</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160; </div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  wa = waveage</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  u10 = wavewind</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="comment">!/</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  omega_min = 0.1 <span class="comment">! Hz</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="comment">! Cut off at 30cm for now...</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  omega_max = 10. <span class="comment">! ~sqrt(0.2*GV%mks_g_Earth*2*pi/0.3)</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  nomega = 1000</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  domega = (omega_max-omega_min)/real(nomega)</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="comment">!</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="keywordflow">if</span> (waveagepeakfreq) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    omega_peak = gv%mks_g_Earth / (wa * u10)</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    omega_peak = 2. * pi * 0.13 * gv%mks_g_Earth / u10</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="comment">!/</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  ann = 0.006 * waveage**(-0.55)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  bnn = 1.0</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  snn = 0.08 * (1.0 + 4.0 * waveage**3)</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  cnn = 1.7</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <span class="keywordflow">if</span> (wa &lt; 1.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    cnn = cnn - 6.0*log10(wa)</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="comment">!/</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  ustokes = 0.0</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  omega = omega_min + 0.5*domega</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <span class="keywordflow">do</span> oi = 1,nomega-1</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    dnn = exp( -0.5 * (omega-omega_peak)**2 / (snn**2 * omega_peak**2) )</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="comment">! wavespec units = m2s</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    wavespec = (ann * gv%mks_g_Earth**2 / (omega_peak*omega**4 ) ) * &amp;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;               exp(-bnn*(omega_peak/omega)**4)*cnn**dnn</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="comment">! Stokes units m  (multiply by frequency range for units of m/s)</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    stokes = 2.0 * wavespec * omega**3 * &amp;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;         exp( 2.0 * omega**2 * zpt / gv%mks_g_Earth) / gv%mks_g_Earth</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    ustokes = ustokes + stokes*domega</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    omega = omega + domega</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="keywordflow">  enddo</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MOM__wave__interface_8F90_source.html#l00186">pi</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00185">waveage</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00183">waveagepeakfreq</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00185">wavewind</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00479">update_stokes_drift()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_af4594bd7d4bc3eed353357d436a551c4_icgraph.svg" width="655" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aa07c73f561840851981d6a013423dd6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa07c73f561840851981d6a013423dd6e">&#9670;&nbsp;</a></span>get_langmuir_number()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_wave_interface::get_langmuir_number </td>
          <td>(</td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>LA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(ocean_grid_type), intent(in)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>HBL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ustar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( gv %ke), intent(in), optional&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( gv %ke), intent(in), optional&#160;</td>
          <td class="paramname"><em>U_H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( gv %ke), intent(in), optional&#160;</td>
          <td class="paramname"><em>V_H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>Override_MA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__wave__interface_1_1wave__parameters__cs.html">wave_parameters_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>Waves</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interface to get Langmuir number based on options stored in wave structure. </p>
<p>Note this can be called with an unallocated Waves pointer, which is okay if we want the wind-speed only dependent Langmuir number. Therefore, we need to be careful about what we try to access here. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>Ocean grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>Ocean vertical grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>Meridional index of h-point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Zonal index of h-point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ustar</td><td>Friction velocity [Z T-1 ~&gt; m s-1]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hbl</td><td>(Positive) thickness of boundary layer [Z ~&gt; m]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">override_ma</td><td>Override to use misalignment in LA calculation. This can be used if diagnostic LA outputs are desired that are different than those used by the dynamical model. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Grid layer thickness [H ~&gt; m or kg m-2] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u_h</td><td>Zonal velocity at H point [m s-1] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v_h</td><td>Meridional velocity at H point [m s-1] </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">waves</td><td>Surface wave control structure. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">la</td><td>Langmuir number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00879">879</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type),   <span class="keywordtype">intent(in)</span> :: G<span class="comment">  !&lt; Ocean grid structure</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type), <span class="keywordtype">intent(in)</span> :: GV<span class="comment"> !&lt; Ocean vertical grid structure</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type),   <span class="keywordtype">intent(in)</span> :: US<span class="comment"> !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: i<span class="comment">      !&lt; Meridional index of h-point</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: j<span class="comment">      !&lt; Zonal index of h-point</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span>    :: ustar<span class="comment">  !&lt; Friction velocity [Z T-1 ~&gt; m s-1].</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span>    :: HBL<span class="comment">    !&lt; (Positive) thickness of boundary layer [Z ~&gt; m].</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="keywordtype">logical</span>, <span class="keywordtype">optional</span>,       <span class="keywordtype">intent(in)</span> :: Override_MA<span class="comment"> !&lt; Override to use misalignment in LA</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">                                !! calculation. This can be used if diagnostic</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">                                !! LA outputs are desired that are different than</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">                                !! those used by the dynamical model.</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZK_(GV))</span>, <span class="keywordtype">optional</span>, &amp;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;       <span class="keywordtype">intent(in)</span>      :: H<span class="comment">     !&lt; Grid layer thickness [H ~&gt; m or kg m-2]</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZK_(GV))</span>, <span class="keywordtype">optional</span>, &amp;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;       <span class="keywordtype">intent(in)</span>      :: U_H<span class="comment">   !&lt; Zonal velocity at H point [m s-1]</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZK_(GV))</span>, <span class="keywordtype">optional</span>, &amp;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;       <span class="keywordtype">intent(in)</span>      :: V_H<span class="comment">   !&lt; Meridional velocity at H point [m s-1]</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="keywordtype">type</span>(Wave_parameters_CS), &amp;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;       <span class="keywordtype">pointer</span>         :: Waves<span class="comment"> !&lt; Surface wave control structure.</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(out)</span>    :: LA<span class="comment">    !&lt; Langmuir number</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">!Local Variables</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="keywordtype">  real</span> :: Top, bottom, midpoint</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="keywordtype">  real</span> :: Dpt_LASL, ShearDirection, WaveDirection</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="keywordtype">  real</span> :: LA_STKx, LA_STKy, LA_STK <span class="comment">! Stokes velocities in [m s-1]</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keywordtype">logical</span> :: ContinueLoop, USE_MA</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZK_(G))</span> :: US_H, VS_H</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(NumBands)</span> :: StkBand_X, StkBand_Y</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="keywordtype">integer</span> :: KK, BB</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; <span class="comment">! Compute averaging depth for Stokes drift (negative)</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  dpt_lasl = min(-0.1*us%m_to_Z, -la_frachbl*hbl)</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  use_ma = la_misalignment</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(override_ma)) use_ma = override_ma</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="comment">! If requesting to use misalignment in the Langmuir number compute the Shear Direction</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="keywordflow">if</span> (use_ma) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordflow">if</span> (.not.(<span class="keyword">present</span>(h).and.<span class="keyword">present</span>(u_h).and.<span class="keyword">present</span>(v_h))) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&#39;Get_LA_waves requested to consider misalignment.&#39;</span>)</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    continueloop = .true.</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    bottom = 0.0</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordflow">do</span> kk = 1,g%ke</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      top = bottom</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      midpoint = bottom + gv%H_to_Z*0.5*h(kk)</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      bottom = bottom + gv%H_to_Z*h(kk)</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <span class="keywordflow">if</span> (midpoint &gt; dpt_lasl .and. kk &gt; 1 .and. continueloop) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        sheardirection = atan2(v_h(1)-v_h(kk),u_h(1)-u_h(kk))</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        continueloop = .false.</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="keywordflow">if</span> (wavemethod==testprof) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordflow">do</span> kk = 1,g%ke</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      us_h(kk) = 0.5*(waves%US_X(i,j,kk)+waves%US_X(i-1,j,kk))</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      vs_h(kk) = 0.5*(waves%US_Y(i,j,kk)+waves%US_Y(i,j-1,kk))</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="keyword">call </span>get_sl_average_prof( gv, dpt_lasl, h, us_h, la_stkx)</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keyword">call </span>get_sl_average_prof( gv, dpt_lasl, h, vs_h, la_stky)</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    la_stk = sqrt(la_stkx*la_stkx+la_stky*la_stky)</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="keywordflow">elseif</span> (wavemethod==surfbands) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordflow">do</span> bb = 1,numbands</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      stkband_x(bb) = 0.5*(waves%STKx0(i,j,bb)+waves%STKx0(i-1,j,bb))</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      stkband_y(bb) = 0.5*(waves%STKy0(i,j,bb)+waves%STKy0(i,j-1,bb))</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keyword">call </span>get_sl_average_band(gv, dpt_lasl, numbands, waves%WaveNum_Cen, stkband_x, la_stkx )</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keyword">call </span>get_sl_average_band(gv, dpt_lasl, numbands, waves%WaveNum_Cen, stkband_y, la_stky )</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    la_stk = sqrt(la_stkx**2 + la_stky**2)</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="keywordflow">elseif</span> (wavemethod==dhh85) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="comment">! Temporarily integrating profile rather than spectrum for simplicity</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordflow">do</span> kk = 1,gv%ke</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      us_h(kk) = 0.5*(waves%US_X(i,j,kk)+waves%US_X(i-1,j,kk))</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      vs_h(kk) = 0.5*(waves%US_Y(i,j,kk)+waves%US_Y(i,j-1,kk))</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keyword">call </span>get_sl_average_prof( gv, dpt_lasl, h, us_h, la_stkx)</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keyword">call </span>get_sl_average_prof( gv, dpt_lasl, h, vs_h, la_stky)</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    la_stk = sqrt(la_stkx**2 + la_stky**2)</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="keywordflow">elseif</span> (wavemethod==lf17) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keyword">call </span>get_stokessl_lifoxkemper(ustar, hbl*la_frachbl, gv, us, la_stk, la)</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="keywordflow">elseif</span> (wavemethod==null_wavemethod) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keyword">call </span>mom_error(fatal, <span class="stringliteral">&quot;Get_Langmuir_number called without defining a WaveMethod. &quot;</span>//&amp;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                          <span class="stringliteral">&quot;Suggest to make sure USE_LT is set/overridden to False or &quot;</span>//&amp;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                          <span class="stringliteral">&quot;choose a wave method (or set USE_LA_LI2016 to use statistical &quot;</span>//&amp;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                          <span class="stringliteral">&quot;waves.&quot;</span>)</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="keywordflow">if</span> (.not.(wavemethod==lf17)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="comment">! This is an arbitrary lower bound on Langmuir number.</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="comment">! We shouldn&#39;t expect values lower than this, but</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="comment">! there is also no good reason to cap it here other then</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="comment">! to prevent large enhancements in unconstrained parts of</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">! the curve fit parameterizations.</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="comment">! Note the dimensional constant background Stokes velocity of 10^-10 m s-1.</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    la = max(waves%La_min, sqrt(us%Z_to_m*us%s_to_T*ustar / (la_stk+1.e-10)))</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="keywordflow">if</span> (use_ma) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    wavedirection = atan2(la_stky, la_stkx)</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    la = la / sqrt(max(1.e-8, cos( wavedirection - sheardirection)))</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; </div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">dhh85</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l01121">get_sl_average_band()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l01082">get_sl_average_prof()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l01003">get_stokessl_lifoxkemper()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00163">la_frachbl</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00165">la_misalignment</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">lf17</a>, <a class="el" href="MOM__error__handler_8F90_source.html#l00072">mom_error_handler::mom_error()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">null_wavemethod</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00141">numbands</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">surfbands</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">testprof</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00131">wavemethod</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__energetic__PBL_8F90_source.html#l00538">mom_energetic_pbl::epbl_column()</a>, <a class="el" href="MOM__CVMix__KPP_8F90_source.html#l00892">mom_cvmix_kpp::kpp_compute_bld()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00479">update_stokes_drift()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_aa07c73f561840851981d6a013423dd6e_cgraph.svg" width="591" height="248"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_aa07c73f561840851981d6a013423dd6e_icgraph.svg" width="100%" height="437"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a5ebd32de10bed6d66c0a95a4a15cc81a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ebd32de10bed6d66c0a95a4a15cc81a">&#9670;&nbsp;</a></span>get_sl_average_band()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_wave_interface::get_sl_average_band </td>
          <td>(</td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>AvgDepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nb), intent(in)&#160;</td>
          <td class="paramname"><em>WaveNumbers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nb), intent(in)&#160;</td>
          <td class="paramname"><em>SurfStokes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>Average</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get SL averaged Stokes drift from the banded Spectrum method. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>Ocean vertical grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">avgdepth</td><td>Depth to average over [Z ~&gt; m]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nb</td><td>Number of bands used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">wavenumbers</td><td>Wavenumber corresponding to each band [Z-1 ~&gt; m-1] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">surfstokes</td><td>Surface Stokes drift for each band [m s-1] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">average</td><td>Output average Stokes drift over depth AvgDepth [m s-1] </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l01121">1121</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type),  &amp;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;       <span class="keywordtype">intent(in)</span>     :: GV<span class="comment">          !&lt; Ocean vertical grid</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span>    :: AvgDepth<span class="comment">    !&lt; Depth to average over [Z ~&gt; m].</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: NB<span class="comment">          !&lt; Number of bands used</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(NB)</span>, &amp;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;       <span class="keywordtype">intent(in)</span>     :: WaveNumbers<span class="comment"> !&lt; Wavenumber corresponding to each band [Z-1 ~&gt; m-1]</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(NB)</span>, &amp;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;       <span class="keywordtype">intent(in)</span>     :: SurfStokes<span class="comment">  !&lt; Surface Stokes drift for each band [m s-1]</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(out)</span>   :: Average<span class="comment">     !&lt; Output average Stokes drift over depth AvgDepth [m s-1]</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="keywordtype">integer</span> :: bb</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="comment">! Loop over bands</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  average = 0.0</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <span class="keywordflow">do</span> bb = 1, nb</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="comment">! Factor includes analytical integration of e(2kz)</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="comment">!  - divided by (-H_LA) to get average from integral.</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    average = average + surfstokes(bb) * &amp;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;              (1.-exp(-abs(avgdepth * 2.0 * wavenumbers(bb)))) / &amp;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;              abs(avgdepth * 2.0 * wavenumbers(bb))</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="keywordflow">  enddo</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00879">get_langmuir_number()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_a5ebd32de10bed6d66c0a95a4a15cc81a_icgraph.svg" width="100%" height="437"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="ae631a776ca48a5b8be572bed00e6f5c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae631a776ca48a5b8be572bed00e6f5c1">&#9670;&nbsp;</a></span>get_sl_average_prof()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_wave_interface::get_sl_average_prof </td>
          <td>(</td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>AvgDepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(szk_(gv)), intent(in)&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(szk_(gv)), intent(in)&#160;</td>
          <td class="paramname"><em>Profile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>Average</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get SL Averaged Stokes drift from a Stokes drift Profile. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>Ocean vertical grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">avgdepth</td><td>Depth to average over [Z ~&gt; m]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Grid thickness [H ~&gt; m or kg m-2] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">profile</td><td>Profile of quantity to be averaged [arbitrary] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">average</td><td>Output quantity averaged over depth AvgDepth [arbitrary] (used here for Stokes drift) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l01082">1082</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type),  &amp;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;       <span class="keywordtype">intent(in)</span>   :: GV<span class="comment">       !&lt; Ocean vertical grid structure</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span>  :: AvgDepth<span class="comment"> !&lt; Depth to average over [Z ~&gt; m].</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZK_(GV))</span>, &amp;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;       <span class="keywordtype">intent(in)</span>   :: H<span class="comment">        !&lt; Grid thickness [H ~&gt; m or kg m-2]</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZK_(GV))</span>, &amp;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;       <span class="keywordtype">intent(in)</span>   :: Profile<span class="comment">  !&lt; Profile of quantity to be averaged [arbitrary]</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">                                !! (used here for Stokes drift)</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(out)</span> :: Average<span class="comment">  !&lt; Output quantity averaged over depth AvgDepth [arbitrary]</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">                                !! (used here for Stokes drift)</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="comment">!Local variables</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="keywordtype">  real</span> :: top, midpoint, bottom <span class="comment">! Depths [Z ~&gt; m].</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="keywordtype">  real</span> :: Sum</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="keywordtype">integer</span> :: kk</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="comment">! Initializing sum</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  sum = 0.0</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="comment">! Integrate</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  bottom = 0.0</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="keywordflow">do</span> kk = 1, gv%ke</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    top = bottom</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    midpoint = bottom - gv%H_to_Z * 0.5*h(kk)</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    bottom = bottom - gv%H_to_Z * h(kk)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">if</span> (avgdepth &lt; bottom) <span class="keywordflow">then</span> <span class="comment">!Whole cell within H_LA</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      sum = sum + profile(kk) * (gv%H_to_Z * h(kk))</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordflow">elseif</span> (avgdepth &lt; top) <span class="keywordflow">then</span> <span class="comment">!partial cell within H_LA</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      sum = sum + profile(kk) * (top-avgdepth)</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="keywordflow">  enddo</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <span class="comment">! Divide by AvgDepth  !### Consider dividing by the depth in the column if that is smaller. -RWH</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  average = sum / abs(avgdepth)</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00879">get_langmuir_number()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_ae631a776ca48a5b8be572bed00e6f5c1_icgraph.svg" width="100%" height="437"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a42ca9104192ff12c44c28b705d137eb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42ca9104192ff12c44c28b705d137eb9">&#9670;&nbsp;</a></span>get_stokessl_lifoxkemper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_wave_interface::get_stokessl_lifoxkemper </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ustar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>hbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>UStokes_SL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>LA</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get SL averaged Stokes drift from Li/FK 17 method. </p>
<p>Original description:</p><ul>
<li>This function returns the enhancement factor, given the 10-meter wind [m s-1], friction velocity [m s-1] and the boundary layer depth [m].</li>
</ul>
<p>Update (Jan/25):</p><ul>
<li>Converted from function to subroutine, now returns Langmuir number.</li>
<li>Computs 10m wind internally, so only ustar and hbl need passed to subroutine.</li>
</ul>
<p>Qing Li, 160606</p><ul>
<li>BGR port from CVMix to MOM6 Jan/25/2017</li>
<li>BGR change output to LA from Efactor</li>
<li>BGR remove u10 input</li>
<li>BGR note: fixed parameter values should be changed to "get_params" <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ustar</td><td>water-side surface friction velocity [Z T-1 ~&gt; m s-1]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hbl</td><td>boundary layer depth [Z ~&gt; m]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>Ocean vertical grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ustokes_sl</td><td>Surface layer averaged Stokes drift [m s-1] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">la</td><td>Langmuir number </td></tr>
  </table>
  </dd>
</dl>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l01003">1003</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span>  :: ustar<span class="comment"> !&lt; water-side surface friction velocity [Z T-1 ~&gt; m s-1].</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span>  :: hbl<span class="comment">   !&lt; boundary layer depth [Z ~&gt; m].</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type), <span class="keywordtype">intent(in)</span> :: GV<span class="comment"> !&lt; Ocean vertical grid structure</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type),   <span class="keywordtype">intent(in)</span> :: US<span class="comment"> !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(out)</span> :: UStokes_SL<span class="comment"> !&lt; Surface layer averaged Stokes drift [m s-1]</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(out)</span> :: LA<span class="comment">    !&lt; Langmuir number</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <span class="comment">! parameters</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">parameter</span> :: &amp;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;       <span class="comment">! ratio of U19.5 to U10 (Holthuijsen, 2007)</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;       u19p5_to_u10 = 1.075, &amp;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;       <span class="comment">! ratio of mean frequency to peak frequency for</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;       <span class="comment">! Pierson-Moskowitz spectrum (Webb, 2011)</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;       fm_into_fp = 1.296, &amp;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;       <span class="comment">! ratio of surface Stokes drift to U10</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;       us_to_u10 = 0.0162, &amp;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;       <span class="comment">! loss ratio of Stokes transport</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;       r_loss = 0.667</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="keywordtype">  real</span> :: UStokes, hm0, fm, fp, vstokes, kphil, kstar</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="keywordtype">  real</span> :: z0, z0i, r1, r2, r3, r4, tmp, lasl_sqr_i</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="keywordtype">  real</span> :: u10</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <span class="keywordflow">if</span> (ustar &gt; 0.0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="comment">! Computing u10 based on u_star and COARE 3.5 relationships</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keyword">call </span>ust_2_u10_coare3p5(us%Z_to_m*us%s_to_T*ustar*sqrt(us%R_to_kg_m3*gv%Rho0/1.225), u10, gv, us)</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="comment">! surface Stokes drift</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    ustokes = us_to_u10*u10</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="comment">! significant wave height from Pierson-Moskowitz</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="comment">! spectrum (Bouws, 1998)</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    hm0 = 0.0246 *u10**2</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="comment">! peak frequency (PM, Bouws, 1998)</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    tmp = 2.0 * pi * u19p5_to_u10 * u10</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    fp = 0.877 * gv%mks_g_Earth / tmp</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="comment">! mean frequency</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    fm = fm_into_fp * fp</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="comment">! total Stokes transport (a factor r_loss is applied to account</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="comment">!  for the effect of directional spreading, multidirectional waves</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="comment">!  and the use of PM peak frequency and PM significant wave height</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="comment">!  on estimating the Stokes transport)</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    vstokes = 0.125 * pi * r_loss * fm * hm0**2</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="comment">! the general peak wavenumber for Phillips&#39; spectrum</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="comment">! (Breivik et al., 2016) with correction of directional spreading</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    kphil = 0.176 * ustokes / vstokes</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="comment">! surface layer averaged Stokes dirft with Stokes drift profile</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="comment">! estimated from Phillips&#39; spectrum (Breivik et al., 2016)</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="comment">! the directional spreading effect from Webb and Fox-Kemper, 2015</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="comment">! is also included</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    kstar = kphil * 2.56</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="comment">! surface layer</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    z0 = abs(us%Z_to_m*hbl)</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    z0i = 1.0 / z0</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="comment">! term 1 to 4</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    r1 = ( 0.151 / kphil * z0i -0.84 ) * &amp;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;         ( 1.0 - exp(-2.0 * kphil * z0) )</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    r2 = -( 0.84 + 0.0591 / kphil * z0i ) * &amp;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;         sqrt( 2.0 * pi * kphil * z0 ) * &amp;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;         erfc( sqrt( 2.0 * kphil * z0 ) )</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    r3 = ( 0.0632 / kstar * z0i + 0.125 ) * &amp;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;         (1.0 - exp(-2.0 * kstar * z0) )</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    r4 = ( 0.125 + 0.0946 / kstar * z0i ) * &amp;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;         sqrt( 2.0 * pi *kstar * z0) * &amp;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;         erfc( sqrt( 2.0 * kstar * z0 ) )</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    ustokes_sl = ustokes * (0.715 + r1 + r2 + r3 + r4)</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    la = sqrt(us%Z_to_m*us%s_to_T*ustar / ustokes_sl)</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    ustokes_sl = 0.0</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    la=1.e8</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MOM__wave__interface_8F90_source.html#l00186">pi</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l01321">ust_2_u10_coare3p5()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00879">get_langmuir_number()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_a42ca9104192ff12c44c28b705d137eb9_cgraph.svg" width="388" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_a42ca9104192ff12c44c28b705d137eb9_icgraph.svg" width="100%" height="437"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a3003dfe4e2167905ae8760bb1115b3cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3003dfe4e2167905ae8760bb1115b3cb">&#9670;&nbsp;</a></span>mom_wave_interface_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_wave_interface::mom_wave_interface_init </td>
          <td>(</td>
          <td class="paramtype">type(time_type), intent(in), target&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(ocean_grid_type), intent(inout)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(param_file_type), intent(in)&#160;</td>
          <td class="paramname"><em>param_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__wave__interface_1_1wave__parameters__cs.html">wave_parameters_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(diag_ctrl), intent(inout), target&#160;</td>
          <td class="paramname"><em>diag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes parameters related to MOM_wave_interface. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>Model time </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g</td><td>Grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>Vertical grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param_file</td><td>Input parameter structure </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cs</td><td>Wave parameter control structure </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">diag</td><td>Diagnostic Pointer </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">193</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordtype">type</span>(time_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(in)</span>    :: Time<span class="comment">       !&lt; Model time</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type),   <span class="keywordtype">intent(inout)</span> :: G<span class="comment">          !&lt; Grid structure</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type), <span class="keywordtype">intent(in)</span>    :: GV<span class="comment">         !&lt; Vertical grid structure</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type),   <span class="keywordtype">intent(in)</span>    :: US<span class="comment">         !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordtype">type</span>(param_file_type),   <span class="keywordtype">intent(in)</span>    :: param_file<span class="comment"> !&lt; Input parameter structure</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordtype">type</span>(wave_parameters_CS), <span class="keywordtype">pointer</span>      :: CS<span class="comment">         !&lt; Wave parameter control structure</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: diag<span class="comment">       !&lt; Diagnostic Pointer</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">! I/O</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordtype">character*(13)</span> :: TMPSTRING1,TMPSTRING2</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordtype">character*(5)</span>, <span class="keywordtype">parameter</span>  :: NULL_STRING      = <span class="stringliteral">&quot;EMPTY&quot;</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordtype">character*(12)</span>, <span class="keywordtype">parameter</span> :: TESTPROF_STRING  = <span class="stringliteral">&quot;TEST_PROFILE&quot;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordtype">character*(13)</span>, <span class="keywordtype">parameter</span> :: SURFBANDS_STRING = <span class="stringliteral">&quot;SURFACE_BANDS&quot;</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordtype">character*(5)</span>, <span class="keywordtype">parameter</span>  :: DHH85_STRING     = <span class="stringliteral">&quot;DHH85&quot;</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordtype">character*(4)</span>, <span class="keywordtype">parameter</span>  :: LF17_STRING      = <span class="stringliteral">&quot;LF17&quot;</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordtype">character*(12)</span>, <span class="keywordtype">parameter</span> :: DATAOVR_STRING   = <span class="stringliteral">&quot;DATAOVERRIDE&quot;</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordtype">character*(7)</span>, <span class="keywordtype">parameter</span>  :: COUPLER_STRING   = <span class="stringliteral">&quot;COUPLER&quot;</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordtype">character*(5)</span>, <span class="keywordtype">parameter</span>  :: INPUT_STRING     = <span class="stringliteral">&quot;INPUT&quot;</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">! Dummy Check</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">associated</span>(cs)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;     <span class="keyword">call </span>mom_error(fatal, <span class="stringliteral">&quot;wave_interface_init called with an associated&quot;</span>//&amp;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                             <span class="stringliteral">&quot;control structure.&quot;</span>)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;     <span class="keywordflow">return</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  pi=4.0*atan(1.0)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">! Allocate CS and set pointers</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keyword">allocate</span>(cs)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  cs%diag =&gt; diag</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  cs%Time =&gt; time</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">! Add any initializations needed here</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  dataoverrideisinitialized = .false.</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">! The only way to get here is with UseWaves enabled.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  cs%UseWaves=.true.</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keyword">call </span>log_version(param_file, mdl, version)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="comment">! Wave modified physics</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">!  Presently these are all in research mode</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;LAGRANGIAN_MIXING&quot;</span>, cs%LagrangianMixing, &amp;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;       <span class="stringliteral">&quot;Flag to use Lagrangian Mixing of momentum&quot;</span>, units=<span class="stringliteral">&quot;&quot;</span>, &amp;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;       default=.false.)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">if</span> (cs%LagrangianMixing) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">! Force Code Intervention</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;Should you be enabling Lagrangian Mixing? Code not ready.&quot;</span>)</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;STOKES_MIXING&quot;</span>, cs%StokesMixing, &amp;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;       <span class="stringliteral">&quot;Flag to use Stokes Mixing of momentum&quot;</span>, units=<span class="stringliteral">&quot;&quot;</span>, &amp;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;       default=.false.)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">if</span> (cs%StokesMixing) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">! Force Code Intervention</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;Should you be enabling Stokes Mixing? Code not ready.&quot;</span>)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;CORIOLIS_STOKES&quot;</span>, cs%CoriolisStokes, &amp;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;       <span class="stringliteral">&quot;Flag to use Coriolis Stokes acceleration&quot;</span>, units=<span class="stringliteral">&quot;&quot;</span>, &amp;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;       default=.false.)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">if</span> (cs%CoriolisStokes) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">! Force Code Intervention</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;Should you be enabling Coriolis-Stokes? Code not ready.&quot;</span>)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="comment">! Get Wave Method and write to integer WaveMethod</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keyword">call </span>get_param(param_file,mdl,<span class="stringliteral">&quot;WAVE_METHOD&quot;</span>,tmpstring1,             &amp;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;       <span class="stringliteral">&quot;Choice of wave method, valid options include: \n&quot;</span>//           &amp;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;       <span class="stringliteral">&quot; TEST_PROFILE  - Prescribed from surface Stokes drift \n&quot;</span>//   &amp;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;       <span class="stringliteral">&quot;                 and a decay wavelength.\n&quot;</span>//                 &amp;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;       <span class="stringliteral">&quot; SURFACE_BANDS - Computed from multiple surface values \n&quot;</span>//  &amp;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;       <span class="stringliteral">&quot;                 and decay wavelengths.\n&quot;</span>//                  &amp;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;       <span class="stringliteral">&quot; DHH85         - Uses Donelan et al. 1985 empirical \n&quot;</span>//     &amp;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;       <span class="stringliteral">&quot;                 wave spectrum with prescribed values. \n&quot;</span>//  &amp;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;       <span class="stringliteral">&quot; LF17          - Infers Stokes drift profile from wind \n&quot;</span>//  &amp;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;       <span class="stringliteral">&quot;                 speed following Li and Fox-Kemper 2017.\n&quot;</span>,  &amp;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;       units=<span class="stringliteral">&#39;&#39;</span>, default=null_string)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordflow">select case</span> (trim(tmpstring1))</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordflow">case</span> (null_string)<span class="comment">! No Waves</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keyword">call </span>mom_error(fatal, <span class="stringliteral">&quot;wave_interface_init called with no specified &quot;</span>//&amp;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                           <span class="stringliteral">&quot;WAVE_METHOD.&quot;</span>)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">case</span> (testprof_string)<span class="comment">! Test Profile</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    wavemethod = testprof</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keyword">call </span>get_param(param_file,mdl,<span class="stringliteral">&quot;TP_STKX_SURF&quot;</span>,tp_stkx0,&amp;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;         <span class="stringliteral">&#39;Surface Stokes (x) for test profile&#39;</span>,&amp;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;         units=<span class="stringliteral">&#39;m/s&#39;</span>,default=0.1)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keyword">call </span>get_param(param_file,mdl,<span class="stringliteral">&quot;TP_STKY_SURF&quot;</span>,tp_stky0,&amp;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;         <span class="stringliteral">&#39;Surface Stokes (y) for test profile&#39;</span>,&amp;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;         units=<span class="stringliteral">&#39;m/s&#39;</span>,default=0.0)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keyword">call </span>get_param(param_file,mdl,<span class="stringliteral">&quot;TP_WVL&quot;</span>,tp_wvl,&amp;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;         units=<span class="stringliteral">&#39;m&#39;</span>, default=50.0, scale=us%m_to_Z)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">case</span> (surfbands_string)<span class="comment">! Surface Stokes Drift Bands</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    wavemethod = surfbands</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;SURFBAND_SOURCE&quot;</span>,tmpstring2,       &amp;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;       <span class="stringliteral">&quot;Choice of SURFACE_BANDS data mode, valid options include: \n&quot;</span>// &amp;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;       <span class="stringliteral">&quot; DATAOVERRIDE  - Read from NetCDF using FMS DataOverride. \n&quot;</span>// &amp;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;       <span class="stringliteral">&quot; COUPLER       - Look for variables from coupler pass \n&quot;</span>//     &amp;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;       <span class="stringliteral">&quot; INPUT         - Testing with fixed values.&quot;</span>,                   &amp;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;       units=<span class="stringliteral">&#39;&#39;</span>, default=null_string)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">select case</span> (trim(tmpstring2))</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">case</span> (null_string)<span class="comment">! Default</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keyword">call </span>mom_error(fatal, <span class="stringliteral">&quot;wave_interface_init called with SURFACE_BANDS&quot;</span>//&amp;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                           <span class="stringliteral">&quot; but no SURFBAND_SOURCE.&quot;</span>)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">case</span> (dataovr_string)<span class="comment">! Using Data Override</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      datasource = dataovr</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;SURFBAND_FILENAME&quot;</span>, surfbandfilename, &amp;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;           <span class="stringliteral">&quot;Filename of surface Stokes drift input band data.&quot;</span>, default=<span class="stringliteral">&quot;StkSpec.nc&quot;</span>)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">case</span> (coupler_string)<span class="comment">! Reserved for coupling</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      datasource = coupler</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">case</span> (input_string)<span class="comment">! A method to input the Stokes band (globally uniform)</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      datasource = input</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keyword">call </span>get_param(param_file,mdl,<span class="stringliteral">&quot;SURFBAND_NB&quot;</span>,numbands,                 &amp;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;         <span class="stringliteral">&quot;Prescribe number of wavenumber bands for Stokes drift. &quot;</span>//      &amp;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;         <span class="stringliteral">&quot;Make sure this is consistnet w/ WAVENUMBERS, STOKES_X, and &quot;</span>// &amp;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;         <span class="stringliteral">&quot;STOKES_Y, there are no safety checks in the code.&quot;</span>,              &amp;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;         units=<span class="stringliteral">&#39;&#39;</span>, default=1)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keyword">allocate</span>( cs%WaveNum_Cen(1:numbands) )</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      cs%WaveNum_Cen(:) = 0.0</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keyword">allocate</span>( cs%PrescribedSurfStkX(1:numbands))</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      cs%PrescribedSurfStkX(:) = 0.0</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="keyword">allocate</span>( cs%PrescribedSurfStkY(1:numbands))</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      cs%PrescribedSurfStkY(:) = 0.0</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keyword">allocate</span>( cs%STKx0(g%isdB:g%iedB,g%jsd:g%jed,1:numbands))</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      cs%STKx0(:,:,:) = 0.0</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keyword">allocate</span>( cs%STKy0(g%isd:g%ied,g%jsdB:g%jedB,1:numbands))</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      cs%STKy0(:,:,:) = 0.0</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      partitionmode=0</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keyword">call </span>get_param(param_file,mdl,<span class="stringliteral">&quot;SURFBAND_WAVENUMBERS&quot;</span>,cs%WaveNum_Cen,      &amp;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;           <span class="stringliteral">&quot;Central wavenumbers for surface Stokes drift bands.&quot;</span>,units=<span class="stringliteral">&#39;rad/m&#39;</span>, &amp;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;           default=0.12566)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="keyword">call </span>get_param(param_file,mdl,<span class="stringliteral">&quot;SURFBAND_STOKES_X&quot;</span>,cs%PrescribedSurfStkX,      &amp;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;           <span class="stringliteral">&quot;X-direction surface Stokes drift for bands.&quot;</span>,units=<span class="stringliteral">&#39;m/s&#39;</span>, &amp;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;           default=0.15)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keyword">call </span>get_param(param_file,mdl,<span class="stringliteral">&quot;SURFBAND_STOKES_Y&quot;</span>,cs%PrescribedSurfStkY,      &amp;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;           <span class="stringliteral">&quot;Y-direction surface Stokes drift for bands.&quot;</span>,units=<span class="stringliteral">&#39;m/s&#39;</span>, &amp;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;           default=0.0)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="keywordflow">   case default</span><span class="comment">! No method provided</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;     <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&#39;Check WAVE_METHOD.&#39;</span>)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="keywordflow">   end select</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordflow">case</span> (dhh85_string)<span class="comment">!Donelan et al., 1985 spectrum</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    wavemethod = dhh85</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keyword">call </span>mom_error(warning,<span class="stringliteral">&quot;DHH85 only ever set-up for uniform cases w/&quot;</span>//&amp;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                           <span class="stringliteral">&quot; Stokes drift in x-direction.&quot;</span>)</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keyword">call </span>get_param(param_file,mdl,<span class="stringliteral">&quot;DHH85_AGE_FP&quot;</span>,waveagepeakfreq,   &amp;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;         <span class="stringliteral">&quot;Choose true to use waveage in peak frequency.&quot;</span>, &amp;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;         units=<span class="stringliteral">&#39;&#39;</span>, default=.false.)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keyword">call </span>get_param(param_file,mdl,<span class="stringliteral">&quot;DHH85_AGE&quot;</span>,waveage,   &amp;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;         <span class="stringliteral">&quot;Wave Age for DHH85 spectrum.&quot;</span>, &amp;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;         units=<span class="stringliteral">&#39;&#39;</span>, default=1.2)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keyword">call </span>get_param(param_file,mdl,<span class="stringliteral">&quot;DHH85_WIND&quot;</span>,wavewind,   &amp;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;         <span class="stringliteral">&quot;Wind speed for DHH85 spectrum.&quot;</span>, &amp;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;         units=<span class="stringliteral">&#39;&#39;</span>, default=10.0)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keyword">call </span>get_param(param_file,mdl,<span class="stringliteral">&quot;STATIC_DHH85&quot;</span>,staticwaves,   &amp;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;         <span class="stringliteral">&quot;Flag to disable updating DHH85 Stokes drift.&quot;</span>, &amp;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;          default=.false.)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordflow">case</span> (lf17_string)<span class="comment">!Li and Fox-Kemper 17 wind-sea Langmuir number</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    wavemethod = lf17</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keywordflow">   case default</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;     <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&#39;Check WAVE_METHOD.&#39;</span>)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="keywordflow">  end select</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="comment">! Langmuir number Options</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;LA_DEPTH_RATIO&quot;</span>, la_frachbl,              &amp;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;         <span class="stringliteral">&quot;The depth (normalized by BLD) to average Stokes drift over in &quot;</span>//&amp;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;         <span class="stringliteral">&quot;Langmuir number calculation, where La = sqrt(ust/Stokes).&quot;</span>,       &amp;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;         units=<span class="stringliteral">&quot;nondim&quot;</span>,default=0.04)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;LA_MISALIGNMENT&quot;</span>, la_misalignment,    &amp;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;         <span class="stringliteral">&quot;Flag (logical) if using misalignment bt shear and waves in LA&quot;</span>,&amp;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;         default=.false.)</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;MIN_LANGMUIR&quot;</span>, cs%La_min,    &amp;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;         <span class="stringliteral">&quot;A minimum value for all Langmuir numbers that is not physical, &quot;</span>//&amp;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;         <span class="stringliteral">&quot;but is likely only encountered when the wind is very small and &quot;</span>//&amp;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;         <span class="stringliteral">&quot;therefore its effects should be mostly benign.&quot;</span>,units=<span class="stringliteral">&quot;nondim&quot;</span>,&amp;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;         default=0.05)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="comment">! Allocate and initialize</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="comment">! a. Stokes driftProfiles</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keyword">allocate</span>(cs%Us_x(g%isdB:g%IedB,g%jsd:g%jed,g%ke))</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  cs%Us_x(:,:,:) = 0.0</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keyword">allocate</span>(cs%Us_y(g%isd:g%Ied,g%jsdB:g%jedB,g%ke))</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  cs%Us_y(:,:,:) = 0.0</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="comment">! b. Surface Values</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keyword">allocate</span>(cs%US0_x(g%isdB:g%iedB,g%jsd:g%jed))</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  cs%US0_x(:,:) = 0.0</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keyword">allocate</span>(cs%US0_y(g%isd:g%ied,g%jsdB:g%jedB))</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  cs%US0_y(:,:) = 0.0</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="comment">! c. Langmuir number</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keyword">allocate</span>(cs%La_SL(g%isc:g%iec,g%jsc:g%jec))</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keyword">allocate</span>(cs%La_turb(g%isc:g%iec,g%jsc:g%jec))</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  cs%La_SL(:,:) = 0.0</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  cs%La_turb (:,:) = 0.0</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">! d. Viscosity for Stokes drift</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordflow">if</span> (cs%StokesMixing) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keyword">allocate</span>(cs%KvS(g%isd:g%Ied,g%jsd:g%jed,g%ke))</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    cs%KvS(:,:,:) = 0.0</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">! Initialize Wave related outputs</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  cs%id_surfacestokes_y = register_diag_field(<span class="stringliteral">&#39;ocean_model&#39;</span>,<span class="stringliteral">&#39;surface_stokes_y&#39;</span>, &amp;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;       cs%diag%axesCu1,time,<span class="stringliteral">&#39;Surface Stokes drift (y)&#39;</span>,<span class="stringliteral">&#39;m s-1&#39;</span>)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  cs%id_surfacestokes_x = register_diag_field(<span class="stringliteral">&#39;ocean_model&#39;</span>,<span class="stringliteral">&#39;surface_stokes_x&#39;</span>, &amp;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;       cs%diag%axesCv1,time,<span class="stringliteral">&#39;Surface Stokes drift (x)&#39;</span>,<span class="stringliteral">&#39;m s-1&#39;</span>)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  cs%id_3dstokes_y = register_diag_field(<span class="stringliteral">&#39;ocean_model&#39;</span>,<span class="stringliteral">&#39;3d_stokes_y&#39;</span>, &amp;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;       cs%diag%axesCvL,time,<span class="stringliteral">&#39;3d Stokes drift (y)&#39;</span>,<span class="stringliteral">&#39;m s-1&#39;</span>)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  cs%id_3dstokes_x = register_diag_field(<span class="stringliteral">&#39;ocean_model&#39;</span>,<span class="stringliteral">&#39;3d_stokes_x&#39;</span>, &amp;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;       cs%diag%axesCuL,time,<span class="stringliteral">&#39;3d Stokes drift (y)&#39;</span>,<span class="stringliteral">&#39;m s-1&#39;</span>)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  cs%id_La_turb = register_diag_field(<span class="stringliteral">&#39;ocean_model&#39;</span>,<span class="stringliteral">&#39;La_turbulent&#39;</span>,&amp;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;       cs%diag%axesT1,time,<span class="stringliteral">&#39;Surface (turbulent) Langmuir number&#39;</span>,<span class="stringliteral">&#39;nondim&#39;</span>)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">coupler</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00159">dataoverrideisinitialized</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">dataovr</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00149">datasource</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">dhh85</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">input</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00163">la_frachbl</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00165">la_misalignment</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">lf17</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00171">mdl</a>, <a class="el" href="MOM__error__handler_8F90_source.html#l00072">mom_error_handler::mom_error()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00141">numbands</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00145">partitionmode</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00186">pi</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00184">staticwaves</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00157">surfbandfilename</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">surfbands</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">testprof</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00182">tp_stkx0</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00182">tp_stky0</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00182">tp_wvl</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00185">waveage</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00183">waveagepeakfreq</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00131">wavemethod</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00185">wavewind</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__driver_8F90_source.html#l00001">mom_main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_a3003dfe4e2167905ae8760bb1115b3cb_cgraph.svg" width="568" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_a3003dfe4e2167905ae8760bb1115b3cb_icgraph.svg" width="324" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ad2bad416c49ca81a4e5822b70d2e14b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2bad416c49ca81a4e5822b70d2e14b9">&#9670;&nbsp;</a></span>mom_wave_interface_init_lite()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_wave_interface::mom_wave_interface_init_lite </td>
          <td>(</td>
          <td class="paramtype">type(param_file_type), intent(in)&#160;</td>
          <td class="paramname"><em>param_file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A 'lite' init subroutine to initialize a few inputs needed if using wave information with the wind-speed dependent Stokes drift formulation of LF17. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">param_file</td><td>Input parameter structure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00410">410</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordtype">type</span>(param_file_type), <span class="keywordtype">intent(in)</span> :: param_file<span class="comment"> !&lt; Input parameter structure</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordtype">character*(5)</span>, <span class="keywordtype">parameter</span>  :: NULL_STRING      = <span class="stringliteral">&quot;EMPTY&quot;</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordtype">character*(4)</span>, <span class="keywordtype">parameter</span>  :: LF17_STRING      = <span class="stringliteral">&quot;LF17&quot;</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordtype">character*(13)</span> :: TMPSTRING1</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordtype">logical</span> :: StatisticalWaves</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="comment">! Langmuir number Options</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;LA_DEPTH_RATIO&quot;</span>, la_frachbl,              &amp;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;       <span class="stringliteral">&quot;The depth (normalized by BLD) to average Stokes drift over in &quot;</span>//&amp;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;       <span class="stringliteral">&quot;Langmuir number calculation, where La = sqrt(ust/Stokes).&quot;</span>,       &amp;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;       units=<span class="stringliteral">&quot;nondim&quot;</span>,default=0.04)</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="comment">! Check if using LA_LI2016</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keyword">call </span>get_param(param_file,mdl,<span class="stringliteral">&quot;USE_LA_LI2016&quot;</span>,statisticalwaves,     &amp;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                 do_not_log=.true.,default=.false.)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordflow">if</span> (statisticalwaves) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    wavemethod = lf17</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    pi=4.0*atan(1.0)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    wavemethod = null_wavemethod</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MOM__wave__interface_8F90_source.html#l00163">la_frachbl</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">lf17</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00171">mdl</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">null_wavemethod</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00186">pi</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00131">wavemethod</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__driver_8F90_source.html#l00001">mom_main()</a>, <a class="el" href="mom__ocean__model__mct_8F90_source.html#l00224">mom_ocean_model_mct::ocean_model_init()</a>, and <a class="el" href="mom__ocean__model__nuopc_8F90_source.html#l00226">mom_ocean_model_nuopc::ocean_model_init()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_ad2bad416c49ca81a4e5822b70d2e14b9_icgraph.svg" width="391" height="170"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a86d1b417862d641edb7996ff136c4b93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86d1b417862d641edb7996ff136c4b93">&#9670;&nbsp;</a></span>stokesmixing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_wave_interface::stokesmixing </td>
          <td>(</td>
          <td class="paramtype">type(ocean_grid_type), intent(in)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(szi_(g),szj_(g),szk_(g)), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(szib_(g),szj_(g),szk_(g)), intent(inout)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(szi_(g),szjb_(g),szk_(g)), intent(inout)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__wave__interface_1_1wave__parameters__cs.html">wave_parameters_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>Waves</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Explicit solver for Stokes mixing. Still in development do not use. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>Ocean grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>Ocean vertical grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>Time step of MOM6 [T ~&gt; s] for explicit solver </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Layer thicknesses [H ~&gt; m or kg m-2] </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">u</td><td>Velocity i-component [m s-1] </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">v</td><td>Velocity j-component [m s-1] </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">waves</td><td>Surface wave related control structure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l01209">1209</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type), &amp;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;       <span class="keywordtype">intent(in)</span>    :: G<span class="comment">     !&lt; Ocean grid</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type), &amp;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;       <span class="keywordtype">intent(in)</span>    :: GV<span class="comment">    !&lt; Ocean vertical grid</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span>   :: dt<span class="comment">    !&lt; Time step of MOM6 [T ~&gt; s] for explicit solver</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G),SZK_(G))</span>,&amp;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;       <span class="keywordtype">intent(in)</span>    :: h<span class="comment">     !&lt; Layer thicknesses [H ~&gt; m or kg m-2]</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZIB_(G),SZJ_(G),SZK_(G))</span>, &amp;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;       <span class="keywordtype">intent(inout)</span> :: u<span class="comment">     !&lt; Velocity i-component [m s-1]</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJB_(G),SZK_(G))</span>, &amp;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;       <span class="keywordtype">intent(inout)</span> :: v<span class="comment">     !&lt; Velocity j-component [m s-1]</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="keywordtype">type</span>(Wave_parameters_CS), &amp;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;       <span class="keywordtype">pointer</span>       :: Waves<span class="comment"> !&lt; Surface wave related control structure.</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="keywordtype">  real</span> :: dTauUp, dTauDn <span class="comment">! Vertical momentum fluxes [Z T-1 m s-1]</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="keywordtype">  real</span> :: h_Lay  <span class="comment">! The layer thickness at a velocity point [Z ~&gt; m].</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <span class="keywordtype">integer</span> :: i,j,k</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">! This is a template to think about down-Stokes mixing.</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment">! This is not ready for use...</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160; </div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  <span class="keywordflow">do</span> k = 1, g%ke</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keywordflow">do</span> j = g%jsc, g%jec</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <span class="keywordflow">do</span> i = g%iscB, g%iecB</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        h_lay = gv%H_to_Z*0.5*(h(i,j,k)+h(i+1,j,k))</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        dtauup = 0.0</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        <span class="keywordflow">if</span> (k &gt; 1) &amp;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;          dtauup = 0.5*(waves%Kvs(i,j,k)+waves%Kvs(i+1,j,k)) * &amp;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;               (waves%us_x(i,j,k-1)-waves%us_x(i,j,k)) / &amp;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;               (0.5*(h_lay + gv%H_to_Z*0.5*(h(i,j,k-1)+h(i+1,j,k-1)) ))</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        dtaudn = 0.0</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="keywordflow">if</span> (k &lt; g%ke-1) &amp;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;          dtaudn = 0.5*(waves%Kvs(i,j,k+1)+waves%Kvs(i+1,j,k+1)) * &amp;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;               (waves%us_x(i,j,k)-waves%us_x(i,j,k+1)) / &amp;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;               (0.5*(h_lay + gv%H_to_Z*0.5*(h(i,j,k+1)+h(i+1,j,k+1)) ))</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        u(i,j,k) = u(i,j,k) + dt * (dtauup-dtaudn) / h_lay</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="keywordflow">  enddo</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160; </div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <span class="keywordflow">do</span> k = 1, g%ke</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordflow">do</span> j = g%jscB, g%jecB</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      <span class="keywordflow">do</span> i = g%isc, g%iec</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        h_lay = gv%H_to_Z*0.5*(h(i,j,k)+h(i,j+1,k))</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        dtauup = 0.</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <span class="keywordflow">if</span> (k &gt; 1) &amp;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;          dtauup = 0.5*(waves%Kvs(i,j,k)+waves%Kvs(i,j+1,k)) * &amp;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;               (waves%us_y(i,j,k-1)-waves%us_y(i,j,k)) / &amp;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;               (0.5*(h_lay + gv%H_to_Z*0.5*(h(i,j,k-1)+h(i,j+1,k-1)) ))</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        dtaudn = 0.0</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <span class="keywordflow">if</span> (k &lt; g%ke-1) &amp;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;          dtaudn =0.5*(waves%Kvs(i,j,k+1)+waves%Kvs(i,j+1,k+1)) * &amp;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;               (waves%us_y(i,j,k)-waves%us_y(i,j,k+1)) / &amp;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;               (0.5*(h_lay + gv%H_to_Z*0.5*(h(i,j,k+1)+h(i,j+1,k+1)) ))</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        v(i,j,k) = v(i,j,k) + dt * (dtauup-dtaudn) / h_lay</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="keywordflow">  enddo</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a01dd0c089dab89934450a7a699255658"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01dd0c089dab89934450a7a699255658">&#9670;&nbsp;</a></span>surface_bands_by_data_override()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_wave_interface::surface_bands_by_data_override </td>
          <td>(</td>
          <td class="paramtype">type(time_type), intent(in)&#160;</td>
          <td class="paramname"><em>day_center</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(ocean_grid_type), intent(inout)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__wave__interface_1_1wave__parameters__cs.html">wave_parameters_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>CS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A subroutine to fill the Stokes drift from a NetCDF file using the data_override procedures. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">day_center</td><td>Center of timestep </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cs</td><td>Wave structure </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g</td><td>Grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>Vertical grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00709">709</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keywordtype">use </span>netcdf</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordtype">type</span>(time_type),          <span class="keywordtype">intent(in)</span> :: day_center<span class="comment"> !&lt; Center of timestep</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keywordtype">type</span>(wave_parameters_CS), <span class="keywordtype">pointer</span>    :: CS<span class="comment">         !&lt; Wave structure</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type), <span class="keywordtype">intent(inout)</span> :: G<span class="comment">          !&lt; Grid structure</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type),  <span class="keywordtype">intent(in)</span> :: GV<span class="comment">         !&lt; Vertical grid structure</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type),    <span class="keywordtype">intent(in)</span> :: US<span class="comment">         !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="keywordtype">  real</span>    :: temp_x(SZI_(G),SZJ_(G)) <span class="comment">! Pseudo-zonal Stokes drift of band at h-points [m s-1]</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="keywordtype">  real</span>    :: temp_y(SZI_(G),SZJ_(G)) <span class="comment">! Psuedo-meridional Stokes drift of band at h-points [m s-1]</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="keywordtype">  real</span>    :: Top, MidPoint</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keywordtype">integer</span> :: b</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordtype">integer</span> :: i, j</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(4)</span> :: start, counter, dims, dim_id</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="keywordtype">character(len=12)</span>  :: dim_name(4)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordtype">character(20)</span> :: varname, varread1, varread2</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keywordtype">integer</span> :: rcode_fr, rcode_wn, ncid, varid_fr, varid_wn, id, ndims</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="keywordflow">if</span> (.not.dataoverrideisinitialized) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keyword">call </span>data_override_init(ocean_domain_in=g%Domain%mpp_domain)</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    dataoverrideisinitialized = .true.</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">! Read in number of wavenumber bands in file to set number to be read in</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="comment">! Hardcoded filename/variables</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    varread1 = <span class="stringliteral">&#39;wavenumber&#39;</span> <span class="comment">!Old method gives wavenumber</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    varread2 = <span class="stringliteral">&#39;frequency&#39;</span>  <span class="comment">!New method gives frequency</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    rcode_wn = nf90_open(trim(surfbandfilename), nf90_nowrite, ncid)</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">if</span> (rcode_wn /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;error opening file &quot;</span>//trim(surfbandfilename)//&amp;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            <span class="stringliteral">&quot; in MOM_wave_interface.&quot;</span>)</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="comment">! Check if rcode_wn or rcode_fr is 0 (checks if input has wavenumber or frequency)</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    rcode_wn = nf90_inq_varid(ncid, varread1, varid_wn)</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    rcode_fr = nf90_inq_varid(ncid, varread2, varid_fr)</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">if</span> (rcode_wn /= 0 .and. rcode_fr /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;error finding variable &quot;</span>//trim(varread1)//&amp;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;         <span class="stringliteral">&quot; or &quot;</span>//trim(varread2)//<span class="stringliteral">&quot; in file &quot;</span>//trim(surfbandfilename)//<span class="stringliteral">&quot; in MOM_wave_interface.&quot;</span>)</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">elseif</span> (rcode_wn == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="comment">! wavenumbers found:</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      partitionmode = 0</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      rcode_wn = nf90_inquire_variable(ncid, varid_wn, ndims=ndims, &amp;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;           dimids=dims)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="keywordflow">if</span> (rcode_wn /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="keyword">call </span>mom_error(fatal, &amp;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;             <span class="stringliteral">&#39;error inquiring dimensions MOM_wave_interface.&#39;</span>)</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      rcode_wn = nf90_inquire_dimension(ncid, dims(1), dim_name(1), len=id)</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="keywordflow">if</span> (rcode_wn /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;error reading dimension 1 data for &quot;</span>// &amp;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;             trim(varread1)//<span class="stringliteral">&quot; in file &quot;</span>// trim(surfbandfilename)//          &amp;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;             <span class="stringliteral">&quot; in MOM_wave_interface.&quot;</span>)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      rcode_wn = nf90_inq_varid(ncid, dim_name(1), dim_id(1))</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      <span class="keywordflow">if</span> (rcode_wn /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;error finding variable &quot;</span>//trim(dim_name(1))//&amp;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;          <span class="stringliteral">&quot; in file &quot;</span>//trim(surfbandfilename)//<span class="stringliteral">&quot; in MOM_wave_interace.&quot;</span>)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="comment">! Allocating size of wavenumber bins</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <span class="keyword">allocate</span>( cs%WaveNum_Cen(1:id) )</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      cs%WaveNum_Cen(:) = 0.0</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordflow">elseif</span> (rcode_fr == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <span class="comment">! frequencies found:</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      partitionmode = 1</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      rcode_fr = nf90_inquire_variable(ncid, varid_fr, ndims=ndims, &amp;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;           dimids=dims)</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <span class="keywordflow">if</span> (rcode_fr /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="keyword">call </span>mom_error(fatal,&amp;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;             <span class="stringliteral">&#39;error inquiring dimensions MOM_wave_interface.&#39;</span>)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      rcode_fr = nf90_inquire_dimension(ncid, dims(1), dim_name(1), len=id)</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <span class="keywordflow">if</span> (rcode_fr /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;error reading dimension 1 data for &quot;</span>// &amp;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;             trim(varread2)//<span class="stringliteral">&quot; in file &quot;</span>// trim(surfbandfilename)// &amp;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;             <span class="stringliteral">&quot; in MOM_wave_interface.&quot;</span>)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      rcode_fr = nf90_inq_varid(ncid, dim_name(1), dim_id(1))</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="keywordflow">if</span> (rcode_fr /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;error finding variable &quot;</span>//trim(dim_name(1))//&amp;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;             <span class="stringliteral">&quot; in file &quot;</span>//trim(surfbandfilename)//<span class="stringliteral">&quot; in MOM_wave_interace.&quot;</span>)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <span class="comment">! Allocating size of frequency bins</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keyword">allocate</span>( cs%Freq_Cen(1:id) )</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      cs%Freq_Cen(:) = 0.0</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="comment">! Allocating size of wavenumber bins</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="keyword">allocate</span>( cs%WaveNum_Cen(1:id) )</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      cs%WaveNum_Cen(:) = 0.0</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="keyword">allocate</span>( cs%STKx0(g%isdB:g%iedB,g%jsd:g%jed,1:id))</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      cs%STKx0(:,:,:) = 0.0</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="keyword">allocate</span>( cs%STKy0(g%isd:g%ied,g%jsdB:g%jedB,1:id))</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      cs%STKy0(:,:,:) = 0.0</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="comment">! Reading wavenumber bins/Frequencies</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    start(:) = 1 <span class="comment">! Set all start to 1</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    counter(:) = 1 <span class="comment">! Set all counter to 1</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    counter(1) = id <span class="comment">! Set counter(1) to id (number of frequency bins)</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">if</span> (partitionmode==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      rcode_wn = nf90_get_var(ncid, dim_id(1), cs%WaveNum_Cen, start, counter)</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="keywordflow">if</span> (rcode_wn /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <span class="keyword">call </span>mom_error(fatal,&amp;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;             <span class="stringliteral">&quot;error reading dimension 1 values for var_name &quot;</span>// &amp;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;             trim(varread1)//<span class="stringliteral">&quot;,dim_name &quot;</span>//trim(dim_name(1))//  &amp;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;             <span class="stringliteral">&quot; in file &quot;</span>// trim(surfbandfilename)//<span class="stringliteral">&quot; in MOM_wave_interface&quot;</span>)</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      numbands = id</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <span class="keywordflow">do</span> b = 1,numbands ; cs%WaveNum_Cen(b) = us%Z_to_m*cs%WaveNum_Cen(b) ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">elseif</span> (partitionmode==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      rcode_fr = nf90_get_var(ncid, dim_id(1), cs%Freq_Cen, start, counter)</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keywordflow">if</span> (rcode_fr /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="keyword">call </span>mom_error(fatal,&amp;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;             <span class="stringliteral">&quot;error reading dimension 1 values for var_name &quot;</span>// &amp;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;             trim(varread2)//<span class="stringliteral">&quot;,dim_name &quot;</span>//trim(dim_name(1))//  &amp;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;             <span class="stringliteral">&quot; in file &quot;</span>// trim(surfbandfilename)//<span class="stringliteral">&quot; in MOM_wave_interface&quot;</span>)</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      numbands = id</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="keywordflow">do</span> b = 1,numbands</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        cs%WaveNum_Cen(b) = (2.*pi*cs%Freq_Cen(b)*us%T_to_s)**2 / (us%L_to_Z**2*gv%g_Earth)</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="keywordflow">do</span> b = 1,numbands</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    temp_x(:,:) = 0.0</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    temp_y(:,:) = 0.0</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    varname = <span class="stringliteral">&#39;                    &#39;</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="keyword">write</span>(varname,<span class="stringliteral">&quot;(A3,I0)&quot;</span>)<span class="stringliteral">&#39;Usx&#39;</span>,b</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keyword">call </span>data_override(<span class="stringliteral">&#39;OCN&#39;</span>,trim(varname), temp_x, day_center)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    varname = <span class="stringliteral">&#39;                    &#39;</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keyword">write</span>(varname,<span class="stringliteral">&#39;(A3,I0)&#39;</span>)<span class="stringliteral">&#39;Usy&#39;</span>,b</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keyword">call </span>data_override(<span class="stringliteral">&#39;OCN&#39;</span>,trim(varname), temp_y, day_center)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="comment">! Disperse into halo on h-grid</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keyword">call </span>pass_vector(temp_x, temp_y, g%Domain, to_all, agrid)</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="comment">!Filter land values</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordflow">do</span> j = g%jsd,g%jed</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="keywordflow">do</span> i = g%Isd,g%Ied</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="keywordflow">if</span> (abs(temp_x(i,j)) &gt; 10. .or. abs(temp_y(i,j)) &gt; 10.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;          <span class="comment">! Assume land-mask and zero out</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;          temp_x(i,j) = 0.0</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;          temp_y(i,j) = 0.0</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="comment">! Interpolate to u/v grids</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">do</span> j = g%jsc,g%jec</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      <span class="keywordflow">do</span> i = g%IscB,g%IecB</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        cs%STKx0(i,j,b) = 0.5 * (temp_x(i,j) + temp_x(i+1,j))</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordflow">do</span> j = g%JscB,g%JecB</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <span class="keywordflow">do</span> i = g%isc,g%iec</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        cs%STKy0(i,j,b) = 0.5 * (temp_y(i,j) + temp_y(i,j+1))</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="comment">! Disperse into halo on u/v grids</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keyword">call </span>pass_vector(cs%STKx0(:,:,b),cs%STKy0(:,:,b), g%Domain, to_all)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="keywordflow">  enddo</span> <span class="comment">!Closes b-loop</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MOM__wave__interface_8F90_source.html#l00159">dataoverrideisinitialized</a>, <a class="el" href="MOM__error__handler_8F90_source.html#l00072">mom_error_handler::mom_error()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00141">numbands</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00145">partitionmode</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00186">pi</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00157">surfbandfilename</a>, and <a class="el" href="MOM__domains_8F90_source.html#l00132">mom_domains::to_all</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00437">update_surface_waves()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_a01dd0c089dab89934450a7a699255658_cgraph.svg" width="558" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_a01dd0c089dab89934450a7a699255658_icgraph.svg" width="616" height="170"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a42b769030d04a1c087e168de36ce7285"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42b769030d04a1c087e168de36ce7285">&#9670;&nbsp;</a></span>update_stokes_drift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_wave_interface::update_stokes_drift </td>
          <td>(</td>
          <td class="paramtype">type(ocean_grid_type), intent(inout)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__wave__interface_1_1wave__parameters__cs.html">wave_parameters_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( g %isd: g %ied, g %jsd: g %jed, g %ke), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( g %isd: g %ied, g %jsd: g %jed), intent(in)&#160;</td>
          <td class="paramname"><em>ustar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs the Stokes Drift profile on the model grid based on desired coupling options. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">cs</td><td>Wave parameter Control structure </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g</td><td>Grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>Vertical grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Thickness [H ~&gt; m or kg m-2] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ustar</td><td>Wind friction velocity [Z T-1 ~&gt; m s-1]. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00479">479</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordtype">type</span>(wave_parameters_CS),  <span class="keywordtype">pointer</span>     :: CS<span class="comment">    !&lt; Wave parameter Control structure</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type),   <span class="keywordtype">intent(inout)</span> :: G<span class="comment">     !&lt; Grid structure</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type), <span class="keywordtype">intent(in)</span>    :: GV<span class="comment">    !&lt; Vertical grid structure</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type),   <span class="keywordtype">intent(in)</span>    :: US<span class="comment">    !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G),SZK_(G))</span>, &amp;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;       <span class="keywordtype">intent(in)</span>    :: h<span class="comment">     !&lt; Thickness [H ~&gt; m or kg m-2]</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G))</span>, &amp;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;       <span class="keywordtype">intent(in)</span>    :: ustar<span class="comment"> !&lt; Wind friction velocity [Z T-1 ~&gt; m s-1].</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="comment">! Local Variables</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="keywordtype">  real</span>    :: Top, MidPoint, Bottom, one_cm</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="keywordtype">  real</span>    :: DecayScale</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keywordtype">  real</span>    :: CMN_FAC, WN, UStokes</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="keywordtype">  real</span>    :: La</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordtype">integer</span> :: ii, jj, kk, b, iim1, jjm1</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  one_cm = 0.01*us%m_to_Z</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">! 1. If Test Profile Option is chosen</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="comment">!    Computing mid-point value from surface value and decay wavelength</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordflow">if</span> (wavemethod==testprof) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    decayscale = 4.*pi / tp_wvl <span class="comment">!4pi</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">do</span> ii = g%isdB,g%iedB</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="keywordflow">do</span> jj = g%jsd,g%jed</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        iim1 = max(1,ii-1)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        bottom = 0.0</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        midpoint = 0.0</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordflow">do</span> kk = 1,g%ke</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;          top = bottom</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;          midpoint = bottom - gv%H_to_Z*0.25*(h(ii,jj,kk)+h(iim1,jj,kk))</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;          bottom = bottom - gv%H_to_Z*0.5*(h(ii,jj,kk)+h(iim1,jj,kk))</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;          cs%Us_x(ii,jj,kk) = tp_stkx0*exp(midpoint*decayscale)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="keywordflow">        enddo</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">do</span> ii = g%isd,g%ied</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keywordflow">do</span> jj = g%jsdB,g%jedB</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        jjm1 = max(1,jj-1)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        bottom = 0.0</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        midpoint = 0.0</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">do</span> kk = 1,g%ke</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;          top = bottom</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;          midpoint = bottom - gv%H_to_Z*0.25*(h(ii,jj,kk)+h(ii,jjm1,kk))</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;          bottom = bottom - gv%H_to_Z*0.5*(h(ii,jj,kk)+h(ii,jjm1,kk))</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;          cs%Us_y(ii,jj,kk) = tp_stky0*exp(midpoint*decayscale)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="keywordflow">        enddo</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="comment">! 2. If Surface Bands is chosen</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">!    In wavenumber mode compute integral for layer averaged Stokes drift.</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="comment">!    In frequency mode compuate value at midpoint.</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">elseif</span> (wavemethod==surfbands) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    cs%Us_x(:,:,:) = 0.0</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    cs%Us_y(:,:,:) = 0.0</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    cs%Us0_x(:,:) = 0.0</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    cs%Us0_y(:,:) = 0.0</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">! Computing X direction Stokes drift</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">do</span> ii = g%isdB,g%iedB</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="keywordflow">do</span> jj = g%jsd,g%jed</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="comment">! 1. First compute the surface Stokes drift</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="comment">!    by integrating over the partitionas.</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keywordflow">do</span> b = 1,numbands</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;          <span class="keywordflow">if</span> (partitionmode==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="comment">! In wavenumber we are averaging over (small) level</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            cmn_fac = (1.0-exp(-one_cm*2.*cs%WaveNum_Cen(b))) / &amp;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                      (one_cm*2.*cs%WaveNum_Cen(b))</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;          <span class="keywordflow">elseif</span> (partitionmode==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;             <span class="comment">! In frequency we are not averaging over level and taking top</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            cmn_fac = 1.0</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="keywordflow">          endif</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;          cs%US0_x(ii,jj) = cs%US0_x(ii,jj) + cs%STKx0(ii,jj,b)*cmn_fac</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="keywordflow">        enddo</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="comment">! 2. Second compute the level averaged Stokes drift</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        bottom = 0.0</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordflow">do</span> kk = 1,g%ke</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;          top = bottom</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;          iim1 = max(ii-1,1)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;          midpoint = bottom - gv%H_to_Z*0.25*(h(ii,jj,kk)+h(iim1,jj,kk))</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;          bottom = bottom - gv%H_to_Z*0.5*(h(ii,jj,kk)+h(iim1,jj,kk))</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;          <span class="keywordflow">do</span> b = 1,numbands</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            <span class="keywordflow">if</span> (partitionmode==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;              <span class="comment">! In wavenumber we are averaging over level</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;              cmn_fac = (exp(top*2.*cs%WaveNum_Cen(b))-exp(bottom*2.*cs%WaveNum_Cen(b)))&amp;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                        / ((top-bottom)*(2.*cs%WaveNum_Cen(b)))</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <span class="keywordflow">elseif</span> (partitionmode==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;              <span class="keywordflow">if</span> (cs%StkLevelMode==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                <span class="comment">! Take the value at the midpoint</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                cmn_fac = exp(midpoint*2.*(2.*pi*cs%Freq_Cen(b)*us%T_to_s)**2/(us%L_to_Z**2*gv%g_Earth))</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;              <span class="keywordflow">elseif</span> (cs%StkLevelMode==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                <span class="comment">! Use a numerical integration and then</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                <span class="comment">! divide by layer thickness</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                wn = (2.*pi*cs%Freq_Cen(b)*us%T_to_s)**2 / (us%L_to_Z**2*gv%g_Earth) <span class="comment">!bgr bug-fix missing g</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                cmn_fac = (exp(2.*wn*top)-exp(2.*wn*bottom)) / (2.*wn*(top-bottom))</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="keywordflow">              endif</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            cs%US_x(ii,jj,kk) = cs%US_x(ii,jj,kk) + cs%STKx0(ii,jj,b)*cmn_fac</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="keywordflow">          enddo</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="keywordflow">        enddo</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="comment">! Computing Y direction Stokes drift</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">do</span> ii = g%isd,g%ied</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="keywordflow">do</span> jj = g%jsdB,g%jedB</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="comment">! Compute the surface values.</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordflow">do</span> b = 1,numbands</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;          <span class="keywordflow">if</span> (partitionmode==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <span class="comment">! In wavenumber we are averaging over (small) level</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            cmn_fac = (1.0-exp(-one_cm*2.*cs%WaveNum_Cen(b))) / &amp;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                      (one_cm*2.*cs%WaveNum_Cen(b))</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;          <span class="keywordflow">elseif</span> (partitionmode==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="comment">! In frequency we are not averaging over level and taking top</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            cmn_fac = 1.0</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="keywordflow">          endif</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;          cs%US0_y(ii,jj) = cs%US0_y(ii,jj) + cs%STKy0(ii,jj,b)*cmn_fac</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="keywordflow">        enddo</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="comment">! Compute the level averages.</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        bottom = 0.0</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordflow">do</span> kk = 1,g%ke</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;          top = bottom</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;          jjm1 = max(jj-1,1)</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;          midpoint = bottom - gv%H_to_Z*0.25*(h(ii,jj,kk)+h(ii,jjm1,kk))</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;          bottom = bottom - gv%H_to_Z*0.5*(h(ii,jj,kk)+h(ii,jjm1,kk))</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          <span class="keywordflow">do</span> b = 1,numbands</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <span class="keywordflow">if</span> (partitionmode==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;              <span class="comment">! In wavenumber we are averaging over level</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;              cmn_fac = (exp(top*2.*cs%WaveNum_Cen(b)) - &amp;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                         exp(bottom*2.*cs%WaveNum_Cen(b))) / &amp;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                        ((top-bottom)*(2.*cs%WaveNum_Cen(b)))</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="keywordflow">elseif</span> (partitionmode==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;              <span class="keywordflow">if</span> (cs%StkLevelMode==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                <span class="comment">! Take the value at the midpoint</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                cmn_fac = exp(midpoint*2.*(2.*pi*cs%Freq_Cen(b)*us%T_to_s)**2/(us%L_to_Z**2*gv%g_Earth))</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;              <span class="keywordflow">elseif</span> (cs%StkLevelMode==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                <span class="comment">! Use a numerical integration and then</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                <span class="comment">! divide by layer thickness</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                wn = (2.*pi*cs%Freq_Cen(b)*us%T_to_s)**2 / (us%L_to_Z**2*gv%g_Earth)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                cmn_fac = (exp(2.*wn*top)-exp(2.*wn*bottom)) / (2.*wn*(top-bottom))</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="keywordflow">              endif</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            cs%US_y(ii,jj,kk) = cs%US_y(ii,jj,kk) + cs%STKy0(ii,jj,b)*cmn_fac</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="keywordflow">          enddo</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="keywordflow">        enddo</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordflow">elseif</span> (wavemethod==dhh85) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">if</span> (.not.(staticwaves .and. dhh85_is_set)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keywordflow">do</span> ii = g%isdB,g%iedB</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">do</span> jj = g%jsd,g%jed</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;          bottom = 0.0</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;          <span class="keywordflow">do</span> kk = 1,g%ke</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            top = bottom</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            iim1 = max(ii-1,1)</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            midpoint = bottom - gv%H_to_Z*0.25*(h(ii,jj,kk)+h(iim1,jj,kk))</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            bottom = bottom - gv%H_to_Z*0.5*(h(ii,jj,kk)+h(iim1,jj,kk))</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="comment">!bgr note that this is using a u-point ii on h-point ustar</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            <span class="comment">!    this code has only been previous used for uniform</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <span class="comment">!    grid cases.  This needs fixed if DHH85 is used for non</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="comment">!    uniform cases.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="keyword">call </span>dhh85_mid(gv, us, midpoint, ustokes)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <span class="comment">! Putting into x-direction (no option for direction</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            cs%US_x(ii,jj,kk) = ustokes</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="keywordflow">          enddo</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="keywordflow">        enddo</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="keywordflow">do</span> ii = g%isd,g%ied</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="keywordflow">do</span> jj = g%jsdB,g%jedB</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;          bottom = 0.0</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;          <span class="keywordflow">do</span> kk=1, g%ke</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            top = bottom</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            jjm1 = max(jj-1,1)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            midpoint = bottom - gv%H_to_Z*0.25*(h(ii,jj,kk)+h(ii,jjm1,kk))</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            bottom = bottom - gv%H_to_Z*0.5*(h(ii,jj,kk)+h(ii,jjm1,kk))</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="comment">!bgr note that this is using a v-point jj on h-point ustar</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            <span class="comment">!    this code has only been previous used for uniform</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="comment">!    grid cases.  This needs fixed if DHH85 is used for non</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <span class="comment">!    uniform cases.</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            <span class="comment">! call DHH85_mid(GV, US, Midpoint, UStokes)</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <span class="comment">! Putting into x-direction, so setting y direction to 0</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            cs%US_y(ii,jj,kk) = 0.0 <span class="comment">!### Note that =0 should be =US - RWH</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="comment">!    bgr - see note above, but this is true</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            <span class="comment">!          if this is used for anything</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            <span class="comment">!          other than simple LES comparison</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keywordflow">          enddo</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="keywordflow">        enddo</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      dhh85_is_set = .true.</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  else<span class="comment">! Keep this else, fallback to 0 Stokes drift</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">do</span> kk= 1,g%ke</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <span class="keywordflow">do</span> ii = g%isdB,g%iedB</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">do</span> jj = g%jsd,g%jed</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;          cs%Us_x(ii,jj,kk) = 0.</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="keywordflow">        enddo</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="keywordflow">do</span> ii = g%isd,g%ied</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="keywordflow">do</span> jj = g%jsdB,g%jedB</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;          cs%Us_y(ii,jj,kk) = 0.</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="keywordflow">        enddo</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="comment">! Turbulent Langmuir number is computed here and available to use anywhere.</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="comment">! SL Langmuir number requires mixing layer depth, and therefore is computed</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="comment">! in the routine it is needed by (e.g. KPP or ePBL).</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keywordflow">do</span> ii = g%isc,g%iec</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">do</span> jj = g%jsc, g%jec</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      top = h(ii,jj,1)*gv%H_to_Z</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="keyword">call </span>get_langmuir_number( la, g, gv, us, top, ustar(ii,jj), ii, jj, &amp;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;             h(ii,jj,:),override_ma=.false.,waves=cs)</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      cs%La_turb(ii,jj) = la</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="keywordflow">  enddo</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="comment">! Output any desired quantities</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">if</span> (cs%id_surfacestokes_y&gt;0) &amp;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keyword">call </span>post_data(cs%id_surfacestokes_y, cs%us0_y, cs%diag)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordflow">if</span> (cs%id_surfacestokes_x&gt;0) &amp;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keyword">call </span>post_data(cs%id_surfacestokes_x, cs%us0_x, cs%diag)</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="keywordflow">if</span> (cs%id_3dstokes_y&gt;0) &amp;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keyword">call </span>post_data(cs%id_3dstokes_y, cs%us_y, cs%diag)</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keywordflow">if</span> (cs%id_3dstokes_x&gt;0) &amp;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keyword">call </span>post_data(cs%id_3dstokes_x, cs%us_x, cs%diag)</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordflow">if</span> (cs%id_La_turb&gt;0) &amp;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keyword">call </span>post_data(cs%id_La_turb, cs%La_turb, cs%diag)</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">dhh85</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00184">dhh85_is_set</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l01154">dhh85_mid()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00879">get_langmuir_number()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00141">numbands</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00145">partitionmode</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00186">pi</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00184">staticwaves</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">surfbands</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">testprof</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00182">tp_stkx0</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00182">tp_stky0</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00182">tp_wvl</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00131">wavemethod</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM_8F90_source.html#l00399">mom::step_mom()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_a42b769030d04a1c087e168de36ce7285_cgraph.svg" width="100%" height="486"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_a42b769030d04a1c087e168de36ce7285_icgraph.svg" width="460" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ad7c744e81248040ad319e0b608c52284"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7c744e81248040ad319e0b608c52284">&#9670;&nbsp;</a></span>update_surface_waves()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_wave_interface::update_surface_waves </td>
          <td>(</td>
          <td class="paramtype">type(ocean_grid_type), intent(inout)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(time_type), intent(in)&#160;</td>
          <td class="paramname"><em>Day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(time_type), intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__wave__interface_1_1wave__parameters__cs.html">wave_parameters_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>CS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine that handles updating of surface wave/Stokes drift related properties. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">cs</td><td>Wave parameter Control structure </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g</td><td>Grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>Vertical grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">day</td><td>Current model time </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>Timestep as a time-type </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00437">437</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordtype">type</span>(wave_parameters_CS), <span class="keywordtype">pointer</span>    :: CS<span class="comment">  !&lt; Wave parameter Control structure</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type), <span class="keywordtype">intent(inout)</span> :: G<span class="comment">   !&lt; Grid structure</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type), <span class="keywordtype">intent(in)</span>  :: GV<span class="comment">  !&lt; Vertical grid structure</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type),   <span class="keywordtype">intent(in)</span>  :: US<span class="comment">   !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordtype">type</span>(time_type),         <span class="keywordtype">intent(in)</span>  :: Day<span class="comment"> !&lt; Current model time</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordtype">type</span>(time_type),         <span class="keywordtype">intent(in)</span>  :: dt<span class="comment">  !&lt; Timestep as a time-type</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordtype">integer</span> :: ii, jj, kk, b</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keywordtype">type</span>(time_type) :: Day_Center</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="comment">! Computing central time of time step</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  day_center = day + dt/2</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordflow">if</span> (wavemethod == testprof) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">! Do nothing</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keywordflow">elseif</span> (wavemethod==surfbands) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">if</span> (datasource==dataovr) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keyword">call </span>surface_bands_by_data_override(day_center, g, gv, us, cs)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">elseif</span> (datasource==coupler) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="comment">! Reserve for coupler hooks</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">elseif</span> (datasource==input) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="keywordflow">do</span> b=1,numbands</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordflow">do</span> ii=g%isdB,g%iedB</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;          <span class="keywordflow">do</span> jj=g%jsd,g%jed</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            cs%STKx0(ii,jj,b) = cs%PrescribedSurfStkX(b)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="keywordflow">          enddo</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="keywordflow">        enddo</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">do</span> ii=g%isd,g%ied</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;          <span class="keywordflow">do</span> jj=g%jsdB, g%jedB</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            cs%STKY0(ii,jj,b) = cs%PrescribedSurfStkY(b)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="keywordflow">          enddo</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="keywordflow">        enddo</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">coupler</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">dataovr</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00149">datasource</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">input</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00141">numbands</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00709">surface_bands_by_data_override()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">surfbands</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">testprof</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00131">wavemethod</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__driver_8F90_source.html#l00001">mom_main()</a>, <a class="el" href="mom__ocean__model__mct_8F90_source.html#l00425">mom_ocean_model_mct::update_ocean_model()</a>, and <a class="el" href="mom__ocean__model__nuopc_8F90_source.html#l00431">mom_ocean_model_nuopc::update_ocean_model()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_ad7c744e81248040ad319e0b608c52284_cgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_ad7c744e81248040ad319e0b608c52284_icgraph.svg" width="400" height="170"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ae771d75c78a0370ad163edd5b1c19965"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae771d75c78a0370ad163edd5b1c19965">&#9670;&nbsp;</a></span>ust_2_u10_coare3p5()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_wave_interface::ust_2_u10_coare3p5 </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>USTair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>U10</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes wind speed from ustar_air based on COARE 3.5 Cd relationship Probably doesn't belong in this module, but it is used here to estimate wind speed for wind-wave relationships. Should be a fine way to estimate the neutral wind-speed as written here. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ustair</td><td>Wind friction velocity [m s-1] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">u10</td><td>10-m neutral wind speed [m s-1] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>vertical grid type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l01321">1321</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span>                    :: USTair<span class="comment"> !&lt; Wind friction velocity [m s-1]</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(out)</span>                   :: U10<span class="comment">    !&lt; 10-m neutral wind speed [m s-1]</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type), <span class="keywordtype">intent(in)</span> :: GV<span class="comment">     !&lt; vertical grid type</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type),   <span class="keywordtype">intent(in)</span> :: US<span class="comment">     !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160; </div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">parameter</span> :: vonkar = 0.4 <span class="comment">! Should access a get_param von karman</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">parameter</span> :: nu=1e-6 <span class="comment">! Should access a get_param air-viscosity</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="keywordtype">  real</span> :: z0sm, z0, z0rough, u10a, alpha, CD</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  <span class="keywordtype">integer</span> :: CT</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160; </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <span class="comment">! Uses empirical formula for z0 to convert ustar_air to u10 based on the</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="comment">!  COARE 3.5 paper (Edson et al., 2013)</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  <span class="comment">! alpha=m*U10+b</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <span class="comment">! Note in Edson et al. 2013, eq. 13 m is given as 0.017.  However,</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <span class="comment">! m=0.0017 reproduces the curve in their figure 6.</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  z0sm = 0.11 * nu * us%m_to_Z / ustair <span class="comment">!Compute z0smooth from ustar guess</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  u10 = ustair/sqrt(0.001)  <span class="comment">!Guess for u10</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  u10a = 1000</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160; </div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  ct=0</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="keywordflow">do</span> <span class="keywordflow">while</span> (abs(u10a/u10-1.) &gt; 0.001)</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    ct=ct+1</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    u10a = u10</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    alpha = min(0.028, 0.0017 * u10 - 0.005)</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    z0rough = alpha * (us%m_s_to_L_T*ustair)**2 / gv%g_Earth <span class="comment">! Compute z0rough from ustar guess</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    z0 = z0sm + z0rough</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    cd = ( vonkar / log(10.*us%m_to_Z / z0) )**2 <span class="comment">! Compute CD from derived roughness</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    u10 = ustair/sqrt(cd)  <span class="comment">! Compute new u10 from derived CD, while loop</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                           <span class="comment">! ends and checks for convergence...CT counter</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                           <span class="comment">! makes sure loop doesn&#39;t run away if function</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                           <span class="comment">! doesn&#39;t converge.  This code was produced offline</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                           <span class="comment">! and converged rapidly (e.g. 2 cycles)</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                           <span class="comment">! for ustar=0.0001:0.0001:10.</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">if</span> (ct&gt;20) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      u10 = ustair/sqrt(0.0015) <span class="comment">! I don&#39;t expect to get here, but just</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                              <span class="comment">!  in case it will output a reasonable value.</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="keywordflow">  enddo</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l01003">get_stokessl_lifoxkemper()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__wave__interface_ae771d75c78a0370ad163edd5b1c19965_icgraph.svg" width="100%" height="437"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a503d3ffc8d297c000dc72e2bfb7eb1b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a503d3ffc8d297c000dc72e2bfb7eb1b1">&#9670;&nbsp;</a></span>waves_end()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_wave_interface::waves_end </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__wave__interface_1_1wave__parameters__cs.html">wave_parameters_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>CS</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear pointers, deallocate memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cs</td><td>Control structure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l01367">1367</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="keywordtype">type</span>(wave_parameters_CS), <span class="keywordtype">pointer</span> :: CS<span class="comment"> !&lt; Control structure</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(cs%WaveNum_Cen)) <span class="keyword">deallocate</span>( cs%WaveNum_Cen )</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(cs%Freq_Cen))    <span class="keyword">deallocate</span>( cs%Freq_Cen )</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(cs%Us_x))        <span class="keyword">deallocate</span>( cs%Us_x )</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(cs%Us_y))        <span class="keyword">deallocate</span>( cs%Us_y )</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(cs%La_SL))       <span class="keyword">deallocate</span>( cs%La_SL )</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(cs%La_turb))     <span class="keyword">deallocate</span>( cs%La_turb )</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(cs%STKx0))       <span class="keyword">deallocate</span>( cs%STKx0 )</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(cs%STKy0))       <span class="keyword">deallocate</span>( cs%STKy0 )</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(cs%KvS))         <span class="keyword">deallocate</span>( cs%KvS )</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(cs%Us0_y))       <span class="keyword">deallocate</span>( cs%Us0_y )</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(cs%Us0_x))       <span class="keyword">deallocate</span>( cs%Us0_x )</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <span class="keyword">deallocate</span>( cs )</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <span class="keywordflow">return</span></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a38f7b8c357cf57847a9f9d6db72714b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38f7b8c357cf57847a9f9d6db72714b6">&#9670;&nbsp;</a></span>coupler</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter mom_wave_interface::coupler = 2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">177</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00437">update_surface_waves()</a>.</p>

</div>
</div>
<a id="a86e86d267dc214498fcd8088349d5d57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86e86d267dc214498fcd8088349d5d57">&#9670;&nbsp;</a></span>dataoverrideisinitialized</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical mom_wave_interface::dataoverrideisinitialized</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag for DataOverride Initialization. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000016">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00159">159</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keywordtype">logical</span> :: dataoverrideisinitialized<span class="comment"> !&lt; Flag for DataOverride Initialization</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00709">surface_bands_by_data_override()</a>.</p>

</div>
</div>
<a id="a0bb611ec4e2c3c121ed662e75f79bc3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bb611ec4e2c3c121ed662e75f79bc3d">&#9670;&nbsp;</a></span>dataovr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter mom_wave_interface::dataovr = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">177</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00437">update_surface_waves()</a>.</p>

</div>
</div>
<a id="af159120455d0f0afae144afc6a587561"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af159120455d0f0afae144afc6a587561">&#9670;&nbsp;</a></span>datasource</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer mom_wave_interface::datasource</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Integer that specifies where the Model Looks for Data Valid choices are: 1 - FMS DataOverride Routine 2 - Reserved For Coupler 3 - User input (fixed values, useful for 1d testing) </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000014">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00149">149</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keywordtype">integer</span> :: DataSource<span class="comment"> !&lt; Integer that specifies where the Model Looks for Data</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00437">update_surface_waves()</a>.</p>

</div>
</div>
<a id="aba8ac0d96a4986c68452e60e0843d635"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba8ac0d96a4986c68452e60e0843d635">&#9670;&nbsp;</a></span>dhh85</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter mom_wave_interface::dhh85 = 2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">177</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00879">get_langmuir_number()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00479">update_stokes_drift()</a>.</p>

</div>
</div>
<a id="a3f2253e4bf2bd73d0571270a3a464bb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f2253e4bf2bd73d0571270a3a464bb0">&#9670;&nbsp;</a></span>dhh85_is_set</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical mom_wave_interface::dhh85_is_set</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00184">184</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00479">update_stokes_drift()</a>.</p>

</div>
</div>
<a id="a2d13c62795b8407c1e9d3a3236b61100"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d13c62795b8407c1e9d3a3236b61100">&#9670;&nbsp;</a></span>input</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter mom_wave_interface::input = 3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">177</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00437">update_surface_waves()</a>.</p>

</div>
</div>
<a id="abc7136c467d4f1def8b2a32dfd335c3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc7136c467d4f1def8b2a32dfd335c3f">&#9670;&nbsp;</a></span>la_frachbl</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real mom_wave_interface::la_frachbl</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fraction of OSBL for averaging Langmuir number. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000017">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00163">163</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keywordtype">real</span> :: LA_FracHBL<span class="comment">         !&lt; Fraction of OSBL for averaging Langmuir number</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00879">get_langmuir_number()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00410">mom_wave_interface_init_lite()</a>.</p>

</div>
</div>
<a id="aab4d6b9f7e8823615c5ff975e0e40d22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab4d6b9f7e8823615c5ff975e0e40d22">&#9670;&nbsp;</a></span>la_misalignment</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical mom_wave_interface::la_misalignment = .false.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag to use misalignment in Langmuir number. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000018">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00165">165</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keywordtype">logical</span> :: LA_Misalignment = .false. <span class="comment">!&lt; Flag to use misalignment in Langmuir number</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00879">get_langmuir_number()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>.</p>

</div>
</div>
<a id="aaf3e043506139977c8fbdf2ae0180262"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf3e043506139977c8fbdf2ae0180262">&#9670;&nbsp;</a></span>lf17</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter mom_wave_interface::lf17 = 3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">177</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00879">get_langmuir_number()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00410">mom_wave_interface_init_lite()</a>.</p>

</div>
</div>
<a id="a55a67e21539483f4da8d0c8a33f36dc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55a67e21539483f4da8d0c8a33f36dc1">&#9670;&nbsp;</a></span>mdl</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=40) mom_wave_interface::mdl = &quot;MOM_wave_interface&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This module's name. </p>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00171">171</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">character(len=40)  :: mdl = &quot;MOM_wave_interface&quot; !&lt; This module&#39;s name.</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00410">mom_wave_interface_init_lite()</a>.</p>

</div>
</div>
<a id="afcedd2ab70e1d3b83e2802b31a9ae78c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcedd2ab70e1d3b83e2802b31a9ae78c">&#9670;&nbsp;</a></span>null_wavemethod</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter mom_wave_interface::null_wavemethod =-99</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">177</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00879">get_langmuir_number()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00410">mom_wave_interface_init_lite()</a>.</p>

</div>
</div>
<a id="ab514cf456c7f7953f4c304b941ff4c53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab514cf456c7f7953f4c304b941ff4c53">&#9670;&nbsp;</a></span>numbands</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, public mom_wave_interface::numbands =0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of wavenumber/frequency partitions to receive This needs to match the number of bands provided via either coupling or file. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000012">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00141">141</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">public</span> :: NumBands =0<span class="comment"> !&lt; Number of wavenumber/frequency partitions to receive</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00879">get_langmuir_number()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00709">surface_bands_by_data_override()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00479">update_stokes_drift()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00437">update_surface_waves()</a>.</p>

</div>
</div>
<a id="a91f7f974e91056f48cb04fb01b8f0d15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91f7f974e91056f48cb04fb01b8f0d15">&#9670;&nbsp;</a></span>partitionmode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, public mom_wave_interface::partitionmode</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Method for partition mode (meant to check input) 0 - wavenumbers 1 - frequencies. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000013">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00145">145</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">public</span> :: PartitionMode<span class="comment"> !&lt; Method for partition mode (meant to check input)</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00709">surface_bands_by_data_override()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00479">update_stokes_drift()</a>.</p>

</div>
</div>
<a id="a8bac1e68a6349358fbcb6d4586b96492"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bac1e68a6349358fbcb6d4586b96492">&#9670;&nbsp;</a></span>pi</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real mom_wave_interface::pi</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00186">186</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="keywordtype">real</span>    :: PI</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l01154">dhh85_mid()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l01003">get_stokessl_lifoxkemper()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00410">mom_wave_interface_init_lite()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00709">surface_bands_by_data_override()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00479">update_stokes_drift()</a>.</p>

</div>
</div>
<a id="a64f1c48b7cda4fbcf16d32efa64e7a65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64f1c48b7cda4fbcf16d32efa64e7a65">&#9670;&nbsp;</a></span>staticwaves</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical mom_wave_interface::staticwaves</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00184">184</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="keywordtype">logical</span> :: StaticWaves, DHH85_Is_Set</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00479">update_stokes_drift()</a>.</p>

</div>
</div>
<a id="a14b0aa4752008d5a52dbbb5e16751122"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14b0aa4752008d5a52dbbb5e16751122">&#9670;&nbsp;</a></span>surfbandfilename</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=40) mom_wave_interface::surfbandfilename</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Filename if using DataOverride. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000015">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00157">157</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">character(len=40)  :: SurfBandFileName !&lt; Filename if using DataOverride</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00709">surface_bands_by_data_override()</a>.</p>

</div>
</div>
<a id="aa3e3dcb7036fc3500e60304d1e632dab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3e3dcb7036fc3500e60304d1e632dab">&#9670;&nbsp;</a></span>surfbands</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter mom_wave_interface::surfbands = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">177</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00879">get_langmuir_number()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00479">update_stokes_drift()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00437">update_surface_waves()</a>.</p>

</div>
</div>
<a id="a9add067c6322c0d863978f0a1c13b205"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9add067c6322c0d863978f0a1c13b205">&#9670;&nbsp;</a></span>testprof</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter mom_wave_interface::testprof = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Undocumented parameters. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000019">Todo:</a></b></dt><dd>These module variables need to be documented as static/private variables or moved into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00177">177</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: TESTPROF = 0, surfbands = 1, &amp;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                      dhh85 = 2, lf17 = 3, null_wavemethod=-99, &amp;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                      dataovr = 1, coupler = 2, input = 3</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00879">get_langmuir_number()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00479">update_stokes_drift()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00437">update_surface_waves()</a>.</p>

</div>
</div>
<a id="ad270c0cfd5b154a7c79856dcd65f9b7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad270c0cfd5b154a7c79856dcd65f9b7d">&#9670;&nbsp;</a></span>tp_stkx0</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real mom_wave_interface::tp_stkx0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00182">182</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keywordtype">Real</span>    :: TP_STKX0, TP_STKY0, TP_WVL</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00479">update_stokes_drift()</a>.</p>

</div>
</div>
<a id="a1b1910008053811657e7b0a62bf7b953"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b1910008053811657e7b0a62bf7b953">&#9670;&nbsp;</a></span>tp_stky0</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real mom_wave_interface::tp_stky0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00182">182</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00479">update_stokes_drift()</a>.</p>

</div>
</div>
<a id="ac99ef0805fd66b9e7b96ee6c21c819e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac99ef0805fd66b9e7b96ee6c21c819e5">&#9670;&nbsp;</a></span>tp_wvl</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real mom_wave_interface::tp_wvl</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00182">182</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00479">update_stokes_drift()</a>.</p>

</div>
</div>
<a id="ae6655758dbc674bafd3a5f0a51176e80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6655758dbc674bafd3a5f0a51176e80">&#9670;&nbsp;</a></span>waveage</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real mom_wave_interface::waveage</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00185">185</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="keywordtype">real</span>    :: WaveAge, WaveWind</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l01154">dhh85_mid()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>.</p>

</div>
</div>
<a id="a4d5d36a94c630a4f9e181d8171fc2a35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d5d36a94c630a4f9e181d8171fc2a35">&#9670;&nbsp;</a></span>waveagepeakfreq</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical mom_wave_interface::waveagepeakfreq</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00183">183</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keywordtype">logical</span> :: WaveAgePeakFreq <span class="comment">! Flag to use W</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l01154">dhh85_mid()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>.</p>

</div>
</div>
<a id="ad81e4ea1a9510437272f5871af6993ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad81e4ea1a9510437272f5871af6993ad">&#9670;&nbsp;</a></span>wavemethod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mom_wave_interface::wavemethod =-99</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00131">131</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keywordtype">integer</span> :: WaveMethod=-99<span class="comment"> !&lt; Options for including wave information</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l00879">get_langmuir_number()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00410">mom_wave_interface_init_lite()</a>, <a class="el" href="MOM__wave__interface_8F90_source.html#l00479">update_stokes_drift()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00437">update_surface_waves()</a>.</p>

</div>
</div>
<a id="a8e5650b8187abcc67bd0e2787322ac75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e5650b8187abcc67bd0e2787322ac75">&#9670;&nbsp;</a></span>wavewind</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real mom_wave_interface::wavewind</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options for including wave information Valid (tested) choices are: 0 - Test Profile 1 - Surface Stokes Drift Bands 2 - DHH85 3 - LF17 -99 - No waves computed, but empirical Langmuir number used. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Module variable! Move into a control structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MOM__wave__interface_8F90_source.html#l00185">185</a> of file <a class="el" href="MOM__wave__interface_8F90_source.html">MOM_wave_interface.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__wave__interface_8F90_source.html#l01154">dhh85_mid()</a>, and <a class="el" href="MOM__wave__interface_8F90_source.html#l00193">mom_wave_interface_init()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemom__wave__interface.html">mom_wave_interface</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
