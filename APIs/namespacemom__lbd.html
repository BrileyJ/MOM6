<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MOM6: mom_lbd Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MOM6
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacemom__lbd.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">mom_lbd Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h1><a class="anchor" id="section_LBD"></a>
The Lateral Boundary Diffusion (LBD) framework</h1>
<p>The LBD framework accounts for the effects of diabatic mesoscale fluxes within surface and bottom boundary layers. Unlike the equivalent adiabatic fluxes, which is applied along neutral density surfaces, LBD is purely horizontal.</p>
<p>The bottom boundary layer fluxes remain to be implemented, although most of the steps needed to do so have already been added and tested.</p>
<p>Boundary lateral diffusion can be applied using one of the three methods:</p>
<ul>
<li><a class="el" href="namespacemom__lbd.html#section_method1">Method #1: Bulk layer</a> (default);</li>
<li><a class="el" href="namespacemom__lbd.html#section_method2">Method #2: Along layer</a>;</li>
</ul>
<p>A brief summary of these methods is provided below.</p>
<h2><a class="anchor" id="section_method1"></a>
Bulk layer approach (Method #1)</h2>
<p>Apply the lateral boundary diffusive fluxes calculated from a 'bulk model'.This is a lower order representation (Kraus-Turner like approach) which assumes that eddies are acting along well mixed layers (i.e., eddies do not know care about vertical tracer gradients within the boundary layer).</p>
<p>Step #1: compute vertical indices containing boundary layer (boundary_k_range). For the TOP boundary layer, these are:</p>
<p>k_top, k_bot, zeta_top, zeta_bot</p>
<p>Step #2: compute bulk averages (thickness weighted) tracer averages (phi_L and phi_R), then calculate the bulk diffusive flux (F_{bulk}):</p>
<p class="formulaDsp">
\[ F_{bulk} = -KHTR \times h_{eff} \times (\phi_R - \phi_L), \]
</p>
<p> where h_eff is the <a class="el" href="namespacemom__lbd.html#section_harmonic_mean">harmonic mean</a> of the boundary layer depth in the left and right columns ( </p><p class="formulaDsp">
\[ HBL_L \]
</p>
<p> and </p><p class="formulaDsp">
\[ HBL_R \]
</p>
<p>, respectively).</p>
<p>Step #3: decompose F_bulk onto individual layers:</p>
<p class="formulaDsp">
\[ F_{layer}(k) = F_{bulk} \times h_{frac}(k) , \]
</p>
<p>where h_{frac} is</p>
<p class="formulaDsp">
\[ h_{frac}(k) = h_u(k) \times \frac{1}{\sum(h_u)}. \]
</p>
<p>h_u is the <a class="el" href="namespacemom__lbd.html#section_harmonic_mean">harmonic mean</a> of thicknesses at each layer. Special care (layer reconstruction) must be taken at k_min = min(k_botL, k_bot_R).</p>
<p>Step #4: limit the tracer flux so that 1) only down-gradient fluxes are applied, and 2) the flux cannot be larger than F_max, which is defined using the tracer gradient:</p>
<p class="formulaDsp">
\[ F_{max} = -0.2 \times [(V_R(k) \times \phi_R(k)) - (V_L(k) \times \phi_L(k))], \]
</p>
<p> where V is the cell volume. Why 0.2? t=0 t=inf 0 .2 0 1 0 .2.2.2 0 .2</p>
<h2><a class="anchor" id="section_method2"></a>
Along layer approach (Method #2)</h2>
<p>This is a more straight forward method where diffusion is applied layer by layer using only information from neighboring cells.</p>
<p>Step #1: compute vertical indices containing boundary layer (boundary_k_range). For the TOP boundary layer, these are:</p>
<p>k_top, k_bot, zeta_top, zeta_bot</p>
<p>Step #2: calculate the diffusive flux at each layer:</p>
<p class="formulaDsp">
\[ F_{k} = -KHTR \times h_{eff}(k) \times (\phi_R(k) - \phi_L(k)), \]
</p>
<p> where h_eff is the <a class="el" href="namespacemom__lbd.html#section_harmonic_mean">harmonic mean</a> of the layer thickness in the left and right columns. Special care (layer reconstruction) must be taken at k_min = min(k_botL, k_bot_R). This method does not require a limiter since KHTR is already limted based on a diffusive CFL condition prior to the call of this module.</p>
<h2><a class="anchor" id="section_harmonic_mean"></a>
Harmonic Mean</h2>
<p>The harmonic mean (HM) betwen h1 and h2 is defined as:</p>
<p class="formulaDsp">
\[ HM = \frac{2 \times h1 \times h2}{h1 + h2} \]
</p>
 </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemom__lbd.html">mom_lbd</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
