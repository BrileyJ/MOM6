<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MOM6: phillips_initialization Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MOM6
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacephillips__initialization.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">phillips_initialization Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Initialization for the "Phillips" channel configuration. </p>
<p>By Robert Hallberg, April 1994 - June 2002</p>
<p>This subroutine initializes the fields for the simulations. The one argument passed to initialize, Time, is set to the current time of the simulation. The fields which are initialized here are: u - Zonal velocity [m s-1]. v - Meridional velocity [m s-1]. h - Layer thickness in m. (Must be positive.) D - Basin depth in m. (Must be positive.) f - The Coriolis parameter [s-1]. g - The reduced gravity at each interface [m s-2] Rlay - Layer potential density (coordinate variable) [kg m-3]. If ENABLE_THERMODYNAMICS is defined: T - Temperature [degC]. S - Salinity [ppt]. If SPONGE is defined: A series of subroutine calls are made to set up the damping rates and reference profiles for all variables that are damped in the sponge. Any user provided tracer code is also first linked through this subroutine.</p>
<p>Forcing-related fields (taux, tauy, buoy, ustar, etc.) are set in <a class="el" href="MOM__surface__forcing_8F90.html">MOM_surface_forcing.F90</a>.</p>
<p>These variables are all set in the set of subroutines (in this file) Phillips_initialize_thickness, Phillips_initialize_velocity, Phillips_initialize_topography and Phillips_initialize_sponges that seet up fields that are specific to the Phillips instability test case. </p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a9b205a2cb366a24e22b6b3c84e5e3302"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacephillips__initialization.html#a9b205a2cb366a24e22b6b3c84e5e3302">phillips_initialize_thickness</a> (h, G, GV, US, param_file, just_read_params)</td></tr>
<tr class="memdesc:a9b205a2cb366a24e22b6b3c84e5e3302"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the thickness field for the Phillips model test case.  <a href="namespacephillips__initialization.html#a9b205a2cb366a24e22b6b3c84e5e3302">More...</a><br /></td></tr>
<tr class="separator:a9b205a2cb366a24e22b6b3c84e5e3302"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a328589bb31bd695e9d1a0ed906f0f808"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacephillips__initialization.html#a328589bb31bd695e9d1a0ed906f0f808">phillips_initialize_velocity</a> (u, v, G, GV, US, param_file, just_read_params)</td></tr>
<tr class="memdesc:a328589bb31bd695e9d1a0ed906f0f808"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the velocity fields for the Phillips model test case.  <a href="namespacephillips__initialization.html#a328589bb31bd695e9d1a0ed906f0f808">More...</a><br /></td></tr>
<tr class="separator:a328589bb31bd695e9d1a0ed906f0f808"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1b07586a1ded5ee253cba3c67d0249a"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacephillips__initialization.html#ac1b07586a1ded5ee253cba3c67d0249a">phillips_initialize_sponges</a> (G, GV, US, tv, param_file, CSp, h)</td></tr>
<tr class="memdesc:ac1b07586a1ded5ee253cba3c67d0249a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the the inverse restoration time (Idamp), and the values towards which the interface heights and an arbitrary number of tracers should be restored within each sponge for the Phillips model test case.  <a href="namespacephillips__initialization.html#ac1b07586a1ded5ee253cba3c67d0249a">More...</a><br /></td></tr>
<tr class="separator:ac1b07586a1ded5ee253cba3c67d0249a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88d1be48e4a24bdcefce251a16a0ea10"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacephillips__initialization.html#a88d1be48e4a24bdcefce251a16a0ea10">sech</a> (x)</td></tr>
<tr class="memdesc:a88d1be48e4a24bdcefce251a16a0ea10"><td class="mdescLeft">&#160;</td><td class="mdescRight">sech calculates the hyperbolic secant.  <a href="namespacephillips__initialization.html#a88d1be48e4a24bdcefce251a16a0ea10">More...</a><br /></td></tr>
<tr class="separator:a88d1be48e4a24bdcefce251a16a0ea10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99b5e25a77486b3004be63895ab57b73"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacephillips__initialization.html#a99b5e25a77486b3004be63895ab57b73">phillips_initialize_topography</a> (D, G, param_file, max_depth, US)</td></tr>
<tr class="memdesc:a99b5e25a77486b3004be63895ab57b73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize topography.  <a href="namespacephillips__initialization.html#a99b5e25a77486b3004be63895ab57b73">More...</a><br /></td></tr>
<tr class="separator:a99b5e25a77486b3004be63895ab57b73"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ac1b07586a1ded5ee253cba3c67d0249a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1b07586a1ded5ee253cba3c67d0249a">&#9670;&nbsp;</a></span>phillips_initialize_sponges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public phillips_initialization::phillips_initialize_sponges </td>
          <td>(</td>
          <td class="paramtype">type(ocean_grid_type), intent(in)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(thermo_var_ptrs), intent(in)&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(param_file_type), intent(in)&#160;</td>
          <td class="paramname"><em>param_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(sponge_cs), pointer&#160;</td>
          <td class="paramname"><em>CSp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( g %isd: g %ied, g %jsd: g %jed, gv %ke), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up the the inverse restoration time (Idamp), and the values towards which the interface heights and an arbitrary number of tracers should be restored within each sponge for the Phillips model test case. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>The ocean's grid structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>Vertical grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tv</td><td>A structure containing pointers to any available thermodynamic fields, potential temperature and salinity or mixed layer density. Absent fields have NULL ptrs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param_file</td><td>A structure indicating the open file to parse for model parameter values. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">csp</td><td>A pointer that is set to point to the control structure for the sponge module. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Thickness field [H ~&gt; m or kg m-2]. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Phillips__initialization_8F90_source.html#l00202">202</a> of file <a class="el" href="Phillips__initialization_8F90_source.html">Phillips_initialization.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type), <span class="keywordtype">intent(in)</span> :: G<span class="comment">    !&lt; The ocean&#39;s grid structure.</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type), <span class="keywordtype">intent(in)</span> :: GV<span class="comment"> !&lt; Vertical grid structure</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type), <span class="keywordtype">intent(in)</span> :: US<span class="comment">   !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordtype">type</span>(thermo_var_ptrs), <span class="keywordtype">intent(in)</span> :: tv<span class="comment">   !&lt; A structure containing pointers</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">                                            !! to any available thermodynamic</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">                                            !! fields, potential temperature and</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">                                            !! salinity or mixed layer density.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">                                            !! Absent fields have NULL ptrs.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordtype">type</span>(param_file_type), <span class="keywordtype">intent(in)</span> :: param_file<span class="comment"> !&lt; A structure indicating the</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">                                            !! open file to parse for model</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">                                            !! parameter values.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordtype">type</span>(sponge_CS),   <span class="keywordtype">pointer</span>    :: CSp<span class="comment">      !&lt; A pointer that is set to point to</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">                                            !! the control structure for the</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">                                            !! sponge module.</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G),SZK_(GV))</span> :: h<span class="comment"> !&lt; Thickness field [H ~&gt; m or kg m-2].</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="keywordtype">  real</span> :: eta0(SZK_(G)+1)   <span class="comment">! The 1-d nominal positions of the interfaces.</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keywordtype">  real</span> :: eta(SZI_(G),SZJ_(G),SZK_(G)+1) <span class="comment">! A temporary array for eta [Z ~&gt; m].</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keywordtype">  real</span> :: temp(SZI_(G),SZJ_(G),SZK_(G))  <span class="comment">! A temporary array for other variables.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keywordtype">  real</span> :: Idamp(SZI_(G),SZJ_(G))    <span class="comment">! The inverse damping rate [s-1].</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="keywordtype">  real</span> :: eta_im(SZJ_(G),SZK_(G)+1) <span class="comment">! A temporary array for zonal-mean eta [Z ~&gt; m].</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="keywordtype">  real</span> :: Idamp_im(SZJ_(G))         <span class="comment">! The inverse zonal-mean damping rate [s-1].</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="keywordtype">  real</span> :: damp_rate    <span class="comment">! The inverse zonal-mean damping rate [s-1].</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="keywordtype">  real</span> :: jet_width    <span class="comment">! The width of the zonal mean jet, in km.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="keywordtype">  real</span> :: jet_height   <span class="comment">! The interface height scale associated with the zonal-mean jet [Z ~&gt; m].</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keywordtype">  real</span> :: y_2          <span class="comment">! The y-position relative to the channel center, in km.</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="keywordtype">  real</span> :: half_strat   <span class="comment">! The fractional depth where the straficiation is centered [nondim].</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="keywordtype">  real</span> :: half_depth   <span class="comment">! The depth where the stratification is centered [Z ~&gt; m].</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordtype">character(len=40)</span>  :: mdl = <span class="stringliteral">&quot;Phillips_initialize_sponges&quot;</span> <span class="comment">! This subroutine&#39;s name.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordtype">integer</span> :: i, j, k, is, ie, js, je, isd, ied, jsd, jed, nz</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordtype">logical</span>, <span class="keywordtype">save</span> :: first_call = .true.</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  is = g%isc ; ie = g%iec ; js = g%jsc ; je = g%jec ; nz = g%ke</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  isd = g%isd ; ied = g%ied ; jsd = g%jsd ; jed = g%jed</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  eta(:,:,:) = 0.0 ; temp(:,:,:) = 0.0 ; idamp(:,:) = 0.0</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  eta_im(:,:) = 0.0 ; idamp_im(:) = 0.0</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">if</span> (first_call) <span class="keyword">call </span>log_version(param_file, mdl, version)</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  first_call = .false.</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;HALF_STRAT_DEPTH&quot;</span>, half_strat, &amp;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                 <span class="stringliteral">&quot;The fractional depth where the stratificaiton is centered.&quot;</span>, &amp;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                 units=<span class="stringliteral">&quot;nondim&quot;</span>, default = 0.5)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;SPONGE_RATE&quot;</span>, damp_rate, &amp;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                 <span class="stringliteral">&quot;The rate at which the zonal-mean sponges damp.&quot;</span>, units=<span class="stringliteral">&quot;s-1&quot;</span>, &amp;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                 default = 1.0/(10.0*86400.0))</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;JET_WIDTH&quot;</span>, jet_width, &amp;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                 <span class="stringliteral">&quot;The width of the zonal-mean jet.&quot;</span>, units=<span class="stringliteral">&quot;km&quot;</span>, &amp;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                 fail_if_missing=.true.)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;JET_HEIGHT&quot;</span>, jet_height, &amp;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                 <span class="stringliteral">&quot;The interface height scale associated with the &quot;</span>//&amp;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                 <span class="stringliteral">&quot;zonal-mean jet.&quot;</span>, units=<span class="stringliteral">&quot;m&quot;</span>, scale=us%m_to_Z, &amp;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                 fail_if_missing=.true.)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  half_depth = g%max_depth*half_strat</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  eta0(1) = 0.0 ; eta0(nz+1) = -g%max_depth</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordflow">do</span> k=2,1+nz/2 ; eta0(k) = -half_depth*(2.0*(k-1)/real(nz)) ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordflow">do</span> k=2+nz/2,nz+1</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    eta0(k) = -g%max_depth - 2.0*(g%max_depth-half_depth) * ((k-(nz+1))/real(nz))</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keywordflow">  enddo</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordflow">do</span> j=js,je</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    idamp_im(j) = damp_rate</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    eta_im(j,1) = 0.0 ; eta_im(j,nz+1) = -g%max_depth</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="keywordflow">  enddo</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">do</span> k=2,nz ; <span class="keywordflow">do</span> j=js,je</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    y_2 = g%geoLatT(is,j) - g%south_lat - 0.5*g%len_lat</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    eta_im(j,k) = eta0(k) + jet_height * tanh(y_2 / jet_width)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">!         jet_height * atan(y_2 / jet_width)</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span> (eta_im(j,k) &gt; 0.0) eta_im(j,k) = 0.0</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">if</span> (eta_im(j,k) &lt; -g%max_depth) eta_im(j,k) = -g%max_depth</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="keywordflow">  enddo</span> ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keyword">call </span>initialize_sponge(idamp, eta, g, param_file, csp, gv, idamp_im, eta_im)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MOM__sponge_8F90_source.html#l00090">mom_sponge::initialize_sponge()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__state__initialization_8F90_source.html#l00125">mom_state_initialization::mom_initialize_state()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacephillips__initialization_ac1b07586a1ded5ee253cba3c67d0249a_cgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacephillips__initialization_ac1b07586a1ded5ee253cba3c67d0249a_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a9b205a2cb366a24e22b6b3c84e5e3302"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b205a2cb366a24e22b6b3c84e5e3302">&#9670;&nbsp;</a></span>phillips_initialize_thickness()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public phillips_initialization::phillips_initialize_thickness </td>
          <td>(</td>
          <td class="paramtype">real, dimension( g %isd: g %ied, g %jsd: g %jed, gv %ke), intent(out)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(ocean_grid_type), intent(in)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(param_file_type), intent(in)&#160;</td>
          <td class="paramname"><em>param_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>just_read_params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the thickness field for the Phillips model test case. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>The ocean's grid structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>The ocean's vertical grid structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">h</td><td>The thickness that is being initialized [H ~&gt; m or kg m-2] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param_file</td><td>A structure indicating the open file to parse for model parameter values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">just_read_params</td><td>If present and true, this call will only read parameters without changing h. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Phillips__initialization_8F90_source.html#l00039">39</a> of file <a class="el" href="Phillips__initialization_8F90_source.html">Phillips_initialization.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type),   <span class="keywordtype">intent(in)</span>  :: G<span class="comment">          !&lt; The ocean&#39;s grid structure.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type), <span class="keywordtype">intent(in)</span>  :: GV<span class="comment">         !&lt; The ocean&#39;s vertical grid structure.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type),   <span class="keywordtype">intent(in)</span>  :: US<span class="comment">         !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJ_(G),SZK_(GV))</span>, &amp;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                           <span class="keywordtype">intent(out)</span> :: h<span class="comment">          !&lt; The thickness that is being initialized [H ~&gt; m or kg m-2]</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">type</span>(param_file_type),   <span class="keywordtype">intent(in)</span>  :: param_file<span class="comment"> !&lt; A structure indicating the open file</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">                                                     !! to parse for model parameter values.</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">logical</span>,       <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: just_read_params<span class="comment"> !&lt; If present and true, this call will</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">                                                     !! only read parameters without changing h.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keywordtype">  real</span> :: eta0(SZK_(G)+1)   <span class="comment">! The 1-d nominal positions of the interfaces [Z ~&gt; m]</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keywordtype">  real</span> :: eta_im(SZJ_(G),SZK_(G)+1) <span class="comment">! A temporary array for zonal-mean eta [Z ~&gt; m]</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keywordtype">  real</span> :: eta1D(SZK_(G)+1)  <span class="comment">! Interface height relative to the sea surface, positive upward [Z ~&gt; m]</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keywordtype">  real</span> :: jet_width         <span class="comment">! The width of the zonal-mean jet [km]</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keywordtype">  real</span> :: jet_height        <span class="comment">! The interface height scale associated with the zonal-mean jet [Z ~&gt; m]</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keywordtype">  real</span> :: y_2             <span class="comment">! The y-position relative to the center of the domain [km]</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keywordtype">  real</span> :: half_strat      <span class="comment">! The fractional depth where the stratification is centered [nondim]</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keywordtype">  real</span> :: half_depth      <span class="comment">! The depth where the stratification is centered [Z ~&gt; m]</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">logical</span> :: just_read    <span class="comment">! If true, just read parameters but set nothing.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">character(len=40)</span>  :: mdl = <span class="stringliteral">&quot;Phillips_initialize_thickness&quot;</span> <span class="comment">! This subroutine&#39;s name.</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordtype">integer</span> :: i, j, k, is, ie, js, je, isd, ied, jsd, jed, nz</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  is = g%isc ; ie = g%iec ; js = g%jsc ; je = g%jec ; nz = g%ke</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  isd = g%isd ; ied = g%ied ; jsd = g%jsd ; jed = g%jed</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  eta_im(:,:) = 0.0</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  just_read = .false. ; <span class="keywordflow">if</span> (<span class="keyword">present</span>(just_read_params)) just_read = just_read_params</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">if</span> (.not.just_read) <span class="keyword">call </span>log_version(param_file, mdl, version)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;HALF_STRAT_DEPTH&quot;</span>, half_strat, &amp;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                 <span class="stringliteral">&quot;The fractional depth where the stratification is centered.&quot;</span>, &amp;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                 units=<span class="stringliteral">&quot;nondim&quot;</span>, default = 0.5, do_not_log=just_read)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;JET_WIDTH&quot;</span>, jet_width, &amp;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                 <span class="stringliteral">&quot;The width of the zonal-mean jet.&quot;</span>, units=<span class="stringliteral">&quot;km&quot;</span>, &amp;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                 fail_if_missing=.not.just_read, do_not_log=just_read)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;JET_HEIGHT&quot;</span>, jet_height, &amp;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                 <span class="stringliteral">&quot;The interface height scale associated with the &quot;</span>//&amp;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                 <span class="stringliteral">&quot;zonal-mean jet.&quot;</span>, units=<span class="stringliteral">&quot;m&quot;</span>, scale=us%m_to_Z, &amp;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                 fail_if_missing=.not.just_read, do_not_log=just_read)</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">if</span> (just_read) <span class="keywordflow">return</span> <span class="comment">! All run-time parameters have been read, so return.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  half_depth = g%max_depth*half_strat</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  eta0(1) = 0.0 ; eta0(nz+1) = -g%max_depth</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">do</span> k=2,1+nz/2 ; eta0(k) = -half_depth*(2.0*(k-1)/real(nz)) ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">do</span> k=2+nz/2,nz+1</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    eta0(k) = -g%max_depth - 2.0*(g%max_depth-half_depth) * ((k-(nz+1))/real(nz))</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keywordflow">  enddo</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">do</span> j=js,je</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    eta_im(j,1) = 0.0 ; eta_im(j,nz+1) = -g%max_depth</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keywordflow">  enddo</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">do</span> k=2,nz ; <span class="keywordflow">do</span> j=js,je</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    y_2 = g%geoLatT(is,j) - g%south_lat - 0.5*g%len_lat</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    eta_im(j,k) = eta0(k) + jet_height * tanh(y_2 / jet_width)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                <span class="comment">! or  ... + jet_height * atan(y_2 / jet_width)</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> (eta_im(j,k) &gt; 0.0) eta_im(j,k) = 0.0</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span> (eta_im(j,k) &lt; -g%max_depth) eta_im(j,k) = -g%max_depth</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keywordflow">  enddo</span> ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">do</span> j=js,je ; <span class="keywordflow">do</span> i=is,ie</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">!   This sets the initial thickness in [H ~&gt; m or kg m-2] of the layers.  The</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">! thicknesses are set to insure that: 1. each layer is at least an Angstrom thick, and</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">! 2. the interfaces are where they should be based on the resting depths and interface</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">!    height perturbations, as long at this doesn&#39;t interfere with 1.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    eta1d(nz+1) = -g%bathyT(i,j)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">do</span> k=nz,1,-1</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      eta1d(k) = eta_im(j,k)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">if</span> (eta1d(k) &lt; (eta1d(k+1) + gv%Angstrom_Z)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        eta1d(k) = eta1d(k+1) + gv%Angstrom_Z</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        h(i,j,k) = gv%Angstrom_H</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        h(i,j,k) = gv%Z_to_H * (eta1d(k) - eta1d(k+1))</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keywordflow">  enddo</span> ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a99b5e25a77486b3004be63895ab57b73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99b5e25a77486b3004be63895ab57b73">&#9670;&nbsp;</a></span>phillips_initialize_topography()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public phillips_initialization::phillips_initialize_topography </td>
          <td>(</td>
          <td class="paramtype">real, dimension(g%isd:g%ied,g%jsd:g%jed), intent(out)&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(dyn_horgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(param_file_type), intent(in)&#160;</td>
          <td class="paramname"><em>param_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>max_depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in), optional&#160;</td>
          <td class="paramname"><em>US</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize topography. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>The dynamic horizontal grid type </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">d</td><td>Ocean bottom depth in m or Z if US is present </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param_file</td><td>Parameter file structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_depth</td><td>Maximum model depth in the units of D </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Phillips__initialization_8F90_source.html#l00297">297</a> of file <a class="el" href="Phillips__initialization_8F90_source.html">Phillips_initialization.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordtype">type</span>(dyn_horgrid_type),          <span class="keywordtype">intent(in)</span>  :: G<span class="comment"> !&lt; The dynamic horizontal grid type</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(G%isd:G%ied,G%jsd:G%jed)</span>, &amp;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                   <span class="keywordtype">intent(out)</span> :: D<span class="comment"> !&lt; Ocean bottom depth in m or Z if US is present</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordtype">type</span>(param_file_type),           <span class="keywordtype">intent(in)</span>  :: param_file<span class="comment"> !&lt; Parameter file structure</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keywordtype">  real</span>,                            <span class="keywordtype">intent(in)</span>  :: max_depth<span class="comment"> !&lt; Maximum model depth in the units of D</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type), <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: US<span class="comment"> !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keywordtype">  real</span> :: m_to_Z  <span class="comment">! A dimensional rescaling factor.</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keywordtype">  real</span> :: PI, Htop, Wtop, Ltop, offset, dist</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="keywordtype">  real</span> :: x1, x2, x3, x4, y1, y2</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordtype">integer</span> :: i,j,is,ie,js,je</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordtype">character(len=40)</span>  :: mdl = <span class="stringliteral">&quot;Phillips_initialize_topography&quot;</span> <span class="comment">! This subroutine&#39;s name.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  is = g%isc ; ie = g%iec ; js = g%jsc ; je = g%jec</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  pi = 4.0*atan(1.0)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  m_to_z = 1.0 ; <span class="keywordflow">if</span> (<span class="keyword">present</span>(us)) m_to_z = us%m_to_Z</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;PHILLIPS_HTOP&quot;</span>, htop, &amp;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                 <span class="stringliteral">&quot;The maximum height of the topography.&quot;</span>, units=<span class="stringliteral">&quot;m&quot;</span>, scale=m_to_z, &amp;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                 fail_if_missing=.true.)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">! Htop=0.375*max_depth     ! max height of topog. above max_depth</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  wtop = 0.5*g%len_lat     <span class="comment">! meridional width of drake and mount</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  ltop = 0.25*g%len_lon    <span class="comment">! zonal width of topographic features</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  offset = 0.1*g%len_lat   <span class="comment">! meridional offset from center</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  dist = 0.333*g%len_lon   <span class="comment">! distance between drake and mount</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                           <span class="comment">! should be longer than Ltop/2</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  y1=g%south_lat+0.5*g%len_lat+offset-0.5*wtop; y2=y1+wtop</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  x1=g%west_lon+0.1*g%len_lon; x2=x1+ltop; x3=x1+dist; x4=x3+3.0/2.0*ltop</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordflow">do</span> i=is,ie ; <span class="keywordflow">do</span> j=js,je</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    d(i,j)=0.0</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">if</span> (g%geoLonT(i,j)&gt;x1 .and. g%geoLonT(i,j)&lt;x2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      d(i,j) = htop*sin(pi*(g%geoLonT(i,j)-x1)/(x2-x1))**2</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="keywordflow">if</span> (g%geoLatT(i,j)&gt;y1 .and. g%geoLatT(i,j)&lt;y2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;         d(i,j) = d(i,j)*(1-sin(pi*(g%geoLatT(i,j)-y1)/(y2-y1))**2)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">elseif</span> (g%geoLonT(i,j)&gt;x3 .and. g%geoLonT(i,j)&lt;x4 .and. &amp;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;             g%geoLatT(i,j)&gt;y1 .and. g%geoLatT(i,j)&lt;y2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      d(i,j) = 2.0/3.0*htop*sin(pi*(g%geoLonT(i,j)-x3)/(x4-x3))**2 &amp;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                   *sin(pi*(g%geoLatT(i,j)-y1)/(y2-y1))**2</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    d(i,j) = max_depth - d(i,j)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="keywordflow">  enddo</span> ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="MOM__fixed__initialization_8F90_source.html#l00174">mom_fixed_initialization::mom_initialize_topography()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacephillips__initialization_a99b5e25a77486b3004be63895ab57b73_icgraph.svg" width="100%" height="388"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a328589bb31bd695e9d1a0ed906f0f808"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a328589bb31bd695e9d1a0ed906f0f808">&#9670;&nbsp;</a></span>phillips_initialize_velocity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public phillips_initialization::phillips_initialize_velocity </td>
          <td>(</td>
          <td class="paramtype">real, dimension( g %isdb: g %iedb, g %jsd: g %jed, gv %ke), intent(out)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( g %isd: g %ied, g %jsdb: g %jedb, gv %ke), intent(out)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(ocean_grid_type), intent(in)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(param_file_type), intent(in)&#160;</td>
          <td class="paramname"><em>param_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>just_read_params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the velocity fields for the Phillips model test case. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>Grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>Vertical grid structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">u</td><td>i-component of velocity [L T-1 ~&gt; m s-1] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">v</td><td>j-component of velocity [L T-1 ~&gt; m s-1] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param_file</td><td>A structure indicating the open file to parse for modelparameter values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">just_read_params</td><td>If present and true, this call will only read parameters without changing h. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Phillips__initialization_8F90_source.html#l00121">121</a> of file <a class="el" href="Phillips__initialization_8F90_source.html">Phillips_initialization.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type),   <span class="keywordtype">intent(in)</span>  :: G<span class="comment">  !&lt; Grid structure</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordtype">type</span>(verticalGrid_type), <span class="keywordtype">intent(in)</span>  :: GV<span class="comment"> !&lt; Vertical grid structure</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZIB_(G),SZJ_(G),SZK_(GV))</span>, &amp;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                           <span class="keywordtype">intent(out)</span> :: u<span class="comment">  !&lt; i-component of velocity [L T-1 ~&gt; m s-1]</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">dimension(SZI_(G),SZJB_(G),SZK_(GV))</span>, &amp;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                           <span class="keywordtype">intent(out)</span> :: v<span class="comment">  !&lt; j-component of velocity [L T-1 ~&gt; m s-1]</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type),   <span class="keywordtype">intent(in)</span>  :: US<span class="comment"> !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">type</span>(param_file_type),   <span class="keywordtype">intent(in)</span>  :: param_file<span class="comment"> !&lt; A structure indicating the open file to</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">                                                     !! parse for modelparameter values.</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordtype">logical</span>,       <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: just_read_params<span class="comment"> !&lt; If present and true, this call will</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">                                                     !! only read parameters without changing h.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keywordtype">  real</span> :: jet_width       <span class="comment">! The width of the zonal-mean jet [km]</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keywordtype">  real</span> :: jet_height      <span class="comment">! The interface height scale associated with the zonal-mean jet [Z ~&gt; m]</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keywordtype">  real</span> :: x_2             <span class="comment">! The x-position relative to the center of the domain [nondim]</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keywordtype">  real</span> :: y_2             <span class="comment">! The y-position relative to the center of the domain [km] or [nondim]</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keywordtype">  real</span> :: velocity_amplitude <span class="comment">! The amplitude of velocity perturbations [L T-1 ~&gt; m s-1]</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keywordtype">  real</span> :: pi              <span class="comment">! The ratio of the circumference of a circle to its diameter [nondim]</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordtype">integer</span> :: i, j, k, is, ie, js, je, nz, m</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordtype">logical</span> :: just_read    <span class="comment">! If true, just read parameters but set nothing.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordtype">character(len=40)</span>  :: mdl = <span class="stringliteral">&quot;Phillips_initialize_velocity&quot;</span> <span class="comment">! This subroutine&#39;s name.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  is = g%isc ; ie = g%iec ; js = g%jsc ; je = g%jec ; nz = g%ke</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  just_read = .false. ; <span class="keywordflow">if</span> (<span class="keyword">present</span>(just_read_params)) just_read = just_read_params</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">if</span> (.not.just_read) <span class="keyword">call </span>log_version(param_file, mdl, version)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;VELOCITY_IC_PERTURB_AMP&quot;</span>, velocity_amplitude, &amp;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                 <span class="stringliteral">&quot;The magnitude of the initial velocity perturbation.&quot;</span>, &amp;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                 units=<span class="stringliteral">&quot;m s-1&quot;</span>, default=0.001, scale=us%m_s_to_L_T, do_not_log=just_read)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;JET_WIDTH&quot;</span>, jet_width, &amp;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                 <span class="stringliteral">&quot;The width of the zonal-mean jet.&quot;</span>, units=<span class="stringliteral">&quot;km&quot;</span>, &amp;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                 fail_if_missing=.not.just_read, do_not_log=just_read)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;JET_HEIGHT&quot;</span>, jet_height, &amp;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                 <span class="stringliteral">&quot;The interface height scale associated with the &quot;</span>//&amp;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                 <span class="stringliteral">&quot;zonal-mean jet.&quot;</span>, units=<span class="stringliteral">&quot;m&quot;</span>, scale=us%m_to_Z, &amp;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                 fail_if_missing=.not.just_read, do_not_log=just_read)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">if</span> (just_read) <span class="keywordflow">return</span> <span class="comment">! All run-time parameters have been read, so return.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  u(:,:,:) = 0.0</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  v(:,:,:) = 0.0</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  pi = 4.0*atan(1.0)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">! Use thermal wind shear to give a geostrophically balanced flow.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">do</span> k=nz-1,1 ; <span class="keywordflow">do</span> j=js,je ; <span class="keywordflow">do</span> i=is-1,ie</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    y_2 = g%geoLatCu(i,j) - g%south_lat - 0.5*g%len_lat</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">! This uses d/d y_2 atan(y_2 / jet_width)</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">!    u(I,j,k) = u(I,j,k+1) + (1e-3 * jet_height / &amp;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">!           (US%m_to_L*jet_width * (1.0 + (y_2 / jet_width)**2))) * &amp;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">!           (2.0 * GV%g_prime(K+1) / (G%CoriolisBu(I,J) + G%CoriolisBu(I,J-1)))</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">! This uses d/d y_2 tanh(y_2 / jet_width)</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    u(i,j,k) = u(i,j,k+1) + (1e-3 * (jet_height / (us%m_to_L*jet_width)) * &amp;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;           (sech(y_2 / jet_width))**2 ) * &amp;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;           (2.0 * gv%g_prime(k+1) / (g%CoriolisBu(i,j) + g%CoriolisBu(i,j-1)))</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keywordflow">  enddo</span> ;<span class="keywordflow"> enddo</span> ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">do</span> k=1,nz ; <span class="keywordflow">do</span> j=js,je ; <span class="keywordflow">do</span> i=is-1,ie</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    y_2 = (g%geoLatCu(i,j) - g%south_lat - 0.5*g%len_lat) / g%len_lat</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    x_2 = (g%geoLonCu(i,j) - g%west_lon - 0.5*g%len_lon) / g%len_lon</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span> (g%geoLonCu(i,j) == g%west_lon) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="comment">! This modification is required so that the perturbations are identical for</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="comment">! symmetric and non-symmetric memory.  It is exactly equivalent to</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="comment">! taking the longitude at the eastern edge of the domain, so that x_2 ~= 0.5.</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      x_2 = ((g%west_lon + g%len_lon*real(g%ieg-(g%isg-1))/real(g%Domain%niglobal)) - &amp;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;             g%west_lon - 0.5*g%len_lon) / g%len_lon</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    u(i,j,k) = u(i,j,k) + velocity_amplitude * ((real(k)-0.5)/real(nz)) * &amp;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;           (0.5 - abs(2.0*x_2) + 0.1*abs(cos(10.0*pi*x_2)) - abs(sin(5.0*pi*y_2)))</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">do</span> m=1,10</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      u(i,j,k) = u(i,j,k) + 0.2*velocity_amplitude * ((real(k)-0.5)/real(nz)) * &amp;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            cos(2.0*m*pi*x_2 + 2*m) * cos(6.0*pi*y_2)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keywordflow">  enddo</span> ;<span class="keywordflow"> enddo</span> ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Phillips__initialization_8F90_source.html#l00284">sech()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacephillips__initialization_a328589bb31bd695e9d1a0ed906f0f808_cgraph.svg" width="334" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a88d1be48e4a24bdcefce251a16a0ea10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88d1be48e4a24bdcefce251a16a0ea10">&#9670;&nbsp;</a></span>sech()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real function phillips_initialization::sech </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>sech calculates the hyperbolic secant. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Input value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Result. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Phillips__initialization_8F90_source.html#l00284">284</a> of file <a class="el" href="Phillips__initialization_8F90_source.html">Phillips_initialization.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span> :: x<span class="comment">    !&lt; Input value.</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordtype">  real</span>             :: sech<span class="comment"> !&lt; Result.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="comment">! This is here to prevent overflows or underflows.</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">if</span> (abs(x) &gt; 228.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    sech = 0.0</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    sech = 2.0 / (exp(x) + exp(-x))</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="keywordflow">  endif</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="Phillips__initialization_8F90_source.html#l00121">phillips_initialize_velocity()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacephillips__initialization_a88d1be48e4a24bdcefce251a16a0ea10_icgraph.svg" width="334" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacephillips__initialization.html">phillips_initialization</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
