<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MOM6: idealized_hurricane Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MOM6
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespaceidealized__hurricane.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">idealized_hurricane Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Forcing for the idealized hurricane and SCM_idealized_hurricane examples. </p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structidealized__hurricane_1_1idealized__hurricane__cs.html">idealized_hurricane_cs</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for parameters describing idealized wind structure.  <a href="structidealized__hurricane_1_1idealized__hurricane__cs.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a127911d6a6b363458f5f898de9a09ab8"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceidealized__hurricane.html#a127911d6a6b363458f5f898de9a09ab8">idealized_hurricane_wind_init</a> (Time, G, param_file, CS)</td></tr>
<tr class="memdesc:a127911d6a6b363458f5f898de9a09ab8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes wind profile for the SCM idealized hurricane example.  <a href="namespaceidealized__hurricane.html#a127911d6a6b363458f5f898de9a09ab8">More...</a><br /></td></tr>
<tr class="separator:a127911d6a6b363458f5f898de9a09ab8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af445bdf432f5001a639d56898a4e92bc"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceidealized__hurricane.html#af445bdf432f5001a639d56898a4e92bc">idealized_hurricane_wind_forcing</a> (state, forces, day, G, US, CS)</td></tr>
<tr class="memdesc:af445bdf432f5001a639d56898a4e92bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the surface wind for the idealized hurricane test cases.  <a href="namespaceidealized__hurricane.html#af445bdf432f5001a639d56898a4e92bc">More...</a><br /></td></tr>
<tr class="separator:af445bdf432f5001a639d56898a4e92bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4caf0cd155a00343c47472cf3682db2a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceidealized__hurricane.html#a4caf0cd155a00343c47472cf3682db2a">idealized_hurricane_wind_profile</a> (CS, absf, YY, XX, UOCN, VOCN, Tx, Ty)</td></tr>
<tr class="memdesc:a4caf0cd155a00343c47472cf3682db2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the wind speed at a location as a function of time.  <a href="namespaceidealized__hurricane.html#a4caf0cd155a00343c47472cf3682db2a">More...</a><br /></td></tr>
<tr class="separator:a4caf0cd155a00343c47472cf3682db2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07c3f2115e5208daa086b654b74ded5e"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceidealized__hurricane.html#a07c3f2115e5208daa086b654b74ded5e">scm_idealized_hurricane_wind_forcing</a> (state, forces, day, G, US, CS)</td></tr>
<tr class="memdesc:a07c3f2115e5208daa086b654b74ded5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine is primarily needed as a legacy for reproducing answers. It is included as an additional subroutine rather than padded into the previous routine with flags to ease its eventual removal. Its functionality is replaced with the new routines and it can be deleted when answer changes are acceptable.  <a href="namespaceidealized__hurricane.html#a07c3f2115e5208daa086b654b74ded5e">More...</a><br /></td></tr>
<tr class="separator:a07c3f2115e5208daa086b654b74ded5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab00b0e78aa89c5166eaddf09850bf04a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=40)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceidealized__hurricane.html#ab00b0e78aa89c5166eaddf09850bf04a">mdl</a> = &quot;idealized_hurricane&quot;</td></tr>
<tr class="memdesc:ab00b0e78aa89c5166eaddf09850bf04a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This module's name.  <a href="namespaceidealized__hurricane.html#ab00b0e78aa89c5166eaddf09850bf04a">More...</a><br /></td></tr>
<tr class="separator:ab00b0e78aa89c5166eaddf09850bf04a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="af445bdf432f5001a639d56898a4e92bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af445bdf432f5001a639d56898a4e92bc">&#9670;&nbsp;</a></span>idealized_hurricane_wind_forcing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public idealized_hurricane::idealized_hurricane_wind_forcing </td>
          <td>(</td>
          <td class="paramtype">type(surface), intent(in)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(mech_forcing), intent(inout)&#160;</td>
          <td class="paramname"><em>forces</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(time_type), intent(in)&#160;</td>
          <td class="paramname"><em>day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(ocean_grid_type), intent(inout)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structidealized__hurricane_1_1idealized__hurricane__cs.html">idealized_hurricane_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>CS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the surface wind for the idealized hurricane test cases. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>Surface state structure </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">forces</td><td>A structure with the driving mechanical forces </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">day</td><td>Time in days </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g</td><td>Grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cs</td><td>Container for idealized hurricane parameters </td></tr>
  </table>
  </dd>
</dl>
<p>Compute storm center location</p>
<p>Computes taux</p>
<p>Computes tauy</p>
<p>Get Ustar</p>

<p class="definition">Definition at line <a class="el" href="Idealized__Hurricane_8F90_source.html#l00201">201</a> of file <a class="el" href="Idealized__Hurricane_8F90_source.html">Idealized_Hurricane.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordtype">type</span>(surface),                <span class="keywordtype">intent(in)</span>    :: state<span class="comment">  !&lt; Surface state structure</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordtype">type</span>(mech_forcing),           <span class="keywordtype">intent(inout)</span> :: forces<span class="comment"> !&lt; A structure with the driving mechanical forces</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordtype">type</span>(time_type),              <span class="keywordtype">intent(in)</span>    :: day<span class="comment">    !&lt; Time in days</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type),        <span class="keywordtype">intent(inout)</span> :: G<span class="comment">      !&lt; Grid structure</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type),        <span class="keywordtype">intent(in)</span>    :: US<span class="comment">     !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordtype">type</span>(idealized_hurricane_CS), <span class="keywordtype">pointer</span>       :: CS<span class="comment">     !&lt; Container for idealized hurricane parameters</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordtype">integer</span> :: i, j, is, ie, js, je, Isq, Ieq, Jsq, Jeq</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordtype">integer</span> :: isd, ied, jsd, jed, IsdB, IedB, JsdB, JedB</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="keywordtype">  real</span> :: TX,TY<span class="comment">       !&lt; wind stress</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keywordtype">  real</span> :: Uocn, Vocn<span class="comment">  !&lt; Surface ocean velocity components</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keywordtype">  real</span> :: LAT, LON<span class="comment">    !&lt; Grid location</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keywordtype">  real</span> :: YY, XX<span class="comment">      !&lt; storm relative position</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keywordtype">  real</span> :: XC, YC<span class="comment">      !&lt; Storm center location</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keywordtype">  real</span> :: f<span class="comment">           !&lt; Coriolis</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="keywordtype">  real</span> :: fbench<span class="comment">      !&lt; The benchmark &#39;f&#39; value</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="keywordtype">  real</span> :: fbench_fac<span class="comment">  !&lt; A factor that is set to 0 to use the</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">                      !!  benchmark &#39;f&#39; value</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keywordtype">  real</span> :: rel_tau_fac<span class="comment"> !&lt; A factor that is set to 0 to disable</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">                      !!  current relative stress calculation</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">! Bounds for loops and memory allocation</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  is = g%isc    ; ie = g%iec    ; js = g%jsc    ; je = g%jec</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  isq = g%IscB  ; ieq = g%IecB  ; jsq = g%JscB  ; jeq = g%JecB</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  isd = g%isd   ; ied = g%ied   ; jsd = g%jsd   ; jed = g%jed</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  isdb = g%IsdB ; iedb = g%IedB ; jsdb = g%JsdB ; jedb = g%JedB</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">! Allocate the forcing arrays, if necessary.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keyword">call </span>allocate_mech_forcing(g, forces, stress=.true., ustar=.true.)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">if</span> (cs%relative_tau) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;     rel_tau_fac = 1.</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;     rel_tau_fac = 0. <span class="comment">!Multiplied to 0 surface current</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">  !&gt; Compute storm center location</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  xc = cs%Hurr_cen_X0 + (time_type_to_real(day)*cs%hurr_translation_spd*&amp;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;       cos(cs%hurr_translation_dir))</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  yc = cs%Hurr_cen_Y0 + (time_type_to_real(day)*cs%hurr_translation_spd*&amp;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;       sin(cs%hurr_translation_dir))</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">if</span> (cs%BR_Bench) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;     <span class="comment">! f reset to value used in generated wind for benchmark test</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;     fbench = 5.5659e-05</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;     fbench_fac = 0.0</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;     fbench = 0.0</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;     fbench_fac = 1.0</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">  !&gt; Computes taux</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">do</span> j=js,je</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">do</span> i=is-1,ieq</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      uocn = state%u(i,j)*rel_tau_fac</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      vocn = 0.25*(state%v(i,j)+state%v(i+1,j-1)&amp;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;             +state%v(i+1,j)+state%v(i,j-1))*rel_tau_fac</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      f = abs(0.5*us%s_to_T*(g%CoriolisBu(i,j)+g%CoriolisBu(i,j-1)))*fbench_fac + fbench</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="comment">! Calculate position as a function of time.</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordflow">if</span> (cs%SCM_mode) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        yy = yc + cs%dy_from_center</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        xx = xc</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        lat = g%geoLatCu(i,j)*1000. <span class="comment">! Convert Lat from km to m.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        lon = g%geoLonCu(i,j)*1000. <span class="comment">! Convert Lon from km to m.</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        yy = lat - yc</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        xx = lon - xc</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="keyword">call </span>idealized_hurricane_wind_profile(&amp;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;         cs,f,yy,xx,uocn,vocn,tx,ty)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      forces%taux(i,j) = g%mask2dCu(i,j) * tx</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="keywordflow">  enddo</span><span class="comment"></span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">  !&gt; Computes tauy</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordflow">do</span> j=js-1,jeq</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">do</span> i=is,ie</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      uocn = 0.25*(state%u(i,j)+state%u(i-1,j+1)&amp;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            +state%u(i-1,j)+state%u(i,j+1))*rel_tau_fac</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      vocn = state%v(i,j)*rel_tau_fac</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      f = abs(0.5*us%s_to_T*(g%CoriolisBu(i-1,j)+g%CoriolisBu(i,j)))*fbench_fac + fbench</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="comment">! Calculate position as a function of time.</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keywordflow">if</span> (cs%SCM_mode) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        yy = yc + cs%dy_from_center</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        xx = xc</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        lat = g%geoLatCv(i,j)*1000. <span class="comment">! Convert Lat from km to m.</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        lon = g%geoLonCv(i,j)*1000. <span class="comment">! Convert Lon from km to m.</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        yy = lat - yc</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        xx = lon - xc</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keyword">call </span>idealized_hurricane_wind_profile(cs, f, yy, xx, uocn, vocn, tx, ty)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      forces%tauy(i,j) = g%mask2dCv(i,j) * ty</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keywordflow">  enddo</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">  !&gt; Get Ustar</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">do</span> j=js,je</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">do</span> i=is,ie</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="comment">!  This expression can be changed if desired, but need not be.</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      forces%ustar(i,j) = us%m_to_Z*us%T_to_s * g%mask2dT(i,j) * sqrt(cs%gustiness/cs%Rho0 + &amp;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;         sqrt(0.5*(forces%taux(i-1,j)**2 + forces%taux(i,j)**2) + &amp;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            0.5*(forces%tauy(i,j-1)**2 + forces%tauy(i,j)**2))/cs%Rho0)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="keywordflow">  enddo</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MOM__forcing__type_8F90_source.html#l02824">mom_forcing_type::allocate_mech_forcing()</a>, and <a class="el" href="Idealized__Hurricane_8F90_source.html#l00314">idealized_hurricane_wind_profile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceidealized__hurricane_af445bdf432f5001a639d56898a4e92bc_cgraph.svg" width="642" height="134"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a127911d6a6b363458f5f898de9a09ab8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a127911d6a6b363458f5f898de9a09ab8">&#9670;&nbsp;</a></span>idealized_hurricane_wind_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public idealized_hurricane::idealized_hurricane_wind_init </td>
          <td>(</td>
          <td class="paramtype">type(time_type), intent(in)&#160;</td>
          <td class="paramname"><em>Time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(ocean_grid_type), intent(in)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(param_file_type), intent(in)&#160;</td>
          <td class="paramname"><em>param_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structidealized__hurricane_1_1idealized__hurricane__cs.html">idealized_hurricane_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>CS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes wind profile for the SCM idealized hurricane example. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>Model time </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>Grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param_file</td><td>Input parameter structure </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cs</td><td>Parameter container </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Idealized__Hurricane_8F90_source.html#l00094">94</a> of file <a class="el" href="Idealized__Hurricane_8F90_source.html">Idealized_Hurricane.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">type</span>(time_type), &amp;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;       <span class="keywordtype">intent(in)</span> :: Time<span class="comment">       !&lt; Model time</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type), &amp;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;       <span class="keywordtype">intent(in)</span> :: G<span class="comment">          !&lt; Grid structure</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordtype">type</span>(param_file_type), &amp;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;       <span class="keywordtype">intent(in)</span> :: param_file<span class="comment"> !&lt; Input parameter structure</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">type</span>(idealized_hurricane_CS), &amp;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;       <span class="keywordtype">pointer</span>    :: CS<span class="comment">         !&lt; Parameter container</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keywordtype">  real</span> :: DP, C</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">! This include declares and sets the variable &quot;version&quot;.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#include &quot;version_variable.h&quot;</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">associated</span>(cs)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keyword">call </span>mom_error(fatal, <span class="stringliteral">&quot;idealized_hurricane_wind_init called &quot;</span>// &amp;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                          <span class="stringliteral">&quot;with an associated control structure.&quot;</span>)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">return</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keyword">allocate</span>(cs)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  cs%pi = 4.0*atan(1.0)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  cs%Deg2Rad = cs%pi/180.</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">! Read all relevant parameters and write them to the model log.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keyword">call </span>log_version(param_file, mdl, version, <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">! Parameters for computing a wind profile</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;IDL_HURR_RHO_AIR&quot;</span>, cs%rho_a, &amp;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                 <span class="stringliteral">&quot;Air density used to compute the idealized hurricane &quot;</span>//&amp;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                 <span class="stringliteral">&quot;wind profile.&quot;</span>, units=<span class="stringliteral">&#39;kg/m3&#39;</span>, default=1.2)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;IDL_HURR_AMBIENT_PRESSURE&quot;</span>, &amp;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                 cs%pressure_ambient, <span class="stringliteral">&quot;Ambient pressure used in the &quot;</span>//&amp;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                 <span class="stringliteral">&quot;idealized hurricane wind profile.&quot;</span>, units=<span class="stringliteral">&#39;Pa&#39;</span>, &amp;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                 default=101200.)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;IDL_HURR_CENTRAL_PRESSURE&quot;</span>, &amp;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                 cs%pressure_central, <span class="stringliteral">&quot;Central pressure used in the &quot;</span>//&amp;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                 <span class="stringliteral">&quot;idealized hurricane wind profile.&quot;</span>, units=<span class="stringliteral">&#39;Pa&#39;</span>, &amp;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                 default=96800.)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;IDL_HURR_RAD_MAX_WIND&quot;</span>, &amp;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                 cs%rad_max_wind, <span class="stringliteral">&quot;Radius of maximum winds used in the &quot;</span>//&amp;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                 <span class="stringliteral">&quot;idealized hurricane wind profile.&quot;</span>, units=<span class="stringliteral">&#39;m&#39;</span>, &amp;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                 default=50.e3)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;IDL_HURR_MAX_WIND&quot;</span>, cs%max_windspeed, &amp;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                 <span class="stringliteral">&quot;Maximum wind speed used in the idealized hurricane&quot;</span>// &amp;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                 <span class="stringliteral">&quot;wind profile.&quot;</span>, units=<span class="stringliteral">&#39;m/s&#39;</span>, default=65.)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;IDL_HURR_TRAN_SPEED&quot;</span>, cs%hurr_translation_spd, &amp;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                 <span class="stringliteral">&quot;Translation speed of hurricane used in the idealized &quot;</span>//&amp;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                 <span class="stringliteral">&quot;hurricane wind profile.&quot;</span>, units=<span class="stringliteral">&#39;m/s&#39;</span>, default=5.0)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;IDL_HURR_TRAN_DIR&quot;</span>, cs%hurr_translation_dir, &amp;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                 <span class="stringliteral">&quot;Translation direction (towards) of hurricane used in the &quot;</span>//&amp;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                 <span class="stringliteral">&quot;idealized hurricane wind profile.&quot;</span>, units=<span class="stringliteral">&#39;degrees&#39;</span>, &amp;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                 default=180.0)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  cs%hurr_translation_dir = cs%hurr_translation_dir * cs%Deg2Rad</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;IDL_HURR_X0&quot;</span>, cs%Hurr_cen_X0, &amp;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                 <span class="stringliteral">&quot;Idealized Hurricane initial X position&quot;</span>, &amp;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                 units=<span class="stringliteral">&#39;m&#39;</span>, default=0.)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;IDL_HURR_Y0&quot;</span>, cs%Hurr_cen_Y0, &amp;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                 <span class="stringliteral">&quot;Idealized Hurricane initial Y position&quot;</span>, &amp;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                 units=<span class="stringliteral">&#39;m&#39;</span>, default=0.)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;IDL_HURR_TAU_CURR_REL&quot;</span>, cs%relative_tau, &amp;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                 <span class="stringliteral">&quot;Current relative stress switch &quot;</span>//&amp;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                 <span class="stringliteral">&quot;used in the idealized hurricane wind profile.&quot;</span>, &amp;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                 units=<span class="stringliteral">&#39;&#39;</span>, default=.false.)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="comment">! Parameters for SCM mode</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;IDL_HURR_SCM_BR_BENCH&quot;</span>, cs%BR_BENCH, &amp;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                 <span class="stringliteral">&quot;Single column mode benchmark case switch, which is &quot;</span>// &amp;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                 <span class="stringliteral">&quot;invoking a modification (bug) in the wind profile meant to &quot;</span>//&amp;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                 <span class="stringliteral">&quot;reproduce a previous implementation.&quot;</span>, units=<span class="stringliteral">&#39;&#39;</span>, default=.false.)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;IDL_HURR_SCM&quot;</span>, cs%SCM_MODE, &amp;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                 <span class="stringliteral">&quot;Single Column mode switch &quot;</span>//&amp;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                 <span class="stringliteral">&quot;used in the SCM idealized hurricane wind profile.&quot;</span>, &amp;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                 units=<span class="stringliteral">&#39;&#39;</span>, default=.false.)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;IDL_HURR_SCM_LOCY&quot;</span>, cs%DY_from_center, &amp;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                 <span class="stringliteral">&quot;Y distance of station used in the SCM idealized hurricane &quot;</span>//&amp;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                 <span class="stringliteral">&quot;wind profile.&quot;</span>, units=<span class="stringliteral">&#39;m&#39;</span>, default=50.e3)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">! The following parameters are model run-time parameters which are used</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">! and logged elsewhere and so should not be logged here. The default</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">! value should be consistent with the rest of the model.</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;RHO_0&quot;</span>, cs%Rho0, &amp;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                 <span class="stringliteral">&quot;The mean ocean density used with BOUSSINESQ true to &quot;</span>//&amp;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                 <span class="stringliteral">&quot;calculate accelerations and the mass for conservation &quot;</span>//&amp;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                 <span class="stringliteral">&quot;properties, or with BOUSSINSEQ false to convert some &quot;</span>//&amp;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                 <span class="stringliteral">&quot;parameters from vertical units of m to kg m-2.&quot;</span>, &amp;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                 units=<span class="stringliteral">&quot;kg m-3&quot;</span>, default=1035.0, do_not_log=.true.)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keyword">call </span>get_param(param_file, mdl, <span class="stringliteral">&quot;GUST_CONST&quot;</span>, cs%gustiness, &amp;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                 <span class="stringliteral">&quot;The background gustiness in the winds.&quot;</span>, units=<span class="stringliteral">&quot;Pa&quot;</span>, &amp;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                 default=0.00, do_not_log=.true.)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">if</span> (cs%BR_BENCH) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    cs%rho_a = 1.2</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  dp = cs%pressure_ambient - cs%pressure_central</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  c = cs%max_windspeed / sqrt( dp )</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  cs%Holland_B = c**2 * cs%rho_a * exp(1.0)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  cs%Holland_A = (cs%rad_max_wind)**cs%Holland_B</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  cs%Holland_AxBxDP = cs%Holland_A*cs%Holland_B*dp</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Idealized__Hurricane_8F90_source.html#l00088">mdl</a>, and <a class="el" href="MOM__error__handler_8F90_source.html#l00072">mom_error_handler::mom_error()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceidealized__hurricane_a127911d6a6b363458f5f898de9a09ab8_cgraph.svg" width="564" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a4caf0cd155a00343c47472cf3682db2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4caf0cd155a00343c47472cf3682db2a">&#9670;&nbsp;</a></span>idealized_hurricane_wind_profile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine idealized_hurricane::idealized_hurricane_wind_profile </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structidealized__hurricane_1_1idealized__hurricane__cs.html">idealized_hurricane_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>absf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>YY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>XX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>UOCN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>VOCN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>Tx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>Ty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the wind speed at a location as a function of time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">cs</td><td>Container for SCM parameters </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">absf</td><td>Input coriolis magnitude </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yy</td><td>Location in m relative to center y </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xx</td><td>Location in m relative to center x </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uocn</td><td>X surface current </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vocn</td><td>Y surface current </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tx</td><td>X stress </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ty</td><td>Y stress </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Idealized__Hurricane_8F90_source.html#l00314">314</a> of file <a class="el" href="Idealized__Hurricane_8F90_source.html">Idealized_Hurricane.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">! Author: Brandon Reichl</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">! Date: Nov-20-2014</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">!       Aug-14-2018 Generalized for non-SCM configuration</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">! Input parameters</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordtype">type</span>(idealized_hurricane_CS), &amp;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordtype">pointer</span>     :: CS<span class="comment">   !&lt; Container for SCM parameters</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span>  :: absf<span class="comment"> !&lt;Input coriolis magnitude</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span>  :: YY<span class="comment">   !&lt; Location in m relative to center y</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span>  :: XX<span class="comment">   !&lt; Location in m relative to center x</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span>  :: UOCN<span class="comment"> !&lt; X surface current</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(in)</span>  :: VOCN<span class="comment"> !&lt; Y surface current</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(out)</span> :: Tx<span class="comment">   !&lt; X stress</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordtype">  real</span>, <span class="keywordtype">intent(out)</span> :: Ty<span class="comment">   !&lt; Y stress</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">! Wind profile terms</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="keywordtype">  real</span> :: U10</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="keywordtype">  real</span> :: radius</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keywordtype">  real</span> :: radius10</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keywordtype">  real</span> :: radius_km</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keywordtype">  real</span> :: radiusB</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="keywordtype">  real</span> :: fcor</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="keywordtype">  real</span> :: du10</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keywordtype">  real</span> :: du</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="keywordtype">  real</span> :: dv</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="keywordtype">  real</span> :: CD</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">!Wind angle variables</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="keywordtype">  real</span> :: Alph<span class="comment"> !&lt; The resulting inflow angle (positive outward)</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="keywordtype">  real</span> :: Rstr</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="keywordtype">  real</span> :: A0</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="keywordtype">  real</span> :: A1</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="keywordtype">  real</span> :: P1</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="keywordtype">  real</span> :: Adir</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="keywordtype">  real</span> :: V_TS</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keywordtype">  real</span> :: U_TS</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">! Implementing Holland (1980) parameteric wind profile</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  radius = sqrt(xx**2 + yy**2)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">!/ BGR</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="comment">! rkm - r converted to km for Holland prof.</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">!       used in km due to error, correct implementation should</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="comment">!       not need rkm, but to match winds w/ experiment this must</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">!       be maintained.  Causes winds far from storm center to be a</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="comment">!       couple of m/s higher than the correct Holland prof.</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordflow">if</span> (cs%BR_Bench) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    radius_km = radius/1000.</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">! if not comparing to benchmark, then use correct Holland prof.</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    radius_km = radius</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  radiusb = (radius)**cs%Holland_B</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="comment">!/</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">! Calculate U10 in the interior (inside of 10x radius of maximum wind),</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="comment">! while adjusting U10 to 0 outside of 12x radius of maximum wind.</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordflow">if</span> ( (radius/cs%rad_max_wind .gt. 0.001) .and. &amp;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;       (radius/cs%rad_max_wind .lt. 10.) ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    u10 = sqrt(cs%Holland_AxBxDP*exp(-cs%Holland_A/radiusb)/(cs%rho_A*radiusb)&amp;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                +0.25*(radius_km*absf)**2) - 0.5*radius_km*absf</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">elseif</span> ( (radius/cs%rad_max_wind .gt. 10.) .and. &amp;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;           (radius/cs%rad_max_wind .lt. 15.) ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    radius10 = cs%rad_max_wind*10.</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">if</span> (cs%BR_Bench) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      radius_km = radius10/1000.</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      radius_km = radius10</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    radiusb=radius10**cs%Holland_B</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    u10 = (sqrt(cs%Holland_AxBxDp*exp(-cs%Holland_A/radiusb)/(cs%rho_A*radiusb)&amp;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                  +0.25*(radius_km*absf)**2)-0.5*radius_km*absf) &amp;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;           * (15.-radius/cs%rad_max_wind)/5.</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    u10 = 0.</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  adir = atan2(yy,xx)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="comment">!\</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">! Wind angle model following Zhang and Ulhorn (2012)</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">! ALPH is inflow angle positive outward.</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  rstr = min(10.,radius / cs%rad_max_wind)</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  a0 = -0.9*rstr - 0.09*cs%max_windspeed - 14.33</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  a1 = -a0*(0.04*rstr + 0.05*cs%Hurr_translation_spd + 0.14)</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  p1 = (6.88*rstr - 9.60*cs%Hurr_translation_spd + 85.31) * cs%Deg2Rad</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  alph = a0 - a1*cos(cs%hurr_translation_dir-adir-p1)</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordflow">if</span> ( (radius/cs%rad_max_wind.gt.10.) .and.&amp;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;       (radius/cs%rad_max_wind.lt.15.) ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;     alph = alph*(15.0-radius/cs%rad_max_wind)/5.</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordflow">elseif</span> (radius/cs%rad_max_wind.gt.15.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;     alph = 0.0</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  alph = alph * cs%Deg2Rad</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">! Calculate translation speed components</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  u_ts = cs%hurr_translation_spd/2.*cos(cs%hurr_translation_dir)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  v_ts = cs%hurr_translation_spd/2.*sin(cs%hurr_translation_dir)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="comment">! Set output (relative) winds</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  du = u10*sin(adir-cs%Pi-alph) - uocn + u_ts</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  dv = u10*cos(adir-alph) - vocn + v_ts</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="comment">!  Use a simple drag coefficient as a function of U10 (from Sullivan et al., 2010)</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  du10 = sqrt(du**2+dv**2)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">if</span> (du10.lt.11.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;     cd = 1.2e-3</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keywordflow">elseif</span> (du10.lt.20.0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;     cd = (0.49 + 0.065*u10)*1.e-3</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;     cd = 1.8e-3</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="comment">! Compute stress vector</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  tx = cs%rho_A * cd * sqrt(du**2 + dv**2) * du</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  ty = cs%rho_A * cd * sqrt(du**2 + dv**2) * dv</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="Idealized__Hurricane_8F90_source.html#l00201">idealized_hurricane_wind_forcing()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceidealized__hurricane_a4caf0cd155a00343c47472cf3682db2a_icgraph.svg" width="360" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a07c3f2115e5208daa086b654b74ded5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07c3f2115e5208daa086b654b74ded5e">&#9670;&nbsp;</a></span>scm_idealized_hurricane_wind_forcing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public idealized_hurricane::scm_idealized_hurricane_wind_forcing </td>
          <td>(</td>
          <td class="paramtype">type(surface), intent(in)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(mech_forcing), intent(inout)&#160;</td>
          <td class="paramname"><em>forces</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(time_type), intent(in)&#160;</td>
          <td class="paramname"><em>day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(ocean_grid_type), intent(inout)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(unit_scale_type), intent(in)&#160;</td>
          <td class="paramname"><em>US</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structidealized__hurricane_1_1idealized__hurricane__cs.html">idealized_hurricane_cs</a>), pointer&#160;</td>
          <td class="paramname"><em>CS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine is primarily needed as a legacy for reproducing answers. It is included as an additional subroutine rather than padded into the previous routine with flags to ease its eventual removal. Its functionality is replaced with the new routines and it can be deleted when answer changes are acceptable. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>Surface state structure </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">forces</td><td>A structure with the driving mechanical forces </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">day</td><td>Time in days </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g</td><td>Grid structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">us</td><td>A dimensional unit scaling type </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cs</td><td>Container for SCM parameters </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Idealized__Hurricane_8F90_source.html#l00444">444</a> of file <a class="el" href="Idealized__Hurricane_8F90_source.html">Idealized_Hurricane.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordtype">type</span>(surface),                <span class="keywordtype">intent(in)</span>    :: state<span class="comment">  !&lt; Surface state structure</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keywordtype">type</span>(mech_forcing),           <span class="keywordtype">intent(inout)</span> :: forces<span class="comment"> !&lt; A structure with the driving mechanical forces</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordtype">type</span>(time_type),              <span class="keywordtype">intent(in)</span>    :: day<span class="comment">    !&lt; Time in days</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type),        <span class="keywordtype">intent(inout)</span> :: G<span class="comment">      !&lt; Grid structure</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keywordtype">type</span>(unit_scale_type),        <span class="keywordtype">intent(in)</span>    :: US<span class="comment">     !&lt; A dimensional unit scaling type</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordtype">type</span>(idealized_hurricane_CS), <span class="keywordtype">pointer</span>       :: CS<span class="comment">     !&lt; Container for SCM parameters</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="comment">! Local variables</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordtype">integer</span> :: i, j, is, ie, js, je, Isq, Ieq, Jsq, Jeq</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keywordtype">integer</span> :: isd, ied, jsd, jed, IsdB, IedB, JsdB, JedB</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="keywordtype">  real</span> :: pie, Deg2Rad</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keywordtype">  real</span> :: U10, A, B, C, r, f, du10, rkm <span class="comment">! For wind profile expression</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="keywordtype">  real</span> :: xx, t0 <span class="comment">!for location</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="keywordtype">  real</span> :: dp, rB</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="keywordtype">  real</span> :: Cd <span class="comment">! Air-sea drag coefficient</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keywordtype">  real</span> :: Uocn, Vocn <span class="comment">! Surface ocean velocity components</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keywordtype">  real</span> :: dU, dV <span class="comment">! Air-sea differential motion</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">!Wind angle variables</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="keywordtype">  real</span> :: Alph,Rstr, A0, A1, P1, Adir, transdir, V_TS, U_TS</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordtype">logical</span> :: BR_Bench</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="comment">! Bounds for loops and memory allocation</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  is = g%isc ; ie = g%iec ; js = g%jsc ; je = g%jec</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  isq = g%IscB ; ieq = g%IecB ; jsq = g%JscB ; jeq = g%JecB</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  isd = g%isd ; ied = g%ied ; jsd = g%jsd ; jed = g%jed</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  isdb = g%IsdB ; iedb = g%IedB ; jsdb = g%JsdB ; jedb = g%JedB</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="comment">! Allocate the forcing arrays, if necessary.</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keyword">call </span>allocate_mech_forcing(g, forces, stress=.true., ustar=.true.)</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  pie = 4.0*atan(1.0) ; deg2rad = pie/180.</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="comment">!/ BR</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="comment">! Implementing Holland (1980) parameteric wind profile</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="comment">!------------------------------------------------------|</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  br_bench = .true.   <span class="comment">!true if comparing to LES runs     |</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  t0 = 129600.        <span class="comment">!TC &#39;eye&#39; crosses (0,0) at 36 hours|</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  transdir = pie      <span class="comment">!translation direction (-x)        |</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="comment">!------------------------------------------------------|</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  dp = cs%pressure_ambient - cs%pressure_central</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  c = cs%max_windspeed / sqrt( dp )</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  b = c**2 * cs%rho_a * exp(1.0)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordflow">if</span> (br_bench) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;     <span class="comment">! rho_a reset to value used in generated wind for benchmark test</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;     b = c**2 * 1.2 * exp(1.0)</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  a = (cs%rad_max_wind/1000.)**b</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  f = us%s_to_T*g%CoriolisBu(is,js) <span class="comment">! f=f(x,y) but in the SCM is constant</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordflow">if</span> (br_bench) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;     <span class="comment">! f reset to value used in generated wind for benchmark test</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;     f = 5.5659e-05  <span class="comment">!### A constant value in s-1.</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="comment">!/ BR</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">! Calculate x position as a function of time.</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  xx = ( t0 - time_type_to_real(day)) * cs%hurr_translation_spd * cos(transdir)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  r = sqrt(xx**2 + cs%DY_from_center**2)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="comment">!/ BR</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="comment">! rkm - r converted to km for Holland prof.</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="comment">!       used in km due to error, correct implementation should</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">!       not need rkm, but to match winds w/ experiment this must</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="comment">!       be maintained.  Causes winds far from storm center to be a</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">!       couple of m/s higher than the correct Holland prof.</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordflow">if</span> (br_bench) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;     rkm = r/1000.</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;     rb = (rkm)**b</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;     <span class="comment">! if not comparing to benchmark, then use correct Holland prof.</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;     rkm = r</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;     rb = r**b</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">!/ BR</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="comment">! Calculate U10 in the interior (inside of 10x radius of maximum wind),</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="comment">! while adjusting U10 to 0 outside of 12x radius of maximum wind.</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="comment">! Note that rho_a is set to 1.2 following generated wind for experiment</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">if</span> (r/cs%rad_max_wind &gt; 0.001 .AND. r/cs%rad_max_wind &lt; 10.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;     u10 = sqrt( a*b*dp*exp(-a/rb)/(1.2*rb) + 0.25*(rkm*f)**2 ) - 0.5*rkm*f</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keywordflow">elseif</span> (r/cs%rad_max_wind &gt; 10. .AND. r/cs%rad_max_wind &lt; 12.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;     r=cs%rad_max_wind*10.</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;     <span class="keywordflow">if</span> (br_bench) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        rkm = r/1000.</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        rb=rkm**b</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;     <span class="keywordflow">else</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        rkm = r</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        rb = r**b</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="keywordflow">     endif</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;     u10 = ( sqrt( a*b*dp*exp(-a/rb)/(1.2*rb) + 0.25*(rkm*f)**2 ) - 0.5*rkm*f) &amp;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;           * (12. - r/cs%rad_max_wind)/2.</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;     u10 = 0.</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  adir = atan2(cs%DY_from_center,xx)</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="comment">!/ BR</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="comment">! Wind angle model following Zhang and Ulhorn (2012)</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="comment">! ALPH is inflow angle positive outward.</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  rstr = min(10.,r / cs%rad_max_wind)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  a0 = -0.9*rstr -0.09*cs%max_windspeed - 14.33</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  a1 = -a0 *(0.04*rstr +0.05*cs%hurr_translation_spd+0.14)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  p1 = (6.88*rstr -9.60*cs%hurr_translation_spd+85.31)*pie/180.</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  alph = a0 - a1*cos( (transdir - adir ) - p1)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordflow">if</span> (r/cs%rad_max_wind &gt; 10. .AND. r/cs%rad_max_wind &lt; 12.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;     alph = alph* (12. - r/cs%rad_max_wind)/2.</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">elseif</span> (r/cs%rad_max_wind &gt; 12.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;     alph = 0.0</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="keywordflow">  endif</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  alph = alph * deg2rad</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; <span class="comment">!/BR</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="comment">! Prepare for wind calculation</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">! X_TS is component of translation speed added to wind vector</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="comment">! due to background steering wind.</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  u_ts = cs%hurr_translation_spd/2.*cos(transdir)</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  v_ts = cs%hurr_translation_spd/2.*sin(transdir)</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">! Set the surface wind stresses, in [Pa]. A positive taux</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">! accelerates the ocean to the (pseudo-)east.</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">!   The i-loop extends to is-1 so that taux can be used later in the</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment">! calculation of ustar - otherwise the lower bound would be Isq.</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordflow">do</span> j=js,je ; <span class="keywordflow">do</span> i=is-1,ieq</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">!/BR</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">! Turn off surface current for stress calculation to be</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">! consistent with test case.</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    uocn = 0.<span class="comment">!state%u(I,j)</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    vocn = 0.<span class="comment">!0.25*( (state%v(i,J) + state%v(i+1,J-1)) &amp;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;             <span class="comment">!    +(state%v(i+1,J) + state%v(i,J-1)) )</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">!/BR</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">! Wind vector calculated from location/direction (sin/cos flipped b/c</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="comment">! cyclonic wind is 90 deg. phase shifted from position angle).</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    du = u10*sin(adir-pie-alph) - uocn + u_ts</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    dv = u10*cos(adir-alph) - vocn + v_ts</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">!/----------------------------------------------------|</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="comment">!BR</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">!  Add a simple drag coefficient as a function of U10 |</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">!/----------------------------------------------------|</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    du10=sqrt(du**2+dv**2)</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">if</span> (du10 &lt; 11.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;       cd = 1.2e-3</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">elseif</span> (du10 &lt; 20.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;       cd = (0.49 + 0.065 * u10 )*0.001</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;       cd = 0.0018</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    forces%taux(i,j) = cs%rho_a * g%mask2dCu(i,j) * cd*sqrt(du**2+dv**2)*du</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="keywordflow">  enddo</span> ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="comment">!/BR</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="comment">! See notes above</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordflow">do</span> j=js-1,jeq ; <span class="keywordflow">do</span> i=is,ie</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    uocn = 0.<span class="comment">!0.25*( (state%u(I,j) + state%u(I-1,j+1)) &amp;</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;             <span class="comment">!    +(state%u(I-1,j) + state%u(I,j+1)) )</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    vocn = 0.<span class="comment">!state%v(i,J)</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    du = u10*sin(adir-pie-alph) - uocn + u_ts</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    dv = u10*cos(adir-alph) - vocn + v_ts</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    du10=sqrt(du**2+dv**2)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">if</span> (du10 &lt; 11.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;       cd = 1.2e-3</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordflow">elseif</span> (du10 &lt; 20.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;       cd = (0.49 + 0.065 * u10 )*0.001</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;       cd = 0.0018</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    forces%tauy(i,j) = cs%rho_a * g%mask2dCv(i,j) * cd*du10*dv</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="keywordflow">  enddo</span> ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="comment">! Set the surface friction velocity [m s-1]. ustar is always positive.</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">do</span> j=js,je ; <span class="keywordflow">do</span> i=is,ie</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">!  This expression can be changed if desired, but need not be.</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    forces%ustar(i,j) = us%m_to_Z*us%T_to_s * g%mask2dT(i,j) * sqrt(cs%gustiness/cs%Rho0 + &amp;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;       sqrt(0.5*(forces%taux(i-1,j)**2 + forces%taux(i,j)**2) + &amp;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            0.5*(forces%tauy(i,j-1)**2 + forces%tauy(i,j)**2))/cs%Rho0)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="keywordflow">  enddo</span> ;<span class="keywordflow"> enddo</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MOM__forcing__type_8F90_source.html#l02824">mom_forcing_type::allocate_mech_forcing()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespaceidealized__hurricane_a07c3f2115e5208daa086b654b74ded5e_cgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab00b0e78aa89c5166eaddf09850bf04a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab00b0e78aa89c5166eaddf09850bf04a">&#9670;&nbsp;</a></span>mdl</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=40) idealized_hurricane::mdl = &quot;idealized_hurricane&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This module's name. </p>

<p class="definition">Definition at line <a class="el" href="Idealized__Hurricane_8F90_source.html#l00088">88</a> of file <a class="el" href="Idealized__Hurricane_8F90_source.html">Idealized_Hurricane.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">character(len=40)  :: mdl = &quot;idealized_hurricane&quot; !&lt; This module&#39;s name.</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="Idealized__Hurricane_8F90_source.html#l00094">idealized_hurricane_wind_init()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceidealized__hurricane.html">idealized_hurricane</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
